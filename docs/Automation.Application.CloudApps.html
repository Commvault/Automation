
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Automation.Application.CloudApps package &#8212; Commvault Automation 11.14 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Automation.Application.CloudStorage namespace" href="Automation.Application.CloudStorage.html" />
    <link rel="prev" title="Automation.Application.AD package" href="Automation.Application.AD.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="automation-application-cloudapps-package">
<h1>Automation.Application.CloudApps package<a class="headerlink" href="#automation-application-cloudapps-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-Automation.Application.CloudApps.auth">
<span id="automation-application-cloudapps-auth-module"></span><h2>Automation.Application.CloudApps.auth module<a class="headerlink" href="#module-Automation.Application.CloudApps.auth" title="Permalink to this headline">¶</a></h2>
<p>Main Module for authenticating cloud apps.</p>
<p>GAuth and OneDriveAuth are the classes defined in this module to authenticate
google APIs and/or Microsoft Graph.</p>
<p>GAuth: Class for getting credential object and build google service for different google APIs.</p>
<p>OneDriveAuth: Class for authenticating OneDrive for business app.</p>
<dl class="docutils">
<dt>GAuth:</dt>
<dd><p class="first">__init__(log_object)  –  Initializes the GSuite Authentication object
with given P12 or JSON key file.</p>
<p>__repr__()  –  Representation string for the instance of the GAuth class</p>
<p>_get_credentials()  –  Creates credential object from JSON or P12 service account Key file</p>
<p>build_service(APIName, delegated_user)  –  Builds Google service object for invoking
Google APIs</p>
<p class="last">__del__()   –  Deletes the credentials from Storage</p>
</dd>
<dt>OneDriveAuth:</dt>
<dd><p class="first">__init__(log_object)    –  Initializes the MS Graph authentication object
with given account details.</p>
<p>__repr__()  –  Representation string for the instance of OneDriveAuth class</p>
<p class="last">authenticate_client()   –  Authenticates the OneDrive for business app to access MS Graph APIs.</p>
</dd>
</dl>
<div class="section" id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><strong>service_account_email</strong>   –  Treats service_account_email as read only attribute</div></blockquote>
<dl class="class">
<dt id="Automation.Application.CloudApps.auth.GAuth">
<em class="property">class </em><code class="descclassname">Automation.Application.CloudApps.auth.</code><code class="descname">GAuth</code><span class="sig-paren">(</span><em>logger</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/auth.html#GAuth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.auth.GAuth" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for authenticating Google API via service account P12 or JSON private key file.</p>
<dl class="method">
<dt id="Automation.Application.CloudApps.auth.GAuth.build_service">
<code class="descname">build_service</code><span class="sig-paren">(</span><em>api_name</em>, <em>delegated_user=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/auth.html#GAuth.build_service"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.auth.GAuth.build_service" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds Google service object for invoking Google APIs</p>
<p>Args:</p>
<blockquote>
<div><dl class="docutils">
<dt>api_name (Str)   –   The name of the API to invoke.</dt>
<dd>This should be provided as defined in constants.</dd>
<dt>delegated_user  (Str)   –   User’s email id to impersonate user.</dt>
<dd>Default value is admin email from constants</dd>
</dl>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>Google service object  (object) – Instance of Google client API resource class</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="Automation.Application.CloudApps.auth.GAuth.service_account_email">
<code class="descname">service_account_email</code><a class="headerlink" href="#Automation.Application.CloudApps.auth.GAuth.service_account_email" title="Permalink to this definition">¶</a></dt>
<dd><p>Treats service_account_email as read only attribute</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="Automation.Application.CloudApps.auth.OneDriveAuth">
<em class="property">class </em><code class="descclassname">Automation.Application.CloudApps.auth.</code><code class="descname">OneDriveAuth</code><span class="sig-paren">(</span><em>logger</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/auth.html#OneDriveAuth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.auth.OneDriveAuth" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for authenticating Microsoft Graph API via application id and secret key.</p>
<dl class="method">
<dt id="Automation.Application.CloudApps.auth.OneDriveAuth.authenticate_client">
<code class="descname">authenticate_client</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/auth.html#OneDriveAuth.authenticate_client"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.auth.OneDriveAuth.authenticate_client" title="Permalink to this definition">¶</a></dt>
<dd><p>This method authenticates the OneDrive App for MS Graph APIs.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-Automation.Application.CloudApps.cloud_apps">
<span id="automation-application-cloudapps-cloud-apps-module"></span><h2>Automation.Application.CloudApps.cloud_apps module<a class="headerlink" href="#module-Automation.Application.CloudApps.cloud_apps" title="Permalink to this headline">¶</a></h2>
<p>Main Module for invoking cloud APIs.</p>
<p>GAdmin, GMail, GDrive are the classes defined in this file.</p>
<dl class="docutils">
<dt>GAdmin: Class for performing GSuite Admin operations like getting user list,</dt>
<dd>modifying user properties etc.</dd>
</dl>
<p>GMail: Class for performing all gmail related operations.</p>
<p>GDrive: Class for performing all GDrive related operations.</p>
<dl class="docutils">
<dt>GAdmin:</dt>
<dd><p class="first">__init__(cloud_object)  –  Initializes the GAdmin object</p>
<p>__repr__()  –  Representation string for the instance of the GAdmin class</p>
<p class="last">__get_users()   –  Gets the list of users by calling GSuite Directory API</p>
</dd>
</dl>
<div class="section" id="id1">
<h3>Attributes<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><strong>users</strong>   –  Returns the user smtp address list from GSuite account</div></blockquote>
<dl class="docutils">
<dt>GMail:</dt>
<dd><p class="first">__init__(cloud_object)  –  Initializes the GMail object</p>
<p>__repr__()  –  Representation string for the instance of GMail class</p>
<p>_get_messages_prop()    –  Gets the message property of all the messages in the mailbox of a user</p>
<p>get_labels()    –  Fetches the list of labels for a GMail user</p>
<p>get_messages_prop() –  Gets message properties for user mailbox and stores it in TinyDB file</p>
<p>delete_messages()   –  Deletes specific messages inside user’s mailbox</p>
<p>append_message()    –  Appends a message into the user’s mailbox based on mail_insertion_type setting</p>
<p>_create_message()   –  Creates a MIME message by fetching a random page from wikipedia</p>
<p>_select_random_sender() –  Selects the random sender from available Google users</p>
<blockquote class="last">
<div>compare_msg_props()    –  Compares message properties</div></blockquote>
</dd>
<dt>GDrive:</dt>
<dd><p class="first">__init__(cloud_object)  –  Initializes the GDrive object</p>
<p>__repr__()  –  Representation string for the instance of GDrive class</p>
<p>create_files()  –  This method creates and upload files on user’s GDrive</p>
<p class="last">files_op()  –  Method to perform various operations on user’s GDRive</p>
</dd>
</dl>
<dl class="class">
<dt id="Automation.Application.CloudApps.cloud_apps.GAdmin">
<em class="property">class </em><code class="descclassname">Automation.Application.CloudApps.cloud_apps.</code><code class="descname">GAdmin</code><span class="sig-paren">(</span><em>cc_object</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/cloud_apps.html#GAdmin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.cloud_apps.GAdmin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for performing admin level operation for GSuite account.</p>
<dl class="attribute">
<dt id="Automation.Application.CloudApps.cloud_apps.GAdmin.users">
<code class="descname">users</code><a class="headerlink" href="#Automation.Application.CloudApps.cloud_apps.GAdmin.users" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the user smtp address list from GSuite account</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="Automation.Application.CloudApps.cloud_apps.GDrive">
<em class="property">class </em><code class="descclassname">Automation.Application.CloudApps.cloud_apps.</code><code class="descname">GDrive</code><span class="sig-paren">(</span><em>cc_object</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/cloud_apps.html#GDrive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.cloud_apps.GDrive" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for performing GDrive related operations.</p>
<dl class="method">
<dt id="Automation.Application.CloudApps.cloud_apps.GDrive.compare_file_properties">
<code class="descname">compare_file_properties</code><span class="sig-paren">(</span><em>oop=False</em>, <em>to_disk=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/cloud_apps.html#GDrive.compare_file_properties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.cloud_apps.GDrive.compare_file_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to compare file properties before backup and after restore.</p>
<blockquote>
<div><p>Args:</p>
<blockquote>
<div><p>oop (bool)  –  True if restore is out of place</p>
<p>to_disk (bool)  –  True if restore is to disk
Note: This paramether works only if oop is set to True</p>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.cloud_apps.GDrive.create_files">
<code class="descname">create_files</code><span class="sig-paren">(</span><em>unicode_data=False</em>, <em>no_of_docs=5</em>, <em>pdf=False</em>, <em>google_docs=False</em>, <em>new_folder=True</em>, <em>attempt=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/cloud_apps.html#GDrive.create_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.cloud_apps.GDrive.create_files" title="Permalink to this definition">¶</a></dt>
<dd><p>This method creates and upload files on user’s GDrive</p>
<p>Args:</p>
<blockquote>
<div><p>unicode_data  (boolean)  –  True if unicode data files have to be created</p>
<p>no_of_docs  (int)  –  Number of files to create and upload</p>
<p>pdf  (boolean)  –  True if pdf files have to be created</p>
<p>google_docs  (boolean)  –  True if Google Docs have to be created</p>
<p>new_folder  (boolean)  –  True if a new folder has to be created on user’s GDrive</p>
<p>attempt (str)   –  Attempt to document creation</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.cloud_apps.GDrive.delete_files">
<code class="descname">delete_files</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/cloud_apps.html#GDrive.delete_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.cloud_apps.GDrive.delete_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to delete all the files inside Automation folder</p>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.cloud_apps.GDrive.delete_folder">
<code class="descname">delete_folder</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/cloud_apps.html#GDrive.delete_folder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.cloud_apps.GDrive.delete_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to delete the folder on GDrive which was created via Automation
Folder id is fetched from local DB file.</p>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.cloud_apps.GDrive.delete_single_folder">
<code class="descname">delete_single_folder</code><span class="sig-paren">(</span><em>user_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/cloud_apps.html#GDrive.delete_single_folder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.cloud_apps.GDrive.delete_single_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to delete automation folder from specified user’s GDrive</p>
<p>Args:</p>
<blockquote>
<div>user_id  (str)  –  SMTP address of the user</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.cloud_apps.GDrive.download_files">
<code class="descname">download_files</code><span class="sig-paren">(</span><em>user=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/cloud_apps.html#GDrive.download_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.cloud_apps.GDrive.download_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to download all the files from GDrive Automation folder.
Folder id is fetched from local DB file.</p>
<blockquote>
<div><p>Args:</p>
<blockquote>
<div>user    (str)   –  SMTP Address of the user</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.cloud_apps.GDrive.download_single_file">
<code class="descname">download_single_file</code><span class="sig-paren">(</span><em>gdrive_service</em>, <em>file_id</em>, <em>file_name</em>, <em>mime_type</em>, <em>download_directory='C:\\CVS\\SP14\\vaultcx\\Source\\tools\\Automation\\Application\\CloudApps\\downloads'</em>, <em>get_hash=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/cloud_apps.html#GDrive.download_single_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.cloud_apps.GDrive.download_single_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to download a single file from GDrive based on the file ID.
File is downloaded in download folder defined in constants file.</p>
<blockquote>
<div><p>Args:</p>
<blockquote>
<div><p>gdrive_service (object)  –  Instance of GDrive API Resource</p>
<p>file_id (str)  –  Google assigned ID of the file</p>
<p>file_name (str)  – Name of the file to be downloaded</p>
<p>mime_type (str)  –  MIME type of the file</p>
<p>download_directory (str)  –  Directory name to download files into</p>
<p>get_hash (bool)  –  If true, MD5 hash is returned for the file.
File is deleted immediately after creating hash.</p>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.cloud_apps.GDrive.get_file_properties">
<code class="descname">get_file_properties</code><span class="sig-paren">(</span><em>user=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/cloud_apps.html#GDrive.get_file_properties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.cloud_apps.GDrive.get_file_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to fetch file properties from GDrive Automation folder and store them to local DB</p>
<blockquote>
<div><p>Args:</p>
<blockquote>
<div>user    (str)   –  SMTP Address of the user</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.cloud_apps.GDrive.get_folder_id">
<code class="descname">get_folder_id</code><span class="sig-paren">(</span><em>user_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/cloud_apps.html#GDrive.get_folder_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.cloud_apps.GDrive.get_folder_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to get the folder id for GDrive automation folder</p>
<p>Args:</p>
<blockquote>
<div>user_id (str)  –  SMTP address of the user</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>folder ID (str)  –  ID of the automation folder</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="Automation.Application.CloudApps.cloud_apps.GMail">
<em class="property">class </em><code class="descclassname">Automation.Application.CloudApps.cloud_apps.</code><code class="descname">GMail</code><span class="sig-paren">(</span><em>cc_object</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/cloud_apps.html#GMail"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.cloud_apps.GMail" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for performing GMail related operations.</p>
<dl class="method">
<dt id="Automation.Application.CloudApps.cloud_apps.GMail.append_message">
<code class="descname">append_message</code><span class="sig-paren">(</span><em>unicode_data=False</em>, <em>no_of_mails=10</em>, <em>mail_insertion_type='APPEND'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/cloud_apps.html#GMail.append_message"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.cloud_apps.GMail.append_message" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends a message into the user’s mailbox based on mail_insertion_type setting.
Message body is created by fetching random wiki page.
Please refer to Args for more details</p>
<blockquote>
<div><p>Args:</p>
<blockquote>
<div><p>sc_content (list) – Subclient content list. This can be obtained by
get_sc_content method of commvault class</p>
<p>unicode_data (Boolean) – If True, unicode mails will be created.</p>
<p>no_of_mails (int) – Number of mails to create in each mail account.</p>
<p>mail_insertion_type (str): Whether to import or append message.</p>
<blockquote>
<div><p>Allowed values:</p>
<blockquote>
<div><dl class="docutils">
<dt>APPEND: Directly inserts a message into only this user’s mailbox similar to IMAP APPEND,</dt>
<dd>bypassing most scanning and classification. Does not send a message.</dd>
<dt>IMPORT: Imports a message into only this user’s mailbox, with standard email delivery</dt>
<dd>scanning and classification similar to receiving via SMTP. Does not send a message</dd>
</dl>
<p>SEND: Sends the message to random sender</p>
</div></blockquote>
</div></blockquote>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.cloud_apps.GMail.compare_msg_props">
<code class="descname">compare_msg_props</code><span class="sig-paren">(</span><em>oop=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/cloud_apps.html#GMail.compare_msg_props"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.cloud_apps.GMail.compare_msg_props" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares message properties.</p>
<p>Args:</p>
<blockquote>
<div><p>oop  (boolean)  – True if the restore is out of place restore</p>
<blockquote>
<div>Default: False</div></blockquote>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>True on success</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.cloud_apps.GMail.delete_messages">
<code class="descname">delete_messages</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/cloud_apps.html#GMail.delete_messages"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.cloud_apps.GMail.delete_messages" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes specific messages inside user’s mailbox.</p>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.cloud_apps.GMail.get_labels">
<code class="descname">get_labels</code><span class="sig-paren">(</span><em>user_id</em>, <em>gmail_service=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/cloud_apps.html#GMail.get_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.cloud_apps.GMail.get_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetches the list of labels for a GMail user</p>
<p>Args:</p>
<blockquote>
<div><p>user_id (str)  –  SMTP address of the user</p>
<p>gmail_service (object)  –  GMail Resource service object</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>A dict containing label details</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.cloud_apps.GMail.get_messages_prop">
<code class="descname">get_messages_prop</code><span class="sig-paren">(</span><em>after_restore=False</em>, <em>label_list=None</em>, <em>google_resp_format='raw'</em>, <em>oop=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/cloud_apps.html#GMail.get_messages_prop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.cloud_apps.GMail.get_messages_prop" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets message properties for user mailbox and stores it in TinyDB file.</p>
<p>Args:</p>
<blockquote>
<div><p>after_restore  (boolean)  –  True if properties are fetched after restore job</p>
<p>label_list  (list)  –  List of labels to fetch from user mailbox</p>
<p>google_resp_format (str) – The format to return the message in</p>
<blockquote>
<div><p>Allowed values</p>
<blockquote>
<div><ul class="simple">
<li>full -</li>
<li>metadata -</li>
<li>minimal -</li>
<li><dl class="first docutils">
<dt>raw - With this parameter entire message payload is returned</dt>
<dd>as base64 encoded string.</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div></blockquote>
<p>oop  (boolean)  –  True if out of place restore</p>
</div></blockquote>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-Automation.Application.CloudApps.cloud_connector">
<span id="automation-application-cloudapps-cloud-connector-module"></span><h2>Automation.Application.CloudApps.cloud_connector module<a class="headerlink" href="#module-Automation.Application.CloudApps.cloud_connector" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>Main Module for setting input variables and creating objects of all other modules.</dt>
<dd>This module is imported in any test case.
You need to create an object of this module in the test case.</dd>
</dl>
<p>CloudConnector is the only class defined in this module.</p>
<p>CloudConnector: Class for initializing input variables and other module objects.</p>
<dl class="docutils">
<dt>CloudConnector:</dt>
<dd><p class="first">__init__(testcase_object)   –  Initializes the input variables,
logging and creates object from other modules</p>
<p class="last">__repr__()                  –  Representation string for the instance of
CloudConnector class</p>
</dd>
</dl>
<div class="section" id="id2">
<h3>Attributes<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><strong>db</strong>  –  Returns the object of DbOperations class</p>
<p><strong>cvoperations</strong>    –  Returns the object of CvOperation class</p>
<p><strong>auth</strong>    –  Returns the object of GAuth class</p>
<p><strong>one_drive_auth</strong>  –  Returns the object of OneDriveAuth class</p>
<p><strong>gadmin</strong>  –  Returns the object of GAdmin class</p>
<p><strong>gmail</strong>   –  Returns the object of GMail class</p>
<p><strong>gdrive</strong>   –  Returns the object of GDrive class</p>
<p><strong>one_drive</strong>   –  Returns the object of OneDrive class</p>
</div></blockquote>
<dl class="class">
<dt id="Automation.Application.CloudApps.cloud_connector.CloudConnector">
<em class="property">class </em><code class="descclassname">Automation.Application.CloudApps.cloud_connector.</code><code class="descname">CloudConnector</code><span class="sig-paren">(</span><em>tc_object</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/cloud_connector.html#CloudConnector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.cloud_connector.CloudConnector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for initializing input variables and object creation from different modules</p>
<dl class="attribute">
<dt id="Automation.Application.CloudApps.cloud_connector.CloudConnector.auth">
<code class="descname">auth</code><a class="headerlink" href="#Automation.Application.CloudApps.cloud_connector.CloudConnector.auth" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the object of GAuth class</p>
</dd></dl>

<dl class="attribute">
<dt id="Automation.Application.CloudApps.cloud_connector.CloudConnector.cvoperations">
<code class="descname">cvoperations</code><a class="headerlink" href="#Automation.Application.CloudApps.cloud_connector.CloudConnector.cvoperations" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the object of CvOperation class</p>
</dd></dl>

<dl class="attribute">
<dt id="Automation.Application.CloudApps.cloud_connector.CloudConnector.dbo">
<code class="descname">dbo</code><a class="headerlink" href="#Automation.Application.CloudApps.cloud_connector.CloudConnector.dbo" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the object of DbOperations class</p>
</dd></dl>

<dl class="attribute">
<dt id="Automation.Application.CloudApps.cloud_connector.CloudConnector.gadmin">
<code class="descname">gadmin</code><a class="headerlink" href="#Automation.Application.CloudApps.cloud_connector.CloudConnector.gadmin" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the object of GAdmin class</p>
</dd></dl>

<dl class="attribute">
<dt id="Automation.Application.CloudApps.cloud_connector.CloudConnector.gdrive">
<code class="descname">gdrive</code><a class="headerlink" href="#Automation.Application.CloudApps.cloud_connector.CloudConnector.gdrive" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the object of GDrive class</p>
</dd></dl>

<dl class="attribute">
<dt id="Automation.Application.CloudApps.cloud_connector.CloudConnector.gmail">
<code class="descname">gmail</code><a class="headerlink" href="#Automation.Application.CloudApps.cloud_connector.CloudConnector.gmail" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the object of GMail class</p>
</dd></dl>

<dl class="attribute">
<dt id="Automation.Application.CloudApps.cloud_connector.CloudConnector.one_drive">
<code class="descname">one_drive</code><a class="headerlink" href="#Automation.Application.CloudApps.cloud_connector.CloudConnector.one_drive" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the object of OneDrive class</p>
</dd></dl>

<dl class="attribute">
<dt id="Automation.Application.CloudApps.cloud_connector.CloudConnector.one_drive_auth">
<code class="descname">one_drive_auth</code><a class="headerlink" href="#Automation.Application.CloudApps.cloud_connector.CloudConnector.one_drive_auth" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the object of OneDriveAuth class</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-Automation.Application.CloudApps.constants">
<span id="automation-application-cloudapps-constants-module"></span><h2>Automation.Application.CloudApps.constants module<a class="headerlink" href="#module-Automation.Application.CloudApps.constants" title="Permalink to this headline">¶</a></h2>
<p>Main module to define constants for Cloud Connector Automation</p>
</div>
<div class="section" id="module-Automation.Application.CloudApps.db">
<span id="automation-application-cloudapps-db-module"></span><h2>Automation.Application.CloudApps.db module<a class="headerlink" href="#module-Automation.Application.CloudApps.db" title="Permalink to this headline">¶</a></h2>
<p>Main module for performing JSON read/write operations for Google data.</p>
<p>DbOperations is the only class is defined in this file.</p>
<dl class="docutils">
<dt>DbOperations: Performs database (CRUD) operations using TinyDB.</dt>
<dd>Uses JSON storage by default</dd>
<dt>DbOperations:</dt>
<dd><p class="first">__init__(cloud_object)  –  Initializes the DbOperation object by creating a JSON db</p>
<p>save_into_table()   –  Method to create and table and save the data into it</p>
<p>search_label()  –  Method to search whether a label exists in the labels table</p>
<p>get_length()    –  Method to check the length of a table of database</p>
<p>get_content()   –  Method to fetch all the content of a table</p>
<p>get_message_id_list()   –  Method to get the ids of all messages from
message property table</p>
<p>check_db_length()   –  Method to check whether both the tables contain
same number of documents</p>
<p>get_folder_cvid()   –  Method to get the folder CVID of the
already uploaded folder to GDrive</p>
<p class="last">search_md5checksum()    –  Method to search whether a label exists in the labels table</p>
</dd>
</dl>
<dl class="class">
<dt id="Automation.Application.CloudApps.db.DbOperations">
<em class="property">class </em><code class="descclassname">Automation.Application.CloudApps.db.</code><code class="descname">DbOperations</code><span class="sig-paren">(</span><em>cc_object</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/db.html#DbOperations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.db.DbOperations" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for performing database operations on TinyDB</p>
<dl class="method">
<dt id="Automation.Application.CloudApps.db.DbOperations.check_db_length">
<code class="descname">check_db_length</code><span class="sig-paren">(</span><em>user_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/db.html#DbOperations.check_db_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.db.DbOperations.check_db_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to check whether both the tables contain same number of documents.
This method will be used to check the number of document in the table before backup
and the table after restore.</p>
<blockquote>
<div><p>Args:</p>
<blockquote>
<div>user_id  (str)  –  SMTP address of the user</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>boolean</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.db.DbOperations.get_content">
<code class="descname">get_content</code><span class="sig-paren">(</span><em>table_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/db.html#DbOperations.get_content"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.db.DbOperations.get_content" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to fetch all the content of a table.</p>
<p>Args:</p>
<blockquote>
<div>table_name  (str)  –  Name of the table or database</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>content  (list or Dict)  –  content of the table</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.db.DbOperations.get_folder_cvid">
<code class="descname">get_folder_cvid</code><span class="sig-paren">(</span><em>user_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/db.html#DbOperations.get_folder_cvid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.db.DbOperations.get_folder_cvid" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to get the folder CVID of the already uploaded folder to GDrive</p>
<p>Args:</p>
<blockquote>
<div>user_id  (str)  –  SMTP address of the user</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>Id of the folder (str)</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.db.DbOperations.get_length">
<code class="descname">get_length</code><span class="sig-paren">(</span><em>table_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/db.html#DbOperations.get_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.db.DbOperations.get_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to check the length of a table of database.</p>
<p>Args:</p>
<blockquote>
<div>table_name  (str)  –  Name of the table or database</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>length  (int)  –  Number of documents in a table or database</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.db.DbOperations.get_message_id_list">
<code class="descname">get_message_id_list</code><span class="sig-paren">(</span><em>user_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/db.html#DbOperations.get_message_id_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.db.DbOperations.get_message_id_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to get the ids of all messages from message property table</p>
<p>Args:</p>
<blockquote>
<div>user_id  (str)  –  SMTP address of the user</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>List  (list)  –  List of the messages ids</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.db.DbOperations.save_into_table">
<code class="descname">save_into_table</code><span class="sig-paren">(</span><em>user_id</em>, <em>data</em>, <em>data_type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/db.html#DbOperations.save_into_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.db.DbOperations.save_into_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to create and table and save the data into it.</p>
<p>Args:</p>
<blockquote>
<div><p>user_id  (str)  – SMTP address of the user</p>
<p>data        (list or dict)  –  data to write into the table</p>
<blockquote>
<div>In case of list, it should be list of dicts</div></blockquote>
<p>data_type  (str)  –  Type of the data to insert/update db</p>
<blockquote>
<div><p>Valid Values:</p>
<blockquote>
<div><p>messages  –  If the data parameter contains message properties</p>
<p>labels  – If data parameter contains label properties</p>
<p>files  –  If the data contains GDrive file information</p>
<p>list  –  If the data contains job related info</p>
</div></blockquote>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.db.DbOperations.search_label">
<code class="descname">search_label</code><span class="sig-paren">(</span><em>value</em>, <em>user_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/db.html#DbOperations.search_label"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.db.DbOperations.search_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to search whether a label exists in the labels table</p>
<p>Args:</p>
<blockquote>
<div><p>value  (str)  –  Name of the label to search in the table</p>
<p>user_id  (str)  –  smtp address of the user. This is prefixed in the table name</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>True  –  If the value exists in the table</p>
<p>False –  If the value doesn’t exist in the table</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.db.DbOperations.search_md5checksum">
<code class="descname">search_md5checksum</code><span class="sig-paren">(</span><em>value</em>, <em>user_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/db.html#DbOperations.search_md5checksum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.db.DbOperations.search_md5checksum" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to search whether a label exists in the labels table</p>
<p>Args:</p>
<blockquote>
<div><p>value  (str)  –  Name of the label to search in the table</p>
<p>user_id  (str)  –  smtp address of the user. This is prefixed in the table name</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>True  –  If the value exists in the table</p>
<p>False –  If the value doesn’t exist in the table</p>
</div></blockquote>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-Automation.Application.CloudApps.exception">
<span id="automation-application-cloudapps-exception-module"></span><h2>Automation.Application.CloudApps.exception module<a class="headerlink" href="#module-Automation.Application.CloudApps.exception" title="Permalink to this headline">¶</a></h2>
<p>File for handling all the exceptions for the Cloud Apps Automation package.</p>
<dl class="docutils">
<dt>EXCEPTION_DICT:</dt>
<dd><p class="first">A python dictionary for holding all the exception messages for a specific event or class.</p>
<p>Any exceptions to be raised from the Automation in a module should be added to this dictionary.</p>
<p>where,</p>
<blockquote class="last">
<div><ul class="simple">
<li>the key is the module name or the class name where the exception is raised</li>
<li>the value is a dictionary:<ul>
<li>key is a unique ID to identify the exception message</li>
<li>value is the exception message</li>
</ul>
</li>
</ul>
</div></blockquote>
</dd>
</dl>
<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="docutils">
<dt>CVCloudException:</dt>
<dd><p class="first">Class inheriting the “Exception” Base class for raising
a specific exception for the Cloud Apps Automation package.</p>
<p>The user should create an instance of the CVCloudException class:</p>
<blockquote>
<div><p><strong>CVCloudException(exception_module, exception_id, exception_message)</strong></p>
<p>where,</p>
<blockquote>
<div><ul class="simple">
<li>exception_module:   the module in which the exception is being raised<ul>
<li>key in the EXCEPTION_DICT</li>
</ul>
</li>
<li>exception_id:       unique ID which identifies the message for the Exception</li>
<li>exception_message:  additional message to the exception<ul>
<li>only applicable if the user wishes to provide an additional message to the
exception along with the message already present as the value for the
exception_module - exception_id pair</li>
</ul>
</li>
</ul>
</div></blockquote>
</div></blockquote>
<p>Example:</p>
<blockquote class="last">
<div><p><strong>raise CVCloudException(‘GMail’, ‘102’)</strong></p>
<p>will raise the exception as:</p>
<blockquote>
<div>CVCloudException: Exception while inserting message into user mailbox</div></blockquote>
<p>and, <strong>raise CVCloudException(‘GMail’, ‘108’, ‘Please check the value’)</strong></p>
<p>will raise:</p>
<blockquote>
<div><p>CVCloudException: Invalid mail insertion type provided.</p>
<p>Valid values:</p>
<p>APPEND</p>
<p>IMPORT</p>
<p>Please check the value</p>
</div></blockquote>
<p>where the user given message is appended to the original message joined by new line</p>
</div></blockquote>
</dd>
</dl>
<dl class="exception">
<dt id="Automation.Application.CloudApps.exception.CVCloudException">
<em class="property">exception </em><code class="descclassname">Automation.Application.CloudApps.exception.</code><code class="descname">CVCloudException</code><span class="sig-paren">(</span><em>exception_module</em>, <em>exception_id</em>, <em>exception_message=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/exception.html#CVCloudException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.exception.CVCloudException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
<p>Exception class for raising exception specific to a module.</p>
</dd></dl>

</div>
<div class="section" id="module-Automation.Application.CloudApps.google">
<span id="automation-application-cloudapps-google-module"></span><h2>Automation.Application.CloudApps.google module<a class="headerlink" href="#module-Automation.Application.CloudApps.google" title="Permalink to this headline">¶</a></h2>
<p>Main Module for invoking cloud APIs.</p>
<p>GAdmin, GMail, GDrive are the classes defined in this file.</p>
<dl class="docutils">
<dt>GAdmin: Class for performing GSuite Admin operations like getting user list,</dt>
<dd>modifying user properties etc.</dd>
</dl>
<p>GMail: Class for performing all gmail related operations.</p>
<p>GDrive: Class for performing all GDrive related operations.</p>
<dl class="docutils">
<dt>GAdmin:</dt>
<dd><p class="first">__init__(cloud_object)  –  Initializes the GAdmin object</p>
<p>__repr__()  –  Representation string for the instance of the GAdmin class</p>
<p class="last">__get_users()   –  Gets the list of users by calling GSuite Directory API</p>
</dd>
</dl>
<div class="section" id="id3">
<h3>Attributes<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><strong>users</strong>   –  Returns the user smtp address list from GSuite account</div></blockquote>
<dl class="docutils">
<dt>GMail:</dt>
<dd><p class="first">__init__(cloud_object)  –  Initializes the GMail object</p>
<p>__repr__()  –  Representation string for the instance of GMail class</p>
<p>_get_messages_prop()    –  Gets the message property of all the messages
in the mailbox of a user</p>
<p>get_labels()    –  Fetches the list of labels for a GMail user</p>
<p>get_messages_prop() –  Gets message properties for user mailbox
and stores it in TinyDB file</p>
<p>delete_messages()   –  Deletes specific messages inside user’s mailbox</p>
<p>append_message()    –  Appends a message into the user’s mailbox
based on mail_insertion_type setting</p>
<p>_create_message()   –  Creates a MIME message by fetching a random page from wikipedia</p>
<p>_select_random_sender() –  Selects the random sender from available Google users</p>
<blockquote class="last">
<div>compare_msg_props()    –  Compares message properties</div></blockquote>
</dd>
<dt>GDrive:</dt>
<dd><p class="first">__init__(cloud_object)  –  Initializes the GDrive object</p>
<p>__repr__()  –  Representation string for the instance of GDrive class</p>
<p>create_files()  –  This method creates and upload files on user’s GDrive</p>
<p class="last">files_op()  –  Method to perform various operations on user’s GDRive</p>
</dd>
</dl>
<dl class="class">
<dt id="Automation.Application.CloudApps.google.GAdmin">
<em class="property">class </em><code class="descclassname">Automation.Application.CloudApps.google.</code><code class="descname">GAdmin</code><span class="sig-paren">(</span><em>cc_object</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/google.html#GAdmin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.google.GAdmin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for performing admin level operation for GSuite account.</p>
<dl class="attribute">
<dt id="Automation.Application.CloudApps.google.GAdmin.users">
<code class="descname">users</code><a class="headerlink" href="#Automation.Application.CloudApps.google.GAdmin.users" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the user smtp address list from GSuite account</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="Automation.Application.CloudApps.google.GDrive">
<em class="property">class </em><code class="descclassname">Automation.Application.CloudApps.google.</code><code class="descname">GDrive</code><span class="sig-paren">(</span><em>cc_object</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/google.html#GDrive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.google.GDrive" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for performing GDrive related operations.</p>
<dl class="method">
<dt id="Automation.Application.CloudApps.google.GDrive.compare_file_properties">
<code class="descname">compare_file_properties</code><span class="sig-paren">(</span><em>oop=False</em>, <em>to_disk=False</em>, <em>incremental=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/google.html#GDrive.compare_file_properties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.google.GDrive.compare_file_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to compare file properties before backup and after restore.</p>
<blockquote>
<div><p>Args:</p>
<blockquote>
<div><p>oop (bool)  –  True if restore is out of place</p>
<p>to_disk (bool)  –  True if restore is to disk
Note: This paramether works only if oop is set to True</p>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.google.GDrive.create_files">
<code class="descname">create_files</code><span class="sig-paren">(</span><em>unicode_data=False</em>, <em>no_of_docs=5</em>, <em>pdf=False</em>, <em>google_docs=False</em>, <em>new_folder=True</em>, <em>attempt=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/google.html#GDrive.create_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.google.GDrive.create_files" title="Permalink to this definition">¶</a></dt>
<dd><p>This method creates and upload files on user’s GDrive</p>
<p>Args:</p>
<blockquote>
<div><p>unicode_data  (boolean)  –  True if unicode data files have to be created</p>
<p>no_of_docs  (int)  –  Number of files to create and upload</p>
<p>pdf  (boolean)  –  True if pdf files have to be created</p>
<p>google_docs  (boolean)  –  True if Google Docs have to be created</p>
<p>new_folder  (boolean)  –  If True creates a new folder on GDrive</p>
<p>attempt (str)   –  Attempt to document creation</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.google.GDrive.delete_files">
<code class="descname">delete_files</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/google.html#GDrive.delete_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.google.GDrive.delete_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to delete all the files inside Automation folder</p>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.google.GDrive.delete_folder">
<code class="descname">delete_folder</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/google.html#GDrive.delete_folder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.google.GDrive.delete_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to delete the folder on GDrive which was created via Automation
Folder id is fetched from local DB file.</p>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.google.GDrive.delete_single_folder">
<code class="descname">delete_single_folder</code><span class="sig-paren">(</span><em>user_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/google.html#GDrive.delete_single_folder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.google.GDrive.delete_single_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to delete automation folder from specified user’s GDrive</p>
<p>Args:</p>
<blockquote>
<div>user_id  (str)  –  SMTP address of the user</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.google.GDrive.download_files">
<code class="descname">download_files</code><span class="sig-paren">(</span><em>user=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/google.html#GDrive.download_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.google.GDrive.download_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to download all the files from GDrive Automation folder.
Folder id is fetched from local DB file.</p>
<blockquote>
<div><p>Args:</p>
<blockquote>
<div>user    (str)   –  SMTP Address of the user</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.google.GDrive.download_single_file">
<code class="descname">download_single_file</code><span class="sig-paren">(</span><em>gdrive_service</em>, <em>file_id</em>, <em>file_name</em>, <em>mime_type</em>, <em>download_directory='C:\\CVS\\SP14\\vaultcx\\Source\\tools\\Automation\\Application\\CloudApps\\downloads'</em>, <em>get_hash=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/google.html#GDrive.download_single_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.google.GDrive.download_single_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to download a single file from GDrive based on the file ID.
File is downloaded in download folder defined in constants file.</p>
<blockquote>
<div><p>Args:</p>
<blockquote>
<div><p>gdrive_service (object)  –  Instance of GDrive API Resource</p>
<p>file_id (str)  –  Google assigned ID of the file</p>
<p>file_name (str)  – Name of the file to be downloaded</p>
<p>mime_type (str)  –  MIME type of the file</p>
<p>download_directory (str)  –  Directory name to download files into</p>
<p>get_hash (bool)  –  If true, MD5 hash is returned for the file.
File is deleted immediately after creating hash.</p>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.google.GDrive.get_file_properties">
<code class="descname">get_file_properties</code><span class="sig-paren">(</span><em>user=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/google.html#GDrive.get_file_properties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.google.GDrive.get_file_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to fetch file properties from GDrive Automation folder and store them to local DB</p>
<blockquote>
<div><p>Args:</p>
<blockquote>
<div>user    (str)   –  SMTP Address of the user</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.google.GDrive.get_folder_id">
<code class="descname">get_folder_id</code><span class="sig-paren">(</span><em>user_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/google.html#GDrive.get_folder_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.google.GDrive.get_folder_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to get the folder id for GDrive automation folder</p>
<p>Args:</p>
<blockquote>
<div>user_id (str)  –  SMTP address of the user</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>folder ID (str)  –  ID of the automation folder</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="Automation.Application.CloudApps.google.GMail">
<em class="property">class </em><code class="descclassname">Automation.Application.CloudApps.google.</code><code class="descname">GMail</code><span class="sig-paren">(</span><em>cc_object</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/google.html#GMail"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.google.GMail" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for performing GMail related operations.</p>
<dl class="method">
<dt id="Automation.Application.CloudApps.google.GMail.append_message">
<code class="descname">append_message</code><span class="sig-paren">(</span><em>unicode_data=False</em>, <em>no_of_mails=10</em>, <em>mail_insertion_type='APPEND'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/google.html#GMail.append_message"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.google.GMail.append_message" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends a message into the user’s mailbox based on mail_insertion_type setting.
Message body is created by fetching random wiki page.
Please refer to Args for more details</p>
<blockquote>
<div><p>Args:</p>
<blockquote>
<div><p>sc_content (list) – Subclient content list. This can be obtained by
get_sc_content method of commvault class</p>
<p>unicode_data (Boolean) – If True, unicode mails will be created.</p>
<p>no_of_mails (int) – Number of mails to create in each mail account.</p>
<p>mail_insertion_type (str): Whether to import or append message.</p>
<blockquote>
<div><p>Allowed values:</p>
<blockquote>
<div><p>APPEND: Directly inserts a message into only this user’s mailbox
similar to IMAP APPEND, bypassing most scanning and classification.
Does not send a message.</p>
<p>IMPORT: Imports a message into only this user’s mailbox,
with standard email delivery scanning and classification similar to
receiving via SMTP. Does not send a message</p>
<p>SEND: Sends the message to random sender</p>
</div></blockquote>
</div></blockquote>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.google.GMail.compare_msg_props">
<code class="descname">compare_msg_props</code><span class="sig-paren">(</span><em>oop=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/google.html#GMail.compare_msg_props"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.google.GMail.compare_msg_props" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares message properties.</p>
<p>Args:</p>
<blockquote>
<div><p>oop  (boolean)  – True if the restore is out of place restore</p>
<blockquote>
<div>Default: False</div></blockquote>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>True on success</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.google.GMail.delete_messages">
<code class="descname">delete_messages</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/google.html#GMail.delete_messages"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.google.GMail.delete_messages" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes specific messages inside user’s mailbox.</p>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.google.GMail.get_labels">
<code class="descname">get_labels</code><span class="sig-paren">(</span><em>user_id</em>, <em>gmail_service=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/google.html#GMail.get_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.google.GMail.get_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetches the list of labels for a GMail user</p>
<p>Args:</p>
<blockquote>
<div><p>user_id (str)  –  SMTP address of the user</p>
<p>gmail_service (object)  –  GMail Resource service object</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>A dict containing label details</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.google.GMail.get_messages_prop">
<code class="descname">get_messages_prop</code><span class="sig-paren">(</span><em>after_restore=False</em>, <em>label_list=None</em>, <em>google_resp_format='raw'</em>, <em>oop=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/google.html#GMail.get_messages_prop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.google.GMail.get_messages_prop" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets message properties for user mailbox and stores it in TinyDB file.</p>
<p>Args:</p>
<blockquote>
<div><p>after_restore  (boolean)  –  True if properties are fetched after restore job</p>
<p>label_list  (list)  –  List of labels to fetch from user mailbox</p>
<p>google_resp_format (str) – The format to return the message in</p>
<blockquote>
<div><p>Allowed values</p>
<blockquote>
<div><ul class="simple">
<li>full -</li>
<li>metadata -</li>
<li>minimal -</li>
<li>raw - base64 encoded string</li>
</ul>
</div></blockquote>
</div></blockquote>
<p>oop  (boolean)  –  True if out of place restore</p>
</div></blockquote>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-Automation.Application.CloudApps.one_drive">
<span id="automation-application-cloudapps-one-drive-module"></span><h2>Automation.Application.CloudApps.one_drive module<a class="headerlink" href="#module-Automation.Application.CloudApps.one_drive" title="Permalink to this headline">¶</a></h2>
<p>Main Module for invoking OneDrive APIs.</p>
<p>OneDrive is the only class defined in this file.</p>
<p>OneDrive: Class for performing OneDrive related operations</p>
<p>OneDrive:</p>
<blockquote>
<div><p>__init__(self, cc_object)           –  Initializes the OneDrive object</p>
<p>discover(self)                      –  Method to discover users on azure AD</p>
<p>create_files()                      –  This method creates and
upload files on user’s OneDrive</p>
<p>get_file_properties()               –  Method to fetch file properties from
OneDrive Automation folder and store them to local DB</p>
<p>get_folder_id_from_graph()         –  Method to fetch folder id of
the automation folder</p>
<p>_get_files_list()                   –  Method to get the list of file metadata</p>
<p>compare_file_properties()           –  Method to compare file properties</p>
<p>_compare_files(self, user_id)       –  Compares the file properties of
a single user</p>
<p>delete_folder()                     –  Method to delete automation folder
from user OneDrive</p>
<p>_process_response()                 –  Process the Graph API response and
returns the minimal dict</p>
<p>request()                           –  Method to make Graph API requests</p>
</div></blockquote>
<dl class="class">
<dt id="Automation.Application.CloudApps.one_drive.OneDrive">
<em class="property">class </em><code class="descclassname">Automation.Application.CloudApps.one_drive.</code><code class="descname">OneDrive</code><span class="sig-paren">(</span><em>cc_object</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/one_drive.html#OneDrive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.one_drive.OneDrive" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for performing OneDrive related operations.</p>
<dl class="method">
<dt id="Automation.Application.CloudApps.one_drive.OneDrive.compare_file_properties">
<code class="descname">compare_file_properties</code><span class="sig-paren">(</span><em>oop=False</em>, <em>to_disk=False</em>, <em>incremental=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/one_drive.html#OneDrive.compare_file_properties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.one_drive.OneDrive.compare_file_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to compare file properties before backup and after restore.</p>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.one_drive.OneDrive.create_files">
<code class="descname">create_files</code><span class="sig-paren">(</span><em>unicode_data=False</em>, <em>no_of_docs=5</em>, <em>pdf=False</em>, <em>new_folder=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/one_drive.html#OneDrive.create_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.one_drive.OneDrive.create_files" title="Permalink to this definition">¶</a></dt>
<dd><p>This method creates and upload files on user’s OneDrive</p>
<p>Args:</p>
<blockquote>
<div><p>unicode_data  (boolean)  –  True if unicode data files
have to be created</p>
<p>no_of_docs  (int)  –  Number of files to create and upload</p>
<p>pdf  (boolean)  –  True if pdf files have to be created</p>
<p>new_folder  (boolean)  –  True if a new folder has to be
created on user’s GDrive</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.one_drive.OneDrive.delete_folder">
<code class="descname">delete_folder</code><span class="sig-paren">(</span><em>user_id=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/one_drive.html#OneDrive.delete_folder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.one_drive.OneDrive.delete_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to delete the automation folder from user OneDrive.</p>
<p>Args:</p>
<blockquote>
<div>user_id (str)   –  User SMTP Address</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.one_drive.OneDrive.discover">
<code class="descname">discover</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/one_drive.html#OneDrive.discover"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.one_drive.OneDrive.discover" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to discover users on azure AD</p>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.one_drive.OneDrive.download_files">
<code class="descname">download_files</code><span class="sig-paren">(</span><em>user=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/one_drive.html#OneDrive.download_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.one_drive.OneDrive.download_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to download all the files from OneDrive Automation folder.
Folder id is fetched from local DB file.</p>
<blockquote>
<div><p>Args:</p>
<blockquote>
<div>user    (str)   –  SMTP Address of the user</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.one_drive.OneDrive.download_single_file">
<code class="descname">download_single_file</code><span class="sig-paren">(</span><em>user_id</em>, <em>file_path</em>, <em>download_directory</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/one_drive.html#OneDrive.download_single_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.one_drive.OneDrive.download_single_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to download a single file from OneDrive based on the file path.
File is downloaded in one drive download folder defined in constants file.</p>
<blockquote>
<div><p>Args:</p>
<blockquote>
<div><p>user_id    (str)   –  SMTP Address of the user</p>
<p>file_path (str)  –  File path relative to OneDrive root folder</p>
<p>download_directory (str)  –  Directory name to download files into</p>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.one_drive.OneDrive.get_file_properties">
<code class="descname">get_file_properties</code><span class="sig-paren">(</span><em>user=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/one_drive.html#OneDrive.get_file_properties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.one_drive.OneDrive.get_file_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to fetch file properties from OneDrive Automation folder and store them to local DB</p>
<blockquote>
<div><p>Agrs:</p>
<blockquote>
<div>user  (str)   –  SMTP address of the user</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.one_drive.OneDrive.get_folder_id_from_graph">
<code class="descname">get_folder_id_from_graph</code><span class="sig-paren">(</span><em>user_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/one_drive.html#OneDrive.get_folder_id_from_graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.one_drive.OneDrive.get_folder_id_from_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>This method fetches the folder id of the automation folder on users OneDrive</p>
<p>Args:</p>
<blockquote>
<div>user_id (str)   –  User SMTP address</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>folder_id   (str)   –  ID of the automation folder</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.one_drive.OneDrive.request">
<code class="descname">request</code><span class="sig-paren">(</span><em>url=None</em>, <em>method='GET'</em>, <em>data=None</em>, <em>headers=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/one_drive.html#OneDrive.request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.one_drive.OneDrive.request" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to make a request to Graph URL via OAUTH request method</p>
<p>Args:</p>
<blockquote>
<div><p>url (str)   –  API Endpoint to make request to</p>
<p>method (str)    –  API call method</p>
<dl class="docutils">
<dt>Valid Values:</dt>
<dd><p class="first">GET</p>
<p>POST</p>
<p>PUT</p>
<p class="last">DELETE</p>
</dd>
</dl>
<p>data (dict) –  Data to be sent with POST/PUT requests</p>
<p>headers (dict)  –  Request headers.</p>
<p>Default:</p>
<p>self._headers</p>
<p>Access token is automatically appended by
OAuth2Session class request method used in this module.</p>
</div></blockquote>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-Automation.Application.CloudApps.operations">
<span id="automation-application-cloudapps-operations-module"></span><h2>Automation.Application.CloudApps.operations module<a class="headerlink" href="#module-Automation.Application.CloudApps.operations" title="Permalink to this headline">¶</a></h2>
<p>Main module for communicating with cvpysdk for all commvault related operations.</p>
<p>CvOperation class is defined in this file.</p>
<p>CvOperation: Performs Commvault related operations using cvpysdk</p>
<dl class="docutils">
<dt>CvOperation:</dt>
<dd><p class="first">__init__(cloud_object)  –  Initializes the CvOperation object</p>
<p>restore_subclient() –  Runs restore for subclient object of cvpysdk</p>
<p>verify_browse() –  Verifies the commvault browse with Google folders</p>
<dl class="docutils">
<dt>check_job_status()  –  Checks the status of job until it is finished and</dt>
<dd>raises exception on pending, failure etc.</dd>
</dl>
<p class="last">cleanup()   –  Method to remove temp data which is generated/stored during automation run</p>
</dd>
</dl>
<dl class="class">
<dt id="Automation.Application.CloudApps.operations.CvOperation">
<em class="property">class </em><code class="descclassname">Automation.Application.CloudApps.operations.</code><code class="descname">CvOperation</code><span class="sig-paren">(</span><em>cc_object</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/operations.html#CvOperation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.operations.CvOperation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for performing Commvault operations</p>
<dl class="method">
<dt id="Automation.Application.CloudApps.operations.CvOperation.check_job_status">
<code class="descname">check_job_status</code><span class="sig-paren">(</span><em>job</em>, <em>backup_level_tc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/operations.html#CvOperation.check_job_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.operations.CvOperation.check_job_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the status of job until it is finished and
raises exception on pending, failure etc.</p>
<blockquote>
<div><p>Args:</p>
<blockquote>
<div>job (Object of job class of CVPySDK)</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.operations.CvOperation.cleanup">
<code class="descname">cleanup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/operations.html#CvOperation.cleanup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.operations.CvOperation.cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>This method will remove temp data which is generated/stored during automation run.
This method doesn’t remove TinyDB database. That database is purged before a new run.
Directory paths are fetched from Cloud Apps constants file.</p>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.operations.CvOperation.restore_subclient">
<code class="descname">restore_subclient</code><span class="sig-paren">(</span><em>oop=False</em>, <em>to_disk=False</em>, <em>incremental=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/operations.html#CvOperation.restore_subclient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.operations.CvOperation.restore_subclient" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs restore for subclient object of cvpysdk.
Stores job list in the db. Raises exception if restore job is not successful</p>
<blockquote>
<div><p>Args:</p>
<blockquote>
<div><dl class="docutils">
<dt>oop (boolean)  –  set it True to run out of place restore</dt>
<dd>Default: False</dd>
</dl>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.operations.CvOperation.verify_browse">
<code class="descname">verify_browse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/operations.html#CvOperation.verify_browse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.operations.CvOperation.verify_browse" title="Permalink to this definition">¶</a></dt>
<dd><p>Verifies the commvault browse with Google folders</p>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.operations.CvOperation.verify_discover">
<code class="descname">verify_discover</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/operations.html#CvOperation.verify_discover"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.operations.CvOperation.verify_discover" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to verify user discovery</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-Automation.Application.CloudApps.wiki">
<span id="automation-application-cloudapps-wiki-module"></span><h2>Automation.Application.CloudApps.wiki module<a class="headerlink" href="#module-Automation.Application.CloudApps.wiki" title="Permalink to this headline">¶</a></h2>
<p>Main module for calling wikipedia API to create mail body</p>
<p>Wiki class is defined in this module.</p>
<p>Wiki: Calls wikipedia API and fetches random pages.</p>
<dl class="docutils">
<dt>Wiki:</dt>
<dd><p class="first">__init__(log)   –  Initializes the wiki object</p>
<p>_set_params()   –  Sets parameter dict for calling respective wikipedia API</p>
<p>create_message_from_wiki()  –  Fetches page title and content of a random page from wikipedia</p>
<p>__get_wikiapi_service() –  Returns a random language wiki api service.
Useful to create unicode mails.</p>
<p>make_request()  –  This method make a request to API endpoint.</p>
<p>create_docx()   –  This method creates a new documents and saves it into the directory
defined in constants file.</p>
<p class="last">make_valid_filename()  –  This method returns the valid file name for Windows OS</p>
</dd>
</dl>
<dl class="class">
<dt id="Automation.Application.CloudApps.wiki.Wiki">
<em class="property">class </em><code class="descclassname">Automation.Application.CloudApps.wiki.</code><code class="descname">Wiki</code><span class="sig-paren">(</span><em>log</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/wiki.html#Wiki"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.wiki.Wiki" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class to interact with wikipedia API to fetch random articles</p>
<dl class="method">
<dt id="Automation.Application.CloudApps.wiki.Wiki.create_docx">
<code class="descname">create_docx</code><span class="sig-paren">(</span><em>no_of_docs=5</em>, <em>unicode_data=False</em>, <em>pdf=False</em>, <em>google_docs=False</em>, <em>ca_type='gdrive'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/wiki.html#Wiki.create_docx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.wiki.Wiki.create_docx" title="Permalink to this definition">¶</a></dt>
<dd><p>This method creates a new docx document and saves it into the directory
defined in constants file.</p>
<blockquote>
<div><p>Args:</p>
<blockquote>
<div><p>no_of_docs (int)  –  Number of docx documents to create</p>
<p>unicode_data (boolean)  –  True if unicode document has to be created</p>
<blockquote>
<div>Default: False</div></blockquote>
<p>pdf  (boolean)  –  True if pdf files need to be created</p>
<p>google_docs  (boolean)  –  True if google docs files need to be created</p>
<dl class="docutils">
<dt>ca_type  (str)  –  Cloud Apps instance type</dt>
<dd><p class="first">Valid Values:
gmail</p>
<p>gdrive</p>
<p class="last">onedrive</p>
</dd>
</dl>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.wiki.Wiki.create_message_from_wiki">
<code class="descname">create_message_from_wiki</code><span class="sig-paren">(</span><em>unicode_data=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/wiki.html#Wiki.create_message_from_wiki"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.wiki.Wiki.create_message_from_wiki" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetches page title and content of a random page from wikipedia</p>
<p>Args:</p>
<blockquote>
<div><p>unicode_data (boolean)  –  True if unicode data has to be fetched</p>
<blockquote>
<div>Default: False</div></blockquote>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>Dict of following type: {‘subject’: &lt;some subject&gt;, ‘body’: &lt;page content&gt;}</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.wiki.Wiki.make_request">
<code class="descname">make_request</code><span class="sig-paren">(</span><em>req_type='GET'</em>, <em>req_url=None</em>, <em>req_body=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/wiki.html#Wiki.make_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.wiki.Wiki.make_request" title="Permalink to this definition">¶</a></dt>
<dd><p>This method make a request to API endpoint.</p>
<p>Args:</p>
<blockquote>
<div><p>req_type (str) – Type of HTTP request</p>
<blockquote>
<div><dl class="docutils">
<dt>Allowed values:</dt>
<dd>GET
POST</dd>
</dl>
</div></blockquote>
<p>req_url (str)  –  URL to make request to</p>
<p>req_body (dict) – URL parameters or POST data</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>responce (json)</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="Automation.Application.CloudApps.wiki.Wiki.make_valid_filename">
<code class="descname">make_valid_filename</code><span class="sig-paren">(</span><em>file_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Automation/Application/CloudApps/wiki.html#Wiki.make_valid_filename"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Automation.Application.CloudApps.wiki.Wiki.make_valid_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>This method returns the valid file name for Windows OS
after removing invalid characters.</p>
<blockquote>
<div><p>Args:</p>
<blockquote>
<div>file_name  (str)  –  Name of the file</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>file_name  (str)  –  Returns a valid filename</div></blockquote>
</div></blockquote>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-Automation.Application.CloudApps">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-Automation.Application.CloudApps" title="Permalink to this headline">¶</a></h2>
<p>Initializes the Utils, and Test Cases for the Cloud Apps agent.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Automation.Application.CloudApps package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-Automation.Application.CloudApps.auth">Automation.Application.CloudApps.auth module</a><ul>
<li><a class="reference internal" href="#attributes">Attributes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-Automation.Application.CloudApps.cloud_apps">Automation.Application.CloudApps.cloud_apps module</a><ul>
<li><a class="reference internal" href="#id1">Attributes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-Automation.Application.CloudApps.cloud_connector">Automation.Application.CloudApps.cloud_connector module</a><ul>
<li><a class="reference internal" href="#id2">Attributes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-Automation.Application.CloudApps.constants">Automation.Application.CloudApps.constants module</a></li>
<li><a class="reference internal" href="#module-Automation.Application.CloudApps.db">Automation.Application.CloudApps.db module</a></li>
<li><a class="reference internal" href="#module-Automation.Application.CloudApps.exception">Automation.Application.CloudApps.exception module</a></li>
<li><a class="reference internal" href="#module-Automation.Application.CloudApps.google">Automation.Application.CloudApps.google module</a><ul>
<li><a class="reference internal" href="#id3">Attributes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-Automation.Application.CloudApps.one_drive">Automation.Application.CloudApps.one_drive module</a></li>
<li><a class="reference internal" href="#module-Automation.Application.CloudApps.operations">Automation.Application.CloudApps.operations module</a></li>
<li><a class="reference internal" href="#module-Automation.Application.CloudApps.wiki">Automation.Application.CloudApps.wiki module</a></li>
<li><a class="reference internal" href="#module-Automation.Application.CloudApps">Module contents</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">Automation</a><ul>
  <li><a href="Automation.html">Automation namespace</a><ul>
  <li><a href="Automation.Application.html">Automation.Application package</a><ul>
      <li>Previous: <a href="Automation.Application.AD.html" title="previous chapter">Automation.Application.AD package</a></li>
      <li>Next: <a href="Automation.Application.CloudStorage.html" title="next chapter">Automation.Application.CloudStorage namespace</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Automation.Application.CloudApps.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Commvault Systems Inc..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
      |
      <a href="_sources/Automation.Application.CloudApps.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>