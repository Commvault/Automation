
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Automation.AutomationUtils.windows_machine &#8212; Commvault Automation 11.14 documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for Automation.AutomationUtils.windows_machine</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># pylint: disable=W0221,W0108</span>

<span class="c1"># --------------------------------------------------------------------------</span>
<span class="c1"># Copyright Commvault Systems, Inc.</span>
<span class="c1"># See LICENSE.txt in the project root for</span>
<span class="c1"># license information.</span>
<span class="c1"># --------------------------------------------------------------------------</span>

<span class="sd">&quot;&quot;&quot;File for performing operations on a machine / computer with Windows Operating System.</span>

<span class="sd">This file consists of a class named: Machine, which can connect to the remote machine,</span>
<span class="sd">using CVD, if it is a Commvault Client, or using PowerShell, otherwise.</span>

<span class="sd">The instance of this class can be used to perform various operations on a machine, like,</span>

<span class="sd">    #.  Check if a Directory Exists or not</span>
<span class="sd">    #.  Create a new Directory</span>
<span class="sd">    #.  Rename a File / Folder</span>
<span class="sd">    #.  Remove an existing Directory</span>
<span class="sd">    #.  Get the Size of a File / Folder</span>
<span class="sd">    #.  Check if a Registry exists or not</span>
<span class="sd">    #.  Add / Update a Registry Key / Value</span>
<span class="sd">    #.  Get the Value of a Registry Key</span>
<span class="sd">    #.  Delete a Registry Key / Value</span>
<span class="sd">    #.  Compare the contents of 2 Files / Folders</span>


<span class="sd">WindowsMachine</span>
<span class="sd">==============</span>

<span class="sd">    __init__()                      --  initialize object of the class</span>

<span class="sd">    _login_with_credentials()       --  creates PowerShell credentials object and stores in an XML</span>

<span class="sd">    _execute_with_credential()      --  execute a script on a remote client using its credentials</span>

<span class="sd">    _execute_with_cvd()             --  execute a script on a remote client using the CVD service</span>

<span class="sd">    _get_file_hash()                --  returns the hash value of specified file</span>

<span class="sd">    _get_folder_hash()              --  returns the set of file paths and hash values</span>

<span class="sd">    _execute_script()               --  executes a PowerShell script on the remote machine</span>

<span class="sd">    _read_local_file()              --  reads and returns the content of the file</span>

<span class="sd">    _copy_file_from_local()         --  copy the file from local machine to the remote machine</span>

<span class="sd">    _get_files_or_folders_in_path() --  returns the list of files / folders present at the given</span>
<span class="sd">    path based on the operation type given</span>

<span class="sd">    _get_client_ip()                -- gets the ip address of the machine</span>

<span class="sd">    reboot_client()                 --  Reboots the remote machine</span>

<span class="sd">    kill_process()                  --  Kills a process in the remote machine</span>

<span class="sd">    execute_command()               --  executes a PowerShell command on the remote machine</span>

<span class="sd">    check_directory_exists()        --  checks if a directory exists on a remote client or not</span>

<span class="sd">    is_directory()        			--  Checks if the path is a directory or not</span>

<span class="sd">    check_file_exists()             --  checks if a file exists on a remote client or not</span>

<span class="sd">    create_directory()              --  creates a new directory on a remote client</span>

<span class="sd">    rename_file_or_folder()         --  renames a file / folder on a remote client</span>

<span class="sd">    remove_directory()              --  removes a directory on a remote client</span>

<span class="sd">    get_file_size()                 --  get the size of a file on a remote client</span>

<span class="sd">    get_folder_size()               --  get the size of a folder on a remote client</span>

<span class="sd">    get_storage_details()           --  gets the details of storage of the client</span>

<span class="sd">    get_disk_count()                --  returns the count of the disks on the machine</span>

<span class="sd">    check_registry_exists()         --  check if a registry exists on a remote client or not</span>

<span class="sd">    get_registry_value()            --  get the value of a registry key from a remote client</span>

<span class="sd">    get_registry_entries_for_subkey ()      --  Retrieves all the registry entries under a given</span>
<span class="sd">    subkey value and/or find a particular subkey or entry.</span>

<span class="sd">    create_registry()               --  create a registry key / value on a remote client</span>

<span class="sd">    update_registry()               --  update the data of a registry value on a remote client</span>

<span class="sd">    remove_registry()               --  remove a registry key / value from a remote client</span>

<span class="sd">    mount_network_path()            --  mounts the network shared path to a drive on this machine</span>

<span class="sd">    copy_folder_to_network_share()  --  copies the folder from this machine to the network share</span>

<span class="sd">    copy_from_network_share()       --  copies the file/folder specified at network share</span>
<span class="sd">    to the local machine</span>

<span class="sd">    copy_folder()                   --  copies the files specified at a location to</span>
<span class="sd">    another location on same local machine</span>

<span class="sd">    unmount_drive()                 --  un mounts the drive connected to this machine</span>

<span class="sd">    create_file()                   --  creates a file at the specified path on the remote client</span>

<span class="sd">    execute_exe()                   --  executes the exe at the given path on the machine</span>

<span class="sd">    copy_from_local()               --  copies the file / folder specified in the input from</span>
<span class="sd">    local machine to the remote machine</span>

<span class="sd">    get_acl_list()                 --  Gets the list of acl of items</span>
<span class="sd">                                       from the machine on a give path</span>

<span class="sd">    compare_acl()                  -- Compares the acl of source path with</span>
<span class="sd">                                      destination path and checks</span>
<span class="sd">                                      whether they are same</span>

<span class="sd">    get_file_attributes()           -- get file attributes</span>

<span class="sd">    is_stub()                        -- for onepass use, to verify it&#39;s tub</span>

<span class="sd">    read_file()                     --  returns the contents of the file present at the given path</span>

<span class="sd">    delete_file()                   --  deletes the file present at the given path</span>

<span class="sd">    change_folder_owner()           --  changes the ownership of the given directory</span>

<span class="sd">    create_current_timestamp_folder()   --  create a folder with the current timestamp as the</span>
<span class="sd">    folder name inside the given folder path</span>

<span class="sd">    get_latest_timestamp_file_or_folder()   --  get the recently created file / folder inside the</span>
<span class="sd">    given folder path</span>

<span class="sd">    generate_test_data()            --  generates test data at specified path on remote client</span>

<span class="sd">    modify_test_data()              --  modify the test data at the given path based on the given</span>
<span class="sd">    options</span>

<span class="sd">    get_test_data_info()            --  returns information about the items on the given path</span>
<span class="sd">    based on the given options</span>

<span class="sd">    get_items_list()                --  returns the list of items at the given path</span>

<span class="sd">    get_meta_list()                 --  returns the list of meta data of items from the machine</span>
<span class="sd">    on the given path</span>

<span class="sd">    compare_meta_data()             --  compare the meta data of 2 paths</span>

<span class="sd">    get_checksum_list()             --  returns the list of checksum of the files at the given path</span>

<span class="sd">    compare_checksum()              --  compares the checksum of 2 paths</span>

<span class="sd">    get_files_in_path()             --  returns the list of files present at the given path</span>

<span class="sd">    get_folders_in_path()           --  returns the list of folders present at the given path</span>

<span class="sd">    get_folder_or_file_names()      --  returns the list of files or folders in a given path</span>

<span class="sd">    get_files_and_directory_path()  --  returns the list of files and its directory in a given path</span>

<span class="sd">    add_firewall_allow_port_rule()  --  adds the inbound rule for the given port number</span>

<span class="sd">    start_firewall()                --  turn on firewall services on the current client machine</span>

<span class="sd">    add_firewall_machine_exclusion()        --  adds given machine to firewall exclusion list</span>

<span class="sd">    remove_firewall_allow_port_rule()       --  removes the inbound rule for the given port number</span>

<span class="sd">    stop_firewall()                         --  turn off firewall service on the client machine</span>

<span class="sd">    remove_firewall_machine_exclusion()     --  removes given machine from firewall exclusion list</span>

<span class="sd">    disconnect()                            --  disconnects the session with the machine</span>

<span class="sd">    scan_directory()                --  Scans the directory and returns a list of items under it</span>
<span class="sd">    along with its properties</span>

<span class="sd">Attributes</span>
<span class="sd">----------</span>

<span class="sd">    **is_connected**        --  returns boolean specifying whether connection is alive or not</span>

<span class="sd">    **key**                 --  returns the base path of the Registry Key of Commvault Instance</span>

<span class="sd">    **instance**            --  returns the Commvault instance registry currently being interacted</span>
<span class="sd">    with</span>

<span class="sd">    **instance.setter**     --  set the value of the Commvault instance to interact with</span>

<span class="sd">    **tmp_dir**             --  returns the path of the **tmp** directory on the Machine where the</span>
<span class="sd">    temporary database files are stored</span>

<span class="sd">    **os_sep**              --  returns the path separator based on the OS of the Machine</span>

<span class="sd">    **ip_address**          --  returns IP address of the machine</span>


<span class="sd"># TODO: check with Sunil Bandari, and remove implementation for get_folder_or_file_names() method</span>

<span class="sd"># TODO: implement argument to get_files_in_path and get_folders_in_path methods to get files</span>
<span class="sd">directly under the given path / recursively.</span>


<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="kn">import</span> <span class="nn">datetime</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">logger</span>


<span class="kn">from</span> <span class="nn">.constants</span> <span class="k">import</span> <span class="p">(</span>
    <span class="n">ALGORITHM_LIST</span><span class="p">,</span>
    <span class="n">COPY_FOLDER</span><span class="p">,</span>
    <span class="n">CREATE_DIRECTORY</span><span class="p">,</span>
    <span class="n">CREATE_FILE</span><span class="p">,</span>
    <span class="n">CREATE_FILE_WITHSIZE</span><span class="p">,</span>
    <span class="n">CREDENTIALS</span><span class="p">,</span>
    <span class="n">DELETE_REGISTRY</span><span class="p">,</span>
    <span class="n">DIRECTORY_EXISTS</span><span class="p">,</span>
    <span class="n">EXECUTE_COMMAND</span><span class="p">,</span>
    <span class="n">EXECUTE_EXE</span><span class="p">,</span>
    <span class="n">FILE_OR_FOLDER_LIST</span><span class="p">,</span>
    <span class="n">GET_HASH</span><span class="p">,</span>
    <span class="n">GET_REG_VALUE</span><span class="p">,</span>
    <span class="n">GET_SIZE</span><span class="p">,</span>
    <span class="n">GET_FILE_ATTRIBUTES</span><span class="p">,</span>
    <span class="n">LATEST_FILE_OR_FOLDER</span><span class="p">,</span>
    <span class="n">MOUNT_NETWORK_PATH</span><span class="p">,</span>
    <span class="n">REGISTRY_EXISTS</span><span class="p">,</span>
    <span class="n">REMOVE_DIRECTORY</span><span class="p">,</span>
    <span class="n">RENAME_ITEM</span><span class="p">,</span>
    <span class="n">SET_REG_VALUE</span><span class="p">,</span>
    <span class="n">UNMOUNT_NETWORK_PATH</span><span class="p">,</span>
    <span class="n">SCAN_DIRECTORY</span><span class="p">,</span>
    <span class="n">WINDOWS_ADD_DATA</span><span class="p">,</span>
    <span class="n">WINDOWS_GENERATE_TEST_DATA_THREAD_COUNT</span><span class="p">,</span>
    <span class="n">WINDOWS_GET_ASCII_VALUE_FOR_PATH</span><span class="p">,</span>
    <span class="n">WINDOWS_GET_DATA</span><span class="p">,</span>
    <span class="n">WINDOWS_MODIFY_DATA</span><span class="p">,</span>
    <span class="n">WINDOWS_TMP_DIR</span><span class="p">,</span>
    <span class="n">WINDOWS_DELIMITER</span><span class="p">,</span>
    <span class="n">WINDOWS_GET_REGISTRY_ENTRY_FOR_SUBKEY</span><span class="p">,</span>
    <span class="n">WINDOWS_PROBLEM_DATA</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">.machine</span> <span class="k">import</span> <span class="n">Machine</span>
<span class="kn">from</span> <span class="nn">.output_formatter</span> <span class="k">import</span> <span class="n">WindowsOutput</span>
<span class="kn">from</span> <span class="nn">.script_generator</span> <span class="k">import</span> <span class="n">ScriptGenerator</span>
<span class="kn">import</span> <span class="nn">datetime</span>


<div class="viewcode-block" id="WindowsMachine"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine">[docs]</a><span class="k">class</span> <span class="nc">WindowsMachine</span><span class="p">(</span><span class="n">Machine</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for performing operations on a Windows OS remote client.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">machine_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">commcell_object</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initializes instance of the Machine class.</span>

<span class="sd">        Args:</span>
<span class="sd">            machine_name        (str)       --  name / ip address of the client to connect to</span>

<span class="sd">                if machine name is not provided, then the Machine object for the local machine</span>
<span class="sd">                will be created</span>

<span class="sd">                default:    None</span>

<span class="sd">            commcell_object     (object)    --  instance of the Commcell class from CVPySDK</span>

<span class="sd">                default:    None</span>

<span class="sd">            username            (str)       --  username for the client to connect to</span>

<span class="sd">                    Only Applicable if the client is not a Commvault Client</span>

<span class="sd">                default:    None</span>

<span class="sd">            password            (str)       --  password for the above specified user</span>

<span class="sd">                default:    None</span>

<span class="sd">        Also, initializes the Client object, if it is Commvault Client.</span>

<span class="sd">        Otherwise, it creates a PowerShell credentials object for the client.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">WindowsMachine</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">machine_name</span><span class="p">,</span> <span class="n">commcell_object</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_commvault_client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span> <span class="o">=</span> <span class="n">ScriptGenerator</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_execution_policy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_object</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span>
                <span class="s1">&#39;powershell.exe Get-ExecutionPolicy&#39;</span>
            <span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

            <span class="c1"># Ensure the PowerShell execution policy is set to Remote Signed</span>
            <span class="n">__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_object</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span>
                <span class="s1">&#39;powershell.exe Set-ExecutionPolicy RemoteSigned -Force&#39;</span>
            <span class="p">)</span>

            <span class="c1"># check if CVD is able to execute the operation</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_storage_details</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_object</span><span class="o">.</span><span class="n">instance</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_local_machine</span><span class="p">:</span>
                <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                    <span class="s1">&#39;powershell.exe Get-ExecutionPolicy&#39;</span><span class="p">,</span>
                    <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                    <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_execution_policy</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>

                <span class="c1"># Ensure the PowerShell execution policy is set to Remote Signed</span>
                <span class="n">__</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                    <span class="s1">&#39;powershell.exe Set-ExecutionPolicy RemoteSigned -Force&#39;</span><span class="p">,</span>
                    <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span> <span class="o">=</span> <span class="n">ScriptGenerator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">machine_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials_file</span><span class="p">)</span>

            <span class="c1"># check if the credentials given are correct or not</span>
            <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="s1">&#39;Get-PSDrive&#39;</span><span class="p">)</span>
            <span class="n">exception</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">output</span>

            <span class="k">if</span> <span class="s1">&#39;access is denied&#39;</span> <span class="ow">in</span> <span class="n">exception</span><span class="p">:</span>
                <span class="c1"># if the operation raised exception, call disconnect, and raise</span>
                <span class="c1"># Exception</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Authentication Failed. Invalid credentials provided.&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s1">&#39;client cannot connect to the destination&#39;</span> <span class="ow">in</span> <span class="n">exception</span><span class="p">:</span>
                <span class="c1"># if the operation raised exception, call disconnect, and raise</span>
                <span class="c1"># Exception</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s1">&#39;Failed to connect to the Machine. Please ensure the services are running&#39;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">exception</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_instance</span> <span class="o">=</span> <span class="s1">&#39;Instance001&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_key</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;HKLM:\SOFTWARE\CommVault Systems\Galaxy\</span><span class="si">{0}</span><span class="s1">\</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_os_info</span> <span class="o">=</span> <span class="s2">&quot;WINDOWS&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span> <span class="o">=</span> <span class="n">logger</span><span class="o">.</span><span class="n">get_log</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_login_with_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generates the Credentials File for the machine,</span>
<span class="sd">            to use for performing operations on the remote client.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if an error was returned on the error stream</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Replace any white space ( ) in the PowerShell file path with &#39; &#39;</span>
        <span class="c1"># e.g.; Original Script path:</span>
        <span class="c1"># C:\\Program Files\\Commvault\\ContentStore</span>
        <span class="c1">#   \\Automation\\AutomationUtils\\Scripts\\Windows\\Creds.ps1</span>
        <span class="c1"># Corrected Path:</span>
        <span class="c1"># C:\\Program Files\\Commvault\\ContentStore</span>
        <span class="c1">#   \\Automation\\AutomationUtils\\Scripts\\Windows\\Creds.ps1</span>
        <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="s1">&#39;powershell.exe&#39;</span><span class="p">,</span>
                <span class="n">CREDENTIALS</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&#39; &#39;&quot;</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">machine_name</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">password</span>
            <span class="p">],</span>
            <span class="c1"># HACK:the code gets hung at the process.communicate() call, if stdin is not included</span>
            <span class="c1"># this issue is yet to be looked into on why this happens</span>
            <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
            <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
            <span class="n">shell</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="n">output</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">error</span><span class="o">.</span><span class="n">decode</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s1">&#39;Failed to create credentials object.</span><span class="se">\n</span><span class="s1">Error: &quot;</span><span class="si">{0}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">error</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">credentials_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_execute_with_credential</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">script</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Execute the script remotely on a client using the credentials provided,</span>
<span class="sd">            if the client is not a Commvault client.</span>

<span class="sd">            Args:</span>
<span class="sd">                script  (str)   --  path of the script file to execute on the client remotely</span>

<span class="sd">            Returns:</span>
<span class="sd">                object  -   instance of WindowsOutput class</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Replace any white space ( ) in the PowerShell file path with &#39; &#39;</span>
        <span class="c1"># e.g.; Original Script path:</span>
        <span class="c1"># C:\\Program Files\\Commvault\\ContentStore</span>
        <span class="c1">#   \\Automation\\AutomationUtils\\Scripts\\Windows\\GetSize.ps1</span>
        <span class="c1"># Corrected Path:</span>
        <span class="c1"># C:\\Program Files\\Commvault\\ContentStore</span>
        <span class="c1">#   \\Automation\\AutomationUtils\\Scripts\\Windows\\GetSize.ps1</span>
        <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="s1">&#39;powershell.exe&#39;</span><span class="p">,</span>
                <span class="n">script</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&#39; &#39;&quot;</span><span class="p">)</span>
            <span class="p">],</span>
            <span class="c1"># HACK:the code gets hung at the process.communicate() call, if stdin is not included</span>
            <span class="c1"># this issue is yet to be looked into on why this happens</span>
            <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
            <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
            <span class="n">shell</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="n">output</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">WindowsOutput</span><span class="p">(</span><span class="n">process</span><span class="o">.</span><span class="n">returncode</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">decode</span><span class="p">(),</span> <span class="n">error</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_execute_with_cvd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">script</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Execute the script remotely on a client using the CVD service running on the client.</span>
<span class="sd">            Only applicable if the client is a Commvault Client.</span>

<span class="sd">            Args:</span>
<span class="sd">                script  (str)   --  path of the script file to execute on the client remotely</span>

<span class="sd">            Returns:</span>
<span class="sd">                object  -   instance of WindowsOutput class</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">script</span><span class="p">):</span>
            <span class="n">exit_code</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">error_message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_object</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span>
                <span class="s1">&#39;PowerShell&#39;</span><span class="p">,</span> <span class="n">script</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">exit_code</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">error_message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_object</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="n">script</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">WindowsOutput</span><span class="p">(</span><span class="n">exit_code</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">error_message</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_file_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;MD5&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns MD5 hash value of the specified file at the given file path.</span>

<span class="sd">          Args:</span>
<span class="sd">              file_path       (str)             --  Path of the file to get the hash value of.</span>

<span class="sd">              algorithm       (str)             --  Specifies the cryptographic hash function for</span>
<span class="sd">                                                    computing the hash value of the contents.</span>

<span class="sd">                Default: &quot;MD5&quot;.</span>

<span class="sd">              The acceptable values for algorithm parameter are:</span>
<span class="sd">                 * SHA1</span>
<span class="sd">                 * SHA256</span>
<span class="sd">                 * SHA384</span>
<span class="sd">                 * SHA512</span>
<span class="sd">                 * MD5</span>


<span class="sd">          Returns:</span>
<span class="sd">              str     -   hash value of the given file.</span>

<span class="sd">          Raises:</span>
<span class="sd">              Exception: If file path doesn&#39;t exist.</span>

<span class="sd">                  If the algorithm entered is invalid.</span>

<span class="sd">                  If failed to get the hash value.</span>

<span class="sd">          &quot;&quot;&quot;</span>
        <span class="c1"># checks whether the given directory exists</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_file_exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> file does not exist on </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">file_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine_name</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># checks with the list of supported algorithms</span>
        <span class="k">if</span> <span class="n">algorithm</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ALGORITHM_LIST</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;Algorithm not found under the list </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">ALGORITHM_LIST</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># substitutes the variables into the script and runs it.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">GET_HASH</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">file_path</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;File&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ignore&#39;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;ignore_case&#39;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;algorithm&#39;</span><span class="p">:</span> <span class="n">algorithm</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">hash_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">hash_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">hash_script</span><span class="p">)</span>

        <span class="c1"># raises Exception</span>
        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">formatted_output</span>

    <span class="k">def</span> <span class="nf">_get_folder_hash</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">directory_path</span><span class="p">,</span>
            <span class="n">ignore_folder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">ignore_case</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;MD5&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns set of files and their MD5 hash values present on the input path.</span>

<span class="sd">          Args:</span>
<span class="sd">              directory_path      (str)   --  path of the directory to get hash values of.</span>

<span class="sd">              ignore_folder       (list)  --  list of folders to be ignored.</span>
<span class="sd">                Default: None.</span>

<span class="sd">              ignore_case         (bool)  --  ignores the case if set to True.</span>
<span class="sd">                Default: False.</span>

<span class="sd">              algorithm           (str)   --  Specifies the cryptographic hash function</span>
<span class="sd">                    to use for computing the hash value of the contents.</span>

<span class="sd">                Default: &quot;MD5&quot;</span>

<span class="sd">              The acceptable values for algorithm parameter are:</span>
<span class="sd">                 * SHA1</span>
<span class="sd">                 * SHA256</span>
<span class="sd">                 * SHA384</span>
<span class="sd">                 * SHA512</span>
<span class="sd">                 * MD5</span>


<span class="sd">          Returns:</span>
<span class="sd">              set     -   set consisting of the file paths and their hash value as tuple</span>

<span class="sd">                  set(</span>
<span class="sd">                      (file_path1, hash1),</span>

<span class="sd">                      (file_path2, hash2)</span>

<span class="sd">                  )</span>

<span class="sd">          Raises:</span>
<span class="sd">              Exception: If specified folder doesn&#39;t exist.</span>

<span class="sd">                  If the algorithm entered is invalid.</span>

<span class="sd">                  If failed to get the hash values.</span>

<span class="sd">          &quot;&quot;&quot;</span>

        <span class="c1"># checks whether the given directory exists</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_directory_exists</span><span class="p">(</span><span class="n">directory_path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> path does not exist on </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">directory_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine_name</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># checks with the list of supported algorithms</span>
        <span class="k">if</span> <span class="n">algorithm</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ALGORITHM_LIST</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;Algorithm not found under the list </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">ALGORITHM_LIST</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># converting list to a single string with delimiters in between</span>
        <span class="k">if</span> <span class="n">ignore_folder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ignore_folder</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ignore_string</span> <span class="o">=</span> <span class="n">WINDOWS_DELIMITER</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ignore_folder</span><span class="p">)</span>
        <span class="n">ignore_string</span> <span class="o">=</span> <span class="n">ignore_string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="p">,</span> <span class="s2">&quot;`$&quot;</span><span class="p">)</span>

        <span class="c1"># substitutes the variables into the script and runs it.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">GET_HASH</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">directory_path</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;Folder&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ignore&#39;</span><span class="p">:</span> <span class="n">ignore_string</span><span class="p">,</span>
            <span class="s1">&#39;ignore_case&#39;</span><span class="p">:</span> <span class="n">ignore_case</span><span class="p">,</span>
            <span class="s1">&#39;algorithm&#39;</span><span class="p">:</span> <span class="n">algorithm</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">hash_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">hash_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">hash_script</span><span class="p">)</span>

        <span class="c1"># raises Exception</span>
        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="c1"># parses the output generated from executing the script</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">get_columns</span><span class="p">([</span><span class="s1">&#39;Path&#39;</span><span class="p">,</span> <span class="s1">&#39;Hash&#39;</span><span class="p">])</span>

        <span class="n">directory_path</span> <span class="o">=</span> <span class="n">directory_path</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">hash_values</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="c1"># populates the set</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">hash_values</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">directory_path</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">hash_values</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_read_local_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads the contents of the file present on the local machine.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path   (str)   --  path of the file to get the contents of</span>

<span class="sd">        Returns:</span>
<span class="sd">            str     -   contents of the file</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if the file is not valid given at the path</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Not a valid file at the given path&#39;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_object</span><span class="p">:</span>
            <span class="n">contents</span> <span class="o">=</span> <span class="n">file_object</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">contents</span>

    <span class="k">def</span> <span class="nf">_copy_file_from_local</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">local_path</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copies the file present at the given path to the path specified on the remote machine.</span>

<span class="sd">        Args:</span>
<span class="sd">            local_path      (str)   --  path of the file on the local machine</span>

<span class="sd">            remote_path     (str)   --  path of the directory to which the file should be</span>
<span class="sd">            copied on the remote machine</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to copy the file</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">local_path</span><span class="p">):</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">local_path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Input path is not a valid file&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_commvault_client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client_object</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_directory_exists</span><span class="p">(</span><span class="n">remote_path</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">create_directory</span><span class="p">(</span><span class="n">remote_path</span><span class="p">)</span>

            <span class="n">local_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;</span><span class="se">\\</span><span class="si">{0}</span><span class="s1">\</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">socket</span><span class="o">.</span><span class="n">gethostbyname</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">()),</span>
                <span class="n">local_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;$&#39;</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="n">remote_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;</span><span class="se">\\</span><span class="si">{0}</span><span class="s1">\</span><span class="si">{1}</span><span class="s1">\</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">machine_name</span><span class="p">,</span>
                <span class="n">remote_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;$&#39;</span><span class="p">),</span>
                <span class="n">file_name</span>
            <span class="p">)</span>

            <span class="c1"># set the value of ComputerName to `null`, so the PS script is</span>
            <span class="c1"># executed locally, if the machine is not a local machine</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_local_machine</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">machine_name</span> <span class="o">=</span> <span class="s1">&#39;$null&#39;</span>

            <span class="c1"># mount the network path, to establish the connection b/w the 2 machines</span>
            <span class="c1"># the local machine, and the remote machine, so the file can be copied</span>
            <span class="c1"># using the network paths</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">drive</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mount_network_path</span><span class="p">(</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">remote_path</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">password</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="c1"># Continue silently, if failed to mount the drive</span>
                <span class="k">pass</span>

            <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="s2">&quot;Copy-Item &#39;</span><span class="si">{0}</span><span class="s2">&#39; &#39;</span><span class="si">{1}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">))</span>

            <span class="c1"># unmount the network path, to remove stale connections</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unmount_drive</span><span class="p">(</span><span class="n">drive</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="c1"># Continue silently, if failed to unmount the drive</span>
                <span class="k">pass</span>

            <span class="c1"># reset the value of ComputerName back to the machine name, after the PS script has</span>
            <span class="c1"># been executed successfully, only if the machine is not a local machine</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_local_machine</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">machine_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine_name</span>

            <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span>
                                <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_get_files_or_folders_in_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">,</span> <span class="n">operation_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list of all the files / folders at the given folder path.</span>

<span class="sd">        Args:</span>
<span class="sd">            folder_path     (str)   --  full path of the folder to get the</span>
<span class="sd">            list of files / folders from</span>

<span class="sd">            operation_type  (str)   --  type of the operation, i.e., whether to get the files</span>
<span class="sd">            or the folders from the given folder path</span>

<span class="sd">                Valid values are</span>

<span class="sd">                -   FILE</span>

<span class="sd">                -   FOLDER</span>

<span class="sd">        Returns:</span>
<span class="sd">            list    -   list of the files / folders present at the given path</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if path is not valid</span>

<span class="sd">                if failed to get the list of files / folders</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_directory_exists</span><span class="p">(</span><span class="n">folder_path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Please give a valid path&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">FILE_OR_FOLDER_LIST</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;folder_path&#39;</span><span class="p">:</span> <span class="n">folder_path</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">operation_type</span>
        <span class="p">}</span>

        <span class="n">script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">script</span><span class="p">)</span>

        <span class="c1"># lambda function is required, as each element of formatted output is a list</span>
        <span class="c1"># whereas the output should only be a list with each value being a string</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">output</span><span class="o">.</span><span class="n">formatted_output</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_get_client_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the ip_address of the machine&quot;&quot;&quot;</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;hostname&quot;</span>
        <span class="n">cmd_output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="n">hostname</span> <span class="o">=</span> <span class="n">cmd_output</span><span class="o">.</span><span class="n">formatted_output</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;Test-Connection -ComputerName </span><span class="si">{0}</span><span class="s2"> -Count 1 | Select-Object IPV4Address&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hostname</span><span class="p">)</span>
        <span class="n">cmd_output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ip_address</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cmd_output</span><span class="o">.</span><span class="n">formatted_output</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns boolean specifying whether the connection to the machine is open or closed.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_object</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_is_connected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_object</span><span class="o">.</span><span class="n">is_ready</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">credentials_file</span><span class="p">:</span>
                <span class="c1"># check if the connection is alive or not</span>
                <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="s1">&#39;Get-PSDrive&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;client cannot connect to the destination&#39;</span> <span class="ow">in</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">or</span>
                        <span class="s1">&#39;access is denied&#39;</span> <span class="ow">in</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_is_connected</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_is_connected</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="k">del</span> <span class="n">output</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_local_machine</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_is_connected</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_is_connected</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_connected</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_connected</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the value of key attribute.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">instance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the value of instance attribute.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instance</span>

    <span class="nd">@instance</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the value of instance attribute.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;Instance&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_instance</span> <span class="o">=</span> <span class="n">instance</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_instance</span> <span class="o">=</span> <span class="s1">&#39;Instance</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_key</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;HKLM:\SOFTWARE\CommVault Systems\Galaxy\</span><span class="si">{0}</span><span class="s1">\</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tmp_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the path of the **tmp** directory on the Windows Machine, where temporary</span>
<span class="sd">            database files are stored.</span>

<span class="sd">            default value:  C:\\\\tmp</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># create directory should always be called, to ensure that the directory exists,</span>
        <span class="c1"># and ADD it if it does not exists on the machine</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_directory</span><span class="p">(</span><span class="n">WINDOWS_TMP_DIR</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">WINDOWS_TMP_DIR</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">os_sep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the path separator based on the OS of the Machine.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span>

<div class="viewcode-block" id="WindowsMachine.reboot_client"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.reboot_client">[docs]</a>    <span class="k">def</span> <span class="nf">reboot_client</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reboots the machine.</span>

<span class="sd">            Please **NOTE** that the connectivity will go down in this scenario, and the Machine</span>
<span class="sd">            class may not be able to re-establish the connection to the Machine.</span>

<span class="sd">            In such cases, the user will have to initialize the Machine class instance again.</span>

<span class="sd">            Args:</span>
<span class="sd">                None</span>

<span class="sd">            Returns:</span>
<span class="sd">                object  -   instance of the WindowsOutput class</span>

<span class="sd">            Raises:</span>
<span class="sd">                Exception:</span>
<span class="sd">                    if failed to reboot the machine</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="s1">&#39;Restart-Computer -Force&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span></div>

<div class="viewcode-block" id="WindowsMachine.kill_process"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.kill_process">[docs]</a>    <span class="k">def</span> <span class="nf">kill_process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">process_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">process_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Terminates a running process on the client machine with either the given</span>
<span class="sd">            process name or the process id.</span>

<span class="sd">        Args:</span>
<span class="sd">            process_name    (str)   --  name of the process to be terminate</span>

<span class="sd">            process_id      (str)   --  ID of the process ID to be terminated</span>

<span class="sd">        Returns:</span>
<span class="sd">            object  -   instance of WindowsOutput class</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if neither the process name nor the process id is given</span>

<span class="sd">                if failed to kill the process</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">if</span> <span class="n">process_name</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;Stop-Process -Name </span><span class="si">{process_name}</span><span class="s2"> -Force&quot;</span>
        <span class="k">elif</span> <span class="n">process_id</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;Stop-Process -Id </span><span class="si">{process_id}</span><span class="s2"> -Force&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Please provide either the process Name or the process ID&#39;</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span></div>

<div class="viewcode-block" id="WindowsMachine.execute_command"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.execute_command">[docs]</a>    <span class="k">def</span> <span class="nf">execute_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Executes a PowerShell command on the machine.</span>

<span class="sd">            An instance of the **WindowsOutput** class is returned.</span>

<span class="sd">            Output / Exception messages received from command execution are</span>
<span class="sd">            available as the attributes of the class instance.</span>

<span class="sd">                output_instance.output              --  raw output returned from the command</span>

<span class="sd">                output_instance.formatted_output    --  o/p received after parsing the raw output</span>

<span class="sd">                output_instance.exception           --  raw exception message</span>

<span class="sd">                output_instance.exception_message   --  parsed exception message from the raw o/p</span>


<span class="sd">        Args:</span>
<span class="sd">            command     (str)   --  PowerShell command to be executed on the machine</span>

<span class="sd">        Returns:</span>
<span class="sd">            object  -   instance of WindowsOutput class</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">EXECUTE_COMMAND</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;command&#39;</span><span class="p">:</span> <span class="n">command</span>
        <span class="p">}</span>
        <span class="n">execute_command_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">execute_command_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">execute_command_script</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span></div>

    <span class="c1"># OS related functions</span>
<div class="viewcode-block" id="WindowsMachine.check_directory_exists"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.check_directory_exists">[docs]</a>    <span class="k">def</span> <span class="nf">check_directory_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if a directory exists on the client or not.</span>

<span class="sd">        Args:</span>
<span class="sd">            directory_path  (str)   --  path of the directory to check</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool    -   boolean value whether the directory exists or not</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">DIRECTORY_EXISTS</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;directory_name&#39;</span><span class="p">:</span> <span class="n">directory_path</span>
        <span class="p">}</span>
        <span class="n">directory_exists_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">directory_exists_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">directory_exists_script</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">formatted_output</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;true&#39;</span></div>

<div class="viewcode-block" id="WindowsMachine.check_file_exists"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.check_file_exists">[docs]</a>    <span class="k">def</span> <span class="nf">check_file_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if a file exists on the client or not.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path  (str)   --  path of file to check</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool    -   boolean value whether the file exists or not</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_directory_exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span></div>

<div class="viewcode-block" id="WindowsMachine.create_directory"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.create_directory">[docs]</a>    <span class="k">def</span> <span class="nf">create_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a directory on the client, if it does not exist.</span>

<span class="sd">        Args:</span>
<span class="sd">            directory_name  (str)   --  name / full path of the directory to create</span>

<span class="sd">        Returns:</span>
<span class="sd">            True    -   if directory creation was successful</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if directory already exists</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_directory_exists</span><span class="p">(</span><span class="n">directory_name</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">CREATE_DIRECTORY</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;directory_name&#39;</span><span class="p">:</span> <span class="n">directory_name</span>
            <span class="p">}</span>
            <span class="n">create_directory_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">create_directory_script</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">create_directory_script</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span>
                                <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="WindowsMachine.rename_file_or_folder"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.rename_file_or_folder">[docs]</a>    <span class="k">def</span> <span class="nf">rename_file_or_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old_name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Renames a file or a folder on the client.</span>

<span class="sd">        Args:</span>
<span class="sd">            old_name    (str)   --  name / full path of the directory to rename</span>

<span class="sd">            new_name    (str)   --  new name / full path of the directory</span>

<span class="sd">        Returns:</span>
<span class="sd">            True    -   if the file or folder was renamed successfully</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to rename the file or folder</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">RENAME_ITEM</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;old_name&#39;</span><span class="p">:</span> <span class="n">old_name</span><span class="p">,</span>
            <span class="s1">&#39;new_name&#39;</span><span class="p">:</span> <span class="n">new_name</span>
        <span class="p">}</span>
        <span class="n">rename_item_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">rename_item_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">rename_item_script</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="WindowsMachine.remove_directory"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.remove_directory">[docs]</a>    <span class="k">def</span> <span class="nf">remove_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory_name</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes a directory on the client.</span>

<span class="sd">        Args:</span>
<span class="sd">            directory_name  (str)   --  name of the directory to remove</span>

<span class="sd">            days            (int)   --  directories older than the given days</span>
<span class="sd">            will be cleaned up</span>

<span class="sd">                default: None</span>

<span class="sd">        Returns:</span>
<span class="sd">            True    -   if directory was removed successfully</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to remove the directory</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_directory_exists</span><span class="p">(</span><span class="n">directory_name</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">REMOVE_DIRECTORY</span>

            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;directory_name&#39;</span><span class="p">:</span> <span class="n">directory_name</span><span class="p">,</span>
                <span class="s1">&#39;days&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">days</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">days</span><span class="p">)</span>
            <span class="p">}</span>

            <span class="n">remove_directory_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">remove_directory_script</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">remove_directory_script</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span>
                                <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="WindowsMachine.get_file_size"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.get_file_size">[docs]</a>    <span class="k">def</span> <span class="nf">get_file_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the size of a file on the client.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path   (str)   --  path of the file to get the size of</span>

<span class="sd">        Returns:</span>
<span class="sd">            float   -   size of the file on the client (in MB)</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to get the size of the file</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">GET_SIZE</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">file_path</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;File&#39;</span>
        <span class="p">}</span>
        <span class="n">get_size_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">get_size_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">get_size_script</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">formatted_output</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="WindowsMachine.get_folder_size"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.get_folder_size">[docs]</a>    <span class="k">def</span> <span class="nf">get_folder_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the size of a folder on the client.</span>

<span class="sd">        Args:</span>
<span class="sd">            folder_path     (str)   --  path of the folder to get the size of</span>

<span class="sd">        Returns:</span>
<span class="sd">            float   -   size of the folder on the client (in MB)</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to get the size of the folder</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">GET_SIZE</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">folder_path</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;Folder&#39;</span>
        <span class="p">}</span>
        <span class="n">get_size_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">get_size_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">get_size_script</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">formatted_output</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="WindowsMachine.get_storage_details"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.get_storage_details">[docs]</a>    <span class="k">def</span> <span class="nf">get_storage_details</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the details of the Storage on the Client.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict    -   dictionary consisting the details of the storage on the client (in MB)</span>

<span class="sd">            {</span>
<span class="sd">                &#39;total&#39;: size_in_MB,</span>

<span class="sd">                &#39;available&#39;: size_in_MB,</span>

<span class="sd">                &#39;drive&#39;: {</span>

<span class="sd">                    &#39;total&#39;: size_in_MB,</span>

<span class="sd">                    &#39;available&#39;: size_in_MB,</span>
<span class="sd">                }</span>
<span class="sd">            }</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to get the storage details for the machine</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="s1">&#39;Get-PSDrive&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="n">storage_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;available&#39;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">output</span><span class="o">.</span><span class="n">formatted_output</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">drive_name</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">used_space</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1024.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">free_space</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1024.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">total_space</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">free_space</span> <span class="o">+</span> <span class="n">used_space</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

                <span class="n">storage_dict</span><span class="p">[</span><span class="n">drive_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="n">total_space</span><span class="p">,</span>
                    <span class="s1">&#39;available&#39;</span><span class="p">:</span> <span class="n">free_space</span>
                <span class="p">}</span>

                <span class="n">storage_dict</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">total_space</span>
                <span class="n">storage_dict</span><span class="p">[</span><span class="s1">&#39;available&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">free_space</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">continue</span>

        <span class="k">return</span> <span class="n">storage_dict</span></div>

<div class="viewcode-block" id="WindowsMachine.get_disk_count"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.get_disk_count">[docs]</a>    <span class="k">def</span> <span class="nf">get_disk_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the number of disks on the machine.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int     -   disk count of the machine</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to get the disk count for the machine</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span>
            <span class="s1">&#39;(Get-WmiObject -Query &quot;select * from Win32_PhysicalMedia&quot;).count&#39;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">formatted_output</span></div>

    <span class="c1"># Registry related operations</span>
<div class="viewcode-block" id="WindowsMachine.check_registry_exists"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.check_registry_exists">[docs]</a>    <span class="k">def</span> <span class="nf">check_registry_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if a registry key / value exists on the client or not.</span>

<span class="sd">        Args:</span>
<span class="sd">            key     (str)   --  registry path of the key</span>

<span class="sd">            value   (str)   --  value of the registry key</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool    -   boolean value whether the registry key / value exists or not</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">REGISTRY_EXISTS</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">%</span> <span class="n">key</span><span class="p">,</span>
            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">}</span>
        <span class="n">registry_exists_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">registry_exists_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">registry_exists_script</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">formatted_output</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;true&#39;</span></div>

<div class="viewcode-block" id="WindowsMachine.get_registry_value"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.get_registry_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_registry_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the data of a registry key and value on the client.</span>

<span class="sd">        Args:</span>
<span class="sd">            key     (str)       --  registry path of the key</span>

<span class="sd">            value   (str)       --  value of the registry key</span>

<span class="sd">        Returns:</span>
<span class="sd">            str     -   data of the value of the registry key</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to get the data of the registry key and value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">GET_REG_VALUE</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">%</span> <span class="n">key</span><span class="p">,</span>
            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">}</span>
        <span class="n">get_reg_value_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">get_reg_value_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">get_reg_value_script</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">formatted_output</span></div>

<div class="viewcode-block" id="WindowsMachine.create_registry"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.create_registry">[docs]</a>    <span class="k">def</span> <span class="nf">create_registry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reg_type</span><span class="o">=</span><span class="s1">&#39;String&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a registry key / value on the client, if it does not exist.</span>

<span class="sd">        Args:</span>
<span class="sd">            key     (str)       --  registry path of the key</span>


<span class="sd">            value   (str)       --  value of the registry key</span>

<span class="sd">                default: None</span>


<span class="sd">            data    (str)       --  data for the registry value</span>

<span class="sd">                default: None</span>


<span class="sd">            type    (str)       --  type of the registry value to add</span>

<span class="sd">                Valid values are:</span>

<span class="sd">                    - String</span>
<span class="sd">                    - Binary</span>
<span class="sd">                    - DWord</span>
<span class="sd">                    - QWord</span>
<span class="sd">                    - MultiString</span>

<span class="sd">                default: String</span>


<span class="sd">        Returns:</span>
<span class="sd">            bool    -   if registry key / value creation was successful</span>


<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to create the registry key</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">SET_REG_VALUE</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">%</span> <span class="n">key</span><span class="p">,</span>
            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span>
            <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">reg_type</span>
        <span class="p">}</span>
        <span class="n">create_registry_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">create_registry_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">create_registry_script</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">formatted_output</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span></div>

<div class="viewcode-block" id="WindowsMachine.update_registry"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.update_registry">[docs]</a>    <span class="k">def</span> <span class="nf">update_registry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reg_type</span><span class="o">=</span><span class="s1">&#39;String&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Updates the value of a registry key on the client.</span>

<span class="sd">        Args:</span>
<span class="sd">            key     (str)       --  registry path of the key</span>

<span class="sd">            value   (str)       --  value of the registry key</span>

<span class="sd">            data    (object)    --  data for the registry value</span>

<span class="sd">            type    (str)       --  type of the registry value to add</span>

<span class="sd">                Valid values are:</span>

<span class="sd">                    - String</span>
<span class="sd">                    - Binary</span>
<span class="sd">                    - DWord</span>
<span class="sd">                    - QWord</span>
<span class="sd">                    - MultiString</span>

<span class="sd">                default: String</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool    -   if registry value was updated successfully</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to get the storage details for the machine</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">SET_REG_VALUE</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">%</span> <span class="n">key</span><span class="p">,</span>
            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span>
            <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">reg_type</span>
        <span class="p">}</span>
        <span class="n">update_reg_value_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">update_reg_value_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">update_reg_value_script</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">formatted_output</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span></div>

<div class="viewcode-block" id="WindowsMachine.remove_registry"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.remove_registry">[docs]</a>    <span class="k">def</span> <span class="nf">remove_registry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes a registry key / value on the client.</span>

<span class="sd">        Args:</span>
<span class="sd">            key     (str)       --  registry path of the key</span>

<span class="sd">            value   (str)       --  value of the registry key</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool    -   if registry key / value removal was successful</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to remove the registry key</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">DELETE_REGISTRY</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">%</span> <span class="n">key</span><span class="p">,</span>
            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">value</span>
        <span class="p">}</span>
        <span class="n">delete_registry_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">delete_registry_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">delete_registry_script</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">formatted_output</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span></div>

<div class="viewcode-block" id="WindowsMachine.is_directory"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.is_directory">[docs]</a>    <span class="k">def</span> <span class="nf">is_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks if the given path is a directory or not.</span>

<span class="sd">        Args:</span>
<span class="sd">            path    (str)   --  full path of the directory to be validated</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool:</span>
<span class="sd">                True    -   if the given path is a directory</span>

<span class="sd">                False   -   if the given path is NOT a directory</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed check if its directory</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">command</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;([IO.FileInfo]&#39;</span><span class="si">{path}</span><span class="s2">&#39;).Attributes -match &#39;Directory&#39;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">formatted_output</span></div>

<div class="viewcode-block" id="WindowsMachine.mount_network_path"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.mount_network_path">[docs]</a>    <span class="k">def</span> <span class="nf">mount_network_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_path</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Mounts the specified network path on this machine.</span>

<span class="sd">        Args:</span>
<span class="sd">            network_path    (str)   --  network path to be mounted on this machine</span>

<span class="sd">            username        (str)   --  username to access the network path</span>

<span class="sd">                Ex: DOMAIN\\\\USERNAME</span>

<span class="sd">            password        (str)   --  password for above mentioned user</span>


<span class="sd">        Returns:</span>
<span class="sd">            str     -   drive letter where the network path is mounted</span>


<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to mount network path</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">MOUNT_NETWORK_PATH</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;network_path&#39;</span><span class="p">:</span> <span class="n">network_path</span><span class="p">,</span>
            <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span>
            <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="n">password</span>
        <span class="p">}</span>
        <span class="n">mount_network_path_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">mount_network_path_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">mount_network_path_script</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">formatted_output</span></div>

<div class="viewcode-block" id="WindowsMachine.copy_folder_to_network_share"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.copy_folder_to_network_share">[docs]</a>    <span class="k">def</span> <span class="nf">copy_folder_to_network_share</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_path</span><span class="p">,</span> <span class="n">network_path</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copies the directory specified at source path to the network share path.</span>

<span class="sd">        Args:</span>
<span class="sd">            source_path     (str)   --  source directory to be copied</span>

<span class="sd">            network_path    (str)   --  network path to copy the files and folders at</span>

<span class="sd">            username        (str)   --  username to access network path</span>

<span class="sd">                e.g.; Domain\\\\Username</span>

<span class="sd">            password        (str)   --  password for the above mentioned user</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to mount network path</span>

<span class="sd">                if failed to copy files to mounted drive</span>

<span class="sd">                if failed to un mount network drive</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Mount Network shared path on this machine</span>
        <span class="n">mount_drive</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mount_network_path</span><span class="p">(</span><span class="n">network_path</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">COPY_FOLDER</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="n">source_path</span><span class="p">,</span>
            <span class="s1">&#39;destination&#39;</span><span class="p">:</span> <span class="n">mount_drive</span>
        <span class="p">}</span>
        <span class="n">copy_folder_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">copy_folder_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">copy_folder_script</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="c1"># Un mount network shared path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unmount_drive</span><span class="p">(</span><span class="n">mount_drive</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="WindowsMachine.copy_from_network_share"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.copy_from_network_share">[docs]</a>    <span class="k">def</span> <span class="nf">copy_from_network_share</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_path</span><span class="p">,</span> <span class="n">destination_path</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copies the file/folder from the given network path to the destination path on</span>
<span class="sd">           the machine represented by this Machine class instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            network_path        (str)   --  full UNC path of the file/folder to be copied</span>

<span class="sd">            destination_path    (str)   --  destination folder to copy the file/folder at</span>

<span class="sd">            username            (str)   --  username to access the network path</span>

<span class="sd">                e.g.; Domain\\\\Username</span>

<span class="sd">            password        (str)   --  password for the above mentioned user</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool:</span>
<span class="sd">                True    -   if the file/folder was copied successfully</span>

<span class="sd">                False   -   if failed to copy the file/folder</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to mount network path</span>

<span class="sd">                if failed to copy file/folder from mounted drive</span>

<span class="sd">                if failed to un mount network drive</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_directory_exists</span><span class="p">(</span><span class="n">destination_path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_directory</span><span class="p">(</span><span class="n">destination_path</span><span class="p">)</span>

        <span class="n">network_path</span><span class="p">,</span> <span class="n">source_item</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">network_path</span><span class="p">)</span>
        <span class="n">network_path</span> <span class="o">=</span> <span class="n">network_path</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">mount_drive</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mount_network_path</span><span class="p">(</span><span class="n">network_path</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
        <span class="n">source_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">join_path</span><span class="p">(</span><span class="n">mount_drive</span><span class="p">,</span> <span class="n">source_item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">COPY_FOLDER</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="n">source_item</span><span class="p">,</span>
            <span class="s1">&#39;destination&#39;</span><span class="p">:</span> <span class="n">destination_path</span>
        <span class="p">}</span>

        <span class="n">copy_folder_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">copy_folder_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">copy_folder_script</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="c1"># Un mount network shared path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unmount_drive</span><span class="p">(</span><span class="n">mount_drive</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="WindowsMachine.copy_folder"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.copy_folder">[docs]</a>    <span class="k">def</span> <span class="nf">copy_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_path</span><span class="p">,</span> <span class="n">destination_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copies the directory specified at source path to the destination path.</span>

<span class="sd">        Args:</span>
<span class="sd">            source_path         (str)   --  source directory to be copied</span>

<span class="sd">            destination_path    (str)   --  destination path where the folder has to be copied</span>


<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to connect to the machine where the copy has to done locally</span>

<span class="sd">                if failed to copy files from source to destination</span>

<span class="sd">                if either of the source or destination path specifies is wrong</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">COPY_FOLDER</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="n">source_path</span><span class="p">,</span>
            <span class="s1">&#39;destination&#39;</span><span class="p">:</span> <span class="n">destination_path</span>
        <span class="p">}</span>
        <span class="n">copy_folder_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">copy_folder_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">copy_folder_script</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span></div>

<div class="viewcode-block" id="WindowsMachine.unmount_drive"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.unmount_drive">[docs]</a>    <span class="k">def</span> <span class="nf">unmount_drive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">drive_letter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Un mounts the drive specified by the drive letter.</span>

<span class="sd">        Args:</span>
<span class="sd">            drive_letter    (str)   --  drive letter of the windows mount path to be un mounted</span>

<span class="sd">                e.g.; Z:</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to un mount the network drive</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">UNMOUNT_NETWORK_PATH</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;drive&#39;</span><span class="p">:</span> <span class="n">drive_letter</span>
        <span class="p">}</span>
        <span class="n">unmount_drive_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">unmount_drive_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">unmount_drive_script</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="WindowsMachine.create_file"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.create_file">[docs]</a>    <span class="k">def</span> <span class="nf">create_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">file_size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a file at specified path on this machine with the given content.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path   (str)   --  path of the file to be created</span>

<span class="sd">            content     (str)   --  content to be written in the file</span>

<span class="sd">            file_size   (int)  -- by default it is None, then it will create</span>
<span class="sd">                                    file with related content otherwise,</span>
<span class="sd">                                    it will create file with required size</span>
<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to create file</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">file_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">CREATE_FILE</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">file_path</span><span class="p">,</span>
                <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="n">content</span>
            <span class="p">}</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">CREATE_FILE_WITHSIZE</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;FilePath&#39;</span><span class="p">:</span> <span class="n">file_path</span><span class="p">,</span>
                <span class="s1">&#39;Size&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">file_size</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;file size need to be integer value&#39;</span><span class="p">)</span>

        <span class="n">create_file_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">create_file_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">create_file_script</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="WindowsMachine.execute_exe"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.execute_exe">[docs]</a>    <span class="k">def</span> <span class="nf">execute_exe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exe_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Execute the exe present at the given path.</span>

<span class="sd">        Args:</span>
<span class="sd">            exe_path    (str)   --  full path of the exe to be executed</span>

<span class="sd">        Returns:</span>
<span class="sd">            str     -   output of the exe execution</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if failed to execute the exe</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">exe_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">os_sep</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">EXECUTE_EXE</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">EXECUTE_EXE</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;exe_path&#39;</span><span class="p">:</span> <span class="n">exe_path</span><span class="p">,</span>
            <span class="s1">&#39;exe_name&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">EXECUTE_EXE</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="n">file_list_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">file_list_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">file_list_script</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">output</span></div>

<div class="viewcode-block" id="WindowsMachine.copy_from_local"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.copy_from_local">[docs]</a>    <span class="k">def</span> <span class="nf">copy_from_local</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">local_path</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copies the file / folder present at the given path to the path specified on the</span>
<span class="sd">            remote machine.</span>

<span class="sd">        Args:</span>
<span class="sd">            local_path      (str)   --  path of the file / folder on the local machine</span>

<span class="sd">            remote_path     (str)   --  path of the directory to which the file / folder</span>
<span class="sd">            should be copied on the remote machine</span>

<span class="sd">        Returns:</span>

<span class="sd">            **bool** output specifying whether the file / folder was copied successfully or not</span>

<span class="sd">                True    -   all files / folders were copied successfully</span>

<span class="sd">                False   -   failed to copy some files / folders</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to copy the file / folder</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">local_path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Local Path specified does not exist&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">local_path</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_copy_file_from_local</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">)</span>

        <span class="n">status</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_directory_exists</span><span class="p">(</span><span class="n">remote_path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_directory</span><span class="p">(</span><span class="n">remote_path</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_commvault_client</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client_object</span><span class="o">.</span><span class="n">upload_folder</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">local_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;</span><span class="se">\\</span><span class="si">{0}</span><span class="s1">\</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">socket</span><span class="o">.</span><span class="n">gethostbyname</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">()),</span>
                    <span class="n">local_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;$&#39;</span><span class="p">)</span>
                <span class="p">)</span>

                <span class="n">remote_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;</span><span class="se">\\</span><span class="si">{0}</span><span class="s1">\</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">machine_name</span><span class="p">,</span>
                    <span class="n">remote_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;$&#39;</span><span class="p">)</span>
                <span class="p">)</span>

                <span class="n">remote_path_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">remote_path</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="c1"># set the value of ComputerName to `null`, so the PS script is</span>
                <span class="c1"># executed locally, if the machine is not a local machine</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_local_machine</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">machine_name</span> <span class="o">=</span> <span class="s1">&#39;$null&#39;</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">drive</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mount_network_path</span><span class="p">(</span>
                        <span class="n">remote_path_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">password</span>
                    <span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span>
                    <span class="s2">&quot;Copy-Item &#39;</span><span class="si">{0}</span><span class="s2">&#39; &#39;</span><span class="si">{1}</span><span class="s2">&#39; -Recurse -Force&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">remote_path</span><span class="p">)</span>
                <span class="p">)</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">unmount_drive</span><span class="p">(</span><span class="n">drive</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">pass</span>

                <span class="c1"># reset the value of ComputerName back to the machine name, after the PS script has</span>
                <span class="c1"># been executed successfully, only if the machine is not a local machine</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_local_machine</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">machine_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine_name</span>

                <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">status</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">status</span></div>

<div class="viewcode-block" id="WindowsMachine.read_file"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.read_file">[docs]</a>    <span class="k">def</span> <span class="nf">read_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the contents of the file present at the specified file path.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path   (str)   --  Full path of the file to get the contents of.</span>

<span class="sd">            \*\*kwargs  (dict)  --  Optional arguments</span>

<span class="sd">            Available kwargs Options:</span>

<span class="sd">                offset  (int)   :   Offset in the file, specified in bytes, from where content needs to be read.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str     -   String consisting of the file contents.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                If no file exists at the given path.</span>

<span class="sd">                If failed to get the contents of the file.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;offset&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">offset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="s1">&#39;Get-Content &quot;</span><span class="si">{0}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_path</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="s2">&quot;[System.Text.Encoding]::ASCII.GetString($(Get-Content &quot;</span>
                                          <span class="s2">&quot;-Path </span><span class="se">\&quot;</span><span class="si">{FILE_PATH}</span><span class="se">\&quot;</span><span class="s2"> -Raw -Encoding Byte &quot;</span>
                                          <span class="s2">&quot;| % {{$_[</span><span class="si">{OFFSET}</span><span class="s2">..($_.Length-1)]}}))&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">FILE_PATH</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
                                                                                         <span class="n">OFFSET</span><span class="o">=</span><span class="n">offset</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">output</span></div>

<div class="viewcode-block" id="WindowsMachine.delete_file"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.delete_file">[docs]</a>    <span class="k">def</span> <span class="nf">delete_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes the file present at the specified file path.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path   (str)   --  full path of the file to be removed</span>

<span class="sd">        Returns:</span>
<span class="sd">            None    -   if the file was removed successfully</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if no file exists at the given path</span>

<span class="sd">                if failed to remove the file</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span>
            <span class="s1">&#39;Remove-Item -Force &quot;</span><span class="si">{0}</span><span class="s1">&quot; | Out-Null&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_path</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span></div>

<div class="viewcode-block" id="WindowsMachine.change_folder_owner"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.change_folder_owner">[docs]</a>    <span class="k">def</span> <span class="nf">change_folder_owner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">directory_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Changes the owner of the folder given as the value of directory_path.</span>

<span class="sd">        Args:</span>
<span class="sd">            username        (str)   --  name of user to give ownership</span>

<span class="sd">            directory_path  (str)   --  path of the directory to change ownership</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool    -   boolean value if ownership change was successful</span>

<span class="sd">        Raises:</span>
<span class="sd">            NotImplementedError:</span>
<span class="sd">                the method has not yet been implemented for Windows Machine</span>

<span class="sd">            Exception:</span>
<span class="sd">                if specified folder doesn&#39;t exist</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Method Not Implemented&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="WindowsMachine.create_current_timestamp_folder"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.create_current_timestamp_folder">[docs]</a>    <span class="k">def</span> <span class="nf">create_current_timestamp_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a folder with current date / time as folder name at the given path.</span>

<span class="sd">        Args:</span>
<span class="sd">            folder_path     (str)   --  absolute path to create the folder at</span>

<span class="sd">            timestamp       (str)   --  whether to create a folder with the current date or the</span>
<span class="sd">            current time</span>

<span class="sd">                To create a folder with the date, pass the value as **date**</span>

<span class="sd">                Otherwise it&#39;ll always create folder with the current time as the folder name</span>

<span class="sd">        Returns:</span>
<span class="sd">            str     -   full path of the directory created</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if failed to create the folder</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">timestamp</span> <span class="o">==</span> <span class="s2">&quot;date&quot;</span><span class="p">:</span>
            <span class="n">folder_name</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">folder_name</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%H-%M-%S&#39;</span><span class="p">)</span>

        <span class="n">directory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">join_path</span><span class="p">(</span><span class="n">folder_path</span><span class="p">,</span> <span class="n">folder_name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">create_directory</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">directory</span></div>

<div class="viewcode-block" id="WindowsMachine.get_latest_timestamp_file_or_folder"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.get_latest_timestamp_file_or_folder">[docs]</a>    <span class="k">def</span> <span class="nf">get_latest_timestamp_file_or_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">,</span> <span class="n">operation_type</span><span class="o">=</span><span class="s2">&quot;folder&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the latest timestamp folder in given path.</span>

<span class="sd">        Args:</span>
<span class="sd">            folder_path     (str)   --  full path of the folder to get latest</span>
<span class="sd">            file / folder from</span>

<span class="sd">            operation_type  (str)   --  type of the operation, i.e., whether to get latest file</span>
<span class="sd">            or the folder from the given folder path</span>

<span class="sd">                Valid values are:</span>

<span class="sd">                -   file</span>
<span class="sd">                -   folder</span>

<span class="sd">                default: folder</span>

<span class="sd">        Returns:</span>
<span class="sd">            str     -   full path of the directory that was created last inside the given</span>
<span class="sd">            folder path</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if failed to get the file / folder with the latest timestamp</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_directory_exists</span><span class="p">(</span><span class="n">folder_path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Please give a valid path&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">LATEST_FILE_OR_FOLDER</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;folder_path&#39;</span><span class="p">:</span> <span class="n">folder_path</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">operation_type</span>
        <span class="p">}</span>

        <span class="n">script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">select_columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">])</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">script</span><span class="p">)</span>

        <span class="c1"># lambda function is required, as each element of formatted output is a list</span>
        <span class="c1"># whereas the output should only be a list with each value being a string</span>
        <span class="n">output_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">output</span><span class="o">.</span><span class="n">formatted_output</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">output_list</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">join_path</span><span class="p">(</span><span class="n">folder_path</span><span class="p">,</span> <span class="n">output_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>

<div class="viewcode-block" id="WindowsMachine.generate_test_data"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.generate_test_data">[docs]</a>    <span class="k">def</span> <span class="nf">generate_test_data</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">file_path</span><span class="p">,</span>
            <span class="n">dirs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">files</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
            <span class="n">file_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
            <span class="n">levels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">hlinks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">slinks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">hslinks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">sparse_hole_size</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
            <span class="n">acls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">unicode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">xattr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">long_path</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">long_level</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span>
            <span class="n">problematic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generates and adds random test data at the given path with the specified options.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path           (str)   --  directory path where the data will be generated</span>

<span class="sd">            dirs                (int)   --  number of directories in each level</span>

<span class="sd">                default: 3</span>

<span class="sd">            files               (int)   --  number of files in each directory</span>

<span class="sd">                default: 5</span>

<span class="sd">            file_size           (int)   --  Size of the files in KB</span>

<span class="sd">                default: 20</span>

<span class="sd">            levels              (int)   --  number of levels to be created</span>

<span class="sd">                default: 1</span>

<span class="sd">            hlinks              (bool)  --  whether to create hardlink files</span>

<span class="sd">                default: False</span>

<span class="sd">            slinks              (bool)  --  whether to create symbolic link files</span>

<span class="sd">                default: False</span>

<span class="sd">            hslinks             (bool)  --  whether to create</span>
<span class="sd">                                            symbolic link files with hardlinks.</span>

<span class="sd">                default: False</span>
<span class="sd">                **support not yet implemented, added here for maintaining signature**</span>
<span class="sd">                **this argument will be ignored and not used till it is implemented**</span>

<span class="sd">            sparse              (bool)  --  whether to create sparse files</span>

<span class="sd">                default: False</span>

<span class="sd">            sparse_hole_size    (int)   --  Size of the holes in sparse files in KB</span>

<span class="sd">                default: 1024</span>

<span class="sd">            long_path           (bool)  --  whether to create long files</span>
<span class="sd">                default: False</span>
<span class="sd">                **support not yet implemented, added here for maintaining signature**</span>
<span class="sd">                **this argument will be ignored and not used till it is implemented**</span>

<span class="sd">            long_level          (int)   --  length of the long path</span>
<span class="sd">                default: 1500</span>
<span class="sd">                **support not yet implemented, added here for maintaining signature**</span>
<span class="sd">                **this argument will be ignored and not used till it is implemented**</span>

<span class="sd">            acls                (bool)  --  whether to create files with acls</span>

<span class="sd">                default: False</span>

<span class="sd">            unicode             (bool)  --  whether to create unicode files</span>

<span class="sd">                default: False</span>

<span class="sd">            problematic         (bool)  --  whether to create problematic data</span>
<span class="sd">                default: False</span>
<span class="sd">                **support not yet implemented, added here for maintaining signature**</span>
<span class="sd">                **this argument will be ignored and not used till it is implemented**</span>

<span class="sd">            xattr               (bool)  --  whether to create files with xattr</span>

<span class="sd">                default: False</span>

<span class="sd">            options             (str)   --  to specify any other</span>
<span class="sd">            additional parameters to the script</span>

<span class="sd">                default: &quot;&quot;</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool    -   boolean value True is returned if no errors during data generation</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if any error occurred while generating the test data</span>

<span class="sd">    &quot;&quot;&quot;</span>
        <span class="n">script_arguments</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">file_path</span><span class="p">,</span>
            <span class="s1">&#39;dirs&#39;</span><span class="p">:</span> <span class="n">dirs</span><span class="p">,</span>
            <span class="s1">&#39;files&#39;</span><span class="p">:</span> <span class="n">files</span><span class="p">,</span>
            <span class="s1">&#39;sizeinkb&#39;</span><span class="p">:</span> <span class="n">file_size</span><span class="p">,</span>
            <span class="s1">&#39;levels&#39;</span><span class="p">:</span> <span class="n">levels</span><span class="p">,</span>
            <span class="s1">&#39;options&#39;</span><span class="p">:</span> <span class="n">options</span>
        <span class="p">}</span>

        <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;hlinks&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">hlinks</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>
        <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;slinks&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">slinks</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>

        <span class="k">if</span> <span class="n">sparse</span><span class="p">:</span>
            <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s1">&#39;sparse&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;holesizeinkb&#39;</span><span class="p">:</span> <span class="n">sparse_hole_size</span>
                <span class="p">}</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s1">&#39;sparse&#39;</span><span class="p">:</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;holesizeinkb&#39;</span><span class="p">:</span> <span class="n">sparse_hole_size</span>
                <span class="p">}</span>
            <span class="p">)</span>

        <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;acls&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">acls</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>
        <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;xattr&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">xattr</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>
        <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;unicode&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">unicode</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>
        <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span><span class="s1">&#39;threadcnt&#39;</span><span class="p">:</span> <span class="n">WINDOWS_GENERATE_TEST_DATA_THREAD_COUNT</span><span class="p">})</span>

        <span class="n">delete_zip</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">problematic</span><span class="p">:</span>
            <span class="n">tmp_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">join_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tmp_dir</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
            <span class="n">cv7z_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">join_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client_object</span><span class="o">.</span><span class="n">install_directory</span><span class="p">,</span> <span class="s2">&quot;Base&quot;</span><span class="p">,</span> <span class="s2">&quot;cv7z.exe&quot;</span><span class="p">)</span>
            <span class="n">extr_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">join_path</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">,</span> <span class="s2">&quot;extr&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_directory</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_copy_file_from_local</span><span class="p">(</span><span class="n">WINDOWS_PROBLEM_DATA</span><span class="p">,</span> <span class="n">tmp_path</span><span class="p">)</span>
            <span class="n">custom_zip_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">join_path</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">WINDOWS_PROBLEM_DATA</span><span class="p">))</span>

            <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;zip_file_path&#39;</span><span class="p">:</span> <span class="n">custom_zip_path</span><span class="p">,</span>
                                     <span class="s1">&#39;zip_exe_path&#39;</span><span class="p">:</span> <span class="n">cv7z_path</span><span class="p">,</span>
                                     <span class="s1">&#39;extr_file_path&#39;</span><span class="p">:</span> <span class="n">extr_path</span><span class="p">})</span>
            <span class="n">delete_zip</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span><span class="s1">&#39;zip_file_path&#39;</span><span class="p">:</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;zip_exe_path&#39;</span><span class="p">:</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;extr_file_path&#39;</span><span class="p">:</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">WINDOWS_ADD_DATA</span>

        <span class="n">add_test_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">script_arguments</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">add_test_data</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">add_test_data</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">delete_zip</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_directory</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="WindowsMachine.modify_test_data"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.modify_test_data">[docs]</a>    <span class="k">def</span> <span class="nf">modify_test_data</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">data_path</span><span class="p">,</span>
            <span class="n">rename</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">modify</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">acls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">xattr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">permissions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">slinks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">hlinks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modifies the test data at the given path based on the specified options.</span>

<span class="sd">        Args:</span>
<span class="sd">            data_path       (str)   --  directory path where dataset resides.</span>

<span class="sd">            rename          (bool)  --  whether to rename all files</span>

<span class="sd">                default: False</span>

<span class="sd">            modify          (bool)  --  whether to modify data of all files</span>

<span class="sd">                default: False</span>

<span class="sd">            acls            (bool)  --  whether to change acls of all files</span>

<span class="sd">                default: False</span>

<span class="sd">            xattr           (bool)  --  whether to change xattr of all files</span>

<span class="sd">                default: False</span>

<span class="sd">            permissions     (bool)  --  whether to change permission of all files</span>

<span class="sd">                default: False</span>

<span class="sd">            slinks          (bool)  --  whether to add symbolic link to all files</span>

<span class="sd">                default: False</span>

<span class="sd">            hlinks          (bool)  --  whether to add hard link to all files</span>

<span class="sd">                default: False</span>

<span class="sd">            options         (str)   --  to specify any other</span>
<span class="sd">            additional parameters to the script.</span>

<span class="sd">                default: &quot;&quot;</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool    -   boolean value True is returned if no errors during data generation.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if any error occurred while modifying the test data</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">script_arguments</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">data_path</span><span class="p">,</span>
            <span class="s1">&#39;options&#39;</span><span class="p">:</span> <span class="n">options</span>
        <span class="p">}</span>

        <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;rename&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">rename</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>
        <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;modify&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">modify</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>
        <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;acls&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">acls</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>
        <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;xattr&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">xattr</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>
        <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span><span class="s1">&#39;permissions&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">permissions</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>
        <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;slinks&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">slinks</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>
        <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;hlinks&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">hlinks</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">WINDOWS_MODIFY_DATA</span>

        <span class="n">modify_test_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">script_arguments</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">modify_test_data</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">modify_test_data</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="WindowsMachine.get_test_data_info"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.get_test_data_info">[docs]</a>    <span class="k">def</span> <span class="nf">get_test_data_info</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">data_path</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">meta</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">checksum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">acls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">xattr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">dirtime</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">skiplink</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">machinesort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets information about the items on the given path based on the given options.</span>

<span class="sd">        Args:</span>
<span class="sd">            data_path       (str)   --  directory path from where the data should be retrieved.</span>

<span class="sd">            name            (bool)  --  whether to get name of all the files</span>

<span class="sd">                default: False</span>

<span class="sd">            meta            (bool)  --  whether to get meta data of all files</span>

<span class="sd">                default: True</span>

<span class="sd">            checksum        (bool)  --  whether to get OS checksum of all files</span>

<span class="sd">                default: False</span>

<span class="sd">            machinesort     (bool)  --  whether to sort the results on the machine</span>

<span class="sd">                default: False</span>

<span class="sd">            acls            (bool)  --  whether to get acls of all files</span>

<span class="sd">                default: False</span>

<span class="sd">            xattr           (bool)  --  whether to get xattr of all files</span>

<span class="sd">                default: False</span>

<span class="sd">            dirtime         (bool)  --  whether to get time stamp of all directories</span>
<span class="sd">                default: False</span>
<span class="sd">                **support not yet implemented, added here for maintaining signature**</span>
<span class="sd">                **this argument will be ignored and not used till it is implemented**</span>

<span class="sd">            skiplink        (bool)  --  whether to skip link count of all files</span>
<span class="sd">                default: False</span>
<span class="sd">                **support not yet implemented, added here for maintaining signature**</span>
<span class="sd">                **this argument will be ignored and not used till it is implemented**</span>

<span class="sd">            options         (str)   --  to specify any other</span>
<span class="sd">            additional parameterS to the script.</span>

<span class="sd">                default: &quot;&quot;</span>

<span class="sd">        Returns:</span>
<span class="sd">            list    -   list of output lines while executing the script.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if any error occurred while getting the data information.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">script_arguments</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">data_path</span><span class="p">,</span>
            <span class="s1">&#39;options&#39;</span><span class="p">:</span> <span class="n">options</span>
        <span class="p">}</span>

        <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>
        <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;meta&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">meta</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>
        <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;sum&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">checksum</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>
        <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;acls&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">acls</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>
        <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;xattr&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">xattr</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>
        <span class="n">script_arguments</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;sorted&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">machinesort</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">WINDOWS_GET_DATA</span>

        <span class="n">get_test_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">script_arguments</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">get_test_data</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">get_test_data</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">output</span></div>

<div class="viewcode-block" id="WindowsMachine.get_items_list"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.get_items_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_items_list</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">data_path</span><span class="p">,</span>
            <span class="n">sorted_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">include_parents</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the list of items at the given path.</span>

<span class="sd">        Args:</span>
<span class="sd">            data_path           (str)    --  directory path to get the items list</span>

<span class="sd">            sorted              (bool)   --  to specify whether the list should be sorted.</span>

<span class="sd">                default: True</span>

<span class="sd">            include_parents     (bool)   --  to specify whether parent paths should be include</span>

<span class="sd">                default: False</span>

<span class="sd">        Returns:</span>
<span class="sd">            list    -   list of the items</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if any error occurred while getting the items list</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">output_list_final</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">output_list_1_final</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">output_list_2_final</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">find_cmd_1</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;(Get-ChildItem -Recurse -Path </span><span class="se">\&quot;</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2"> |  where {$_.FullName -notmatch &#39;unicode&#39;}).FullName&quot;</span>
        <span class="p">)</span>
        <span class="n">output_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="n">find_cmd_1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output_1</span><span class="o">.</span><span class="n">exit_code</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">output_1</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output_1</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span>
                                <span class="n">output_1</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">output_1</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output_1</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output_1</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            raise Exception(</span>
<span class="sd">                &quot;Error occurred while getting items list from machine &quot;</span>
<span class="sd">                + output_1.output</span>
<span class="sd">                + output_1.exception</span>
<span class="sd">            )</span>
<span class="sd">            &#39;&#39;&#39;</span>

        <span class="c1"># output_2 WILL FOCUS ONLY ON THE &quot;unicode&quot; DATASET</span>
        <span class="n">script_arguments</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;data_path&#39;</span><span class="p">:</span> <span class="n">data_path</span><span class="p">,</span>
            <span class="s1">&#39;search_term&#39;</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">WINDOWS_GET_ASCII_VALUE_FOR_PATH</span>

        <span class="n">get_items_list_ascii</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">script_arguments</span><span class="p">)</span>

        <span class="n">output_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">get_items_list_ascii</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">get_items_list_ascii</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output_2</span><span class="o">.</span><span class="n">exit_code</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">output_2</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output_2</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span>
                                <span class="n">output_2</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">output_2</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output_2</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output_2</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">output_list_1</span> <span class="o">=</span> <span class="n">output_1</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">output_list_2</span> <span class="o">=</span> <span class="n">output_2</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">output_list_1</span><span class="p">):</span>
                <span class="n">output_list_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">output_list_1_final</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">output_list_1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">output_list_2</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">output_list_2</span><span class="p">):</span>
                    <span class="n">output_list_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span>

                    <span class="c1"># NO ASCII VALUE FOR &#39;&#39;</span>
                    <span class="k">if</span> <span class="n">output_list_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                        <span class="n">output_list_2_final</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">output_list_2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

                <span class="c1"># ASCII TO CHAR CONVERSION FOR output_list_2</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ascii_list</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">output_list_2_final</span><span class="p">):</span>
                    <span class="n">output_list_2_final</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="nb">list</span><span class="p">(</span>
                            <span class="nb">map</span><span class="p">(</span><span class="nb">chr</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span>
                                <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ascii_list</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
                            <span class="p">))</span>
                        <span class="p">)</span>
                    <span class="p">)</span>

            <span class="k">if</span> <span class="n">include_parents</span><span class="p">:</span>
                <span class="n">data_path</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span>
                <span class="n">data_path</span> <span class="o">=</span> <span class="n">data_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">parent_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span>

                <span class="k">for</span> <span class="n">itr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">data_path</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)):</span>
                    <span class="n">parent_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_path</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">itr</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

                <span class="n">output_list_final</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">output_list_1_final</span><span class="p">)</span>
                <span class="n">output_list_final</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">output_list_2_final</span><span class="p">)</span>
                <span class="n">output_list_final</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">parent_list</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">sorted_output</span><span class="p">:</span>
                <span class="n">output_list_final</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

            <span class="c1"># remove empty items and return output list</span>
            <span class="k">while</span> <span class="s1">&#39;&#39;</span> <span class="ow">in</span> <span class="n">output_list_final</span><span class="p">:</span>
                <span class="n">output_list_final</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">output_list_final</span></div>

<div class="viewcode-block" id="WindowsMachine.get_meta_list"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.get_meta_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_meta_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_path</span><span class="p">,</span> <span class="n">sorted_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dirtime</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">skiplink</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the list of meta data of items from the machine on a given path.</span>

<span class="sd">        Args:</span>
<span class="sd">            data_path       (str)   --  directory path to get meta data of the items list</span>

<span class="sd">            sorted_output   (bool)  --  to specify whether the list should be sorted</span>

<span class="sd">            dirtime         (bool)  --  whether to get time stamp of all directories</span>
<span class="sd">                default: False</span>
<span class="sd">                **support not yet implemented, added here for maintaining signature**</span>
<span class="sd">                **this argument will be ignored and not used till it is implemented**</span>

<span class="sd">            skiplink        (bool)  --  whether to skip link count of all files</span>
<span class="sd">                default: False</span>
<span class="sd">                **support not yet implemented, added here for maintaining signature**</span>
<span class="sd">                **this argument will be ignored and not used till it is implemented**</span>
<span class="sd">        Returns:</span>
<span class="sd">            list    -   list of meta data of items from the machine</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if any error occurred while getting the meta data of items</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">meta_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_test_data_info</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">meta</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">meta_list</span> <span class="o">=</span> <span class="n">meta_data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">while</span> <span class="s1">&#39;&#39;</span> <span class="ow">in</span> <span class="n">meta_list</span><span class="p">:</span>
                <span class="n">meta_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">sorted_output</span><span class="p">:</span>
                <span class="n">meta_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">meta_list</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;Error occurred while getting meta data from machine </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">excp</span><span class="p">))</span></div>

<div class="viewcode-block" id="WindowsMachine.compare_meta_data"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.compare_meta_data">[docs]</a>    <span class="k">def</span> <span class="nf">compare_meta_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_path</span><span class="p">,</span> <span class="n">destination_path</span><span class="p">,</span> <span class="n">dirtime</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">skiplink</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares the meta data of source path with destination path and checks if they are same.</span>

<span class="sd">         Args:</span>
<span class="sd">            source_path         (str)   --  source path of the folder to compare</span>

<span class="sd">            destination_path    (str)   --  destination path of the folder to compare</span>

<span class="sd">            dirtime             (bool)  --  whether to get time stamp of all directories</span>
<span class="sd">                default: False</span>
<span class="sd">                **support not yet implemented, added here for maintaining signature**</span>
<span class="sd">                **this argument will be ignored and not used till it is implemented**</span>

<span class="sd">            skiplink            (bool)  --  whether to skip link count of all files</span>
<span class="sd">                default: False</span>
<span class="sd">                **support not yet implemented, added here for maintaining signature**</span>
<span class="sd">                **this argument will be ignored and not used till it is implemented**</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple   -   tuple consisting of a boolean and a string, where:</span>

<span class="sd">                bool:</span>

<span class="sd">                    returns True if the lists are identical</span>

<span class="sd">                    returns False if the contents of the lists are different</span>

<span class="sd">                str:</span>

<span class="sd">                    empty string in case of True, otherwise string consisting of the</span>
<span class="sd">                    differences b/w the 2 lists separated by new-line</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if any error occurred while comparing the meta data of paths</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">source_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meta_list</span><span class="p">(</span><span class="n">source_path</span><span class="p">)</span>
            <span class="n">destination_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_meta_list</span><span class="p">(</span><span class="n">destination_path</span><span class="p">)</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compare_lists</span><span class="p">(</span><span class="n">source_list</span><span class="p">,</span> <span class="n">destination_list</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;Error occurred while comparing the metadata: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">excp</span><span class="p">)))</span></div>

<div class="viewcode-block" id="WindowsMachine.get_checksum_list"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.get_checksum_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_checksum_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_path</span><span class="p">,</span> <span class="n">sorted_output</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the list of checksum of items from the machine on a give path</span>
<span class="sd">            this is Windows checksum.</span>

<span class="sd">         Args:</span>
<span class="sd">            data_path       (str)   --  directory path to get the checksum list</span>

<span class="sd">            sorted_output   (bool)  --  to specify whether the checksum list should be sorted</span>

<span class="sd">        Returns:</span>
<span class="sd">            list    -   list of checksum of items from  the machine</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if any error occurred while getting the checksum of items</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">checksum_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_test_data_info</span><span class="p">(</span>
                <span class="n">data_path</span><span class="p">,</span> <span class="n">checksum</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            <span class="n">checksum_list</span> <span class="o">=</span> <span class="n">checksum_data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">while</span> <span class="s1">&#39;&#39;</span> <span class="ow">in</span> <span class="n">checksum_list</span><span class="p">:</span>
                <span class="n">checksum_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">sorted_output</span><span class="p">:</span>
                <span class="n">checksum_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">checksum_list</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Error occurred while getting checksum list from machine </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">excp</span>
            <span class="p">))</span></div>

<div class="viewcode-block" id="WindowsMachine.compare_checksum"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.compare_checksum">[docs]</a>    <span class="k">def</span> <span class="nf">compare_checksum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_path</span><span class="p">,</span> <span class="n">destination_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares the checksum of source path with destination path and checks if they are same.</span>

<span class="sd">         Args:</span>
<span class="sd">            source_path         (str)   --  source path of the folder to compare</span>

<span class="sd">            destination_path    (str)   --  destination path of the folder to compare</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple   -   tuple consisting of a boolean and a string, where:</span>

<span class="sd">                bool:</span>

<span class="sd">                    returns True if the lists are identical</span>

<span class="sd">                    returns False if the contents of the lists are different</span>

<span class="sd">                str:</span>

<span class="sd">                    empty string in case of True, otherwise string consisting of the</span>
<span class="sd">                    differences b/w the 2 lists separated by new-line</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if any error occurred while comparing the checksum of paths</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">source_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_checksum_list</span><span class="p">(</span><span class="n">source_path</span><span class="p">)</span>
            <span class="n">destination_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_checksum_list</span><span class="p">(</span><span class="n">destination_path</span><span class="p">)</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compare_lists</span><span class="p">(</span><span class="n">source_list</span><span class="p">,</span> <span class="n">destination_list</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;Error occurred while comparing the checksums: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">excp</span><span class="p">)))</span></div>

<div class="viewcode-block" id="WindowsMachine.get_registry_entries_for_subkey"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.get_registry_entries_for_subkey">[docs]</a>    <span class="k">def</span> <span class="nf">get_registry_entries_for_subkey</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">subkey</span><span class="p">,</span>
            <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">find_subkey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">find_entry</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieves all the registry entries under a given subkey value</span>
<span class="sd">        and/or find a particular subkey or entry.</span>

<span class="sd">        Args:</span>
<span class="sd">            subkey      (str)   --  Name of the subkey</span>

<span class="sd">            recurse     (bool)  --  Boolean flag to specify whether to</span>
<span class="sd">            recurse through subekys of the specified subkey.</span>

<span class="sd">                default: True</span>

<span class="sd">            find_subkey (str)   --  Value of the subkey that needs to be found.</span>

<span class="sd">                default: None</span>

<span class="sd">                **support not yet implemented, added here for maintaining signature**</span>

<span class="sd">                **this argument will be ignored and not used till it is implemented**</span>

<span class="sd">            find_entry  (str)   -- Value of the entry that needs to be found.</span>

<span class="sd">                default: False</span>

<span class="sd">                **support not yet implemented, added here for maintaining signature**</span>

<span class="sd">                **this argument will be ignored and not used till it is implemented**</span>

<span class="sd">        Returns:</span>
<span class="sd">            str   -   newline separated string containing</span>
<span class="sd">            all the registry entries and their values.</span>


<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                If any error occurred while retrieving</span>
<span class="sd">                registry entries from the given subkey value.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">script_arguments</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;subkeyname&#39;</span><span class="p">:</span> <span class="n">subkey</span><span class="p">,</span>
            <span class="s1">&#39;recurse&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span> <span class="k">if</span> <span class="n">recurse</span> <span class="k">else</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span>
            <span class="s1">&#39;findsubkey&#39;</span><span class="p">:</span> <span class="n">find_subkey</span><span class="p">,</span>
            <span class="s1">&#39;findentry&#39;</span><span class="p">:</span> <span class="n">find_entry</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">WINDOWS_GET_REGISTRY_ENTRY_FOR_SUBKEY</span>
        <span class="n">get_registry_entry_for_subkey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">script_arguments</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">get_registry_entry_for_subkey</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">get_registry_entry_for_subkey</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">output</span></div>

<div class="viewcode-block" id="WindowsMachine.get_files_in_path"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.get_files_in_path">[docs]</a>    <span class="k">def</span> <span class="nf">get_files_in_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list of all the files at the given folder path.</span>

<span class="sd">        Args:</span>
<span class="sd">            folder_path     (str)   --  full path of the folder to get the list of files from</span>

<span class="sd">        Returns:</span>
<span class="sd">            list    -   list of the files present at the given path</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if path is not valid</span>

<span class="sd">                if failed to get the list of files</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_files_or_folders_in_path</span><span class="p">(</span><span class="n">folder_path</span><span class="p">,</span> <span class="s1">&#39;FILE&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="WindowsMachine.get_folders_in_path"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.get_folders_in_path">[docs]</a>    <span class="k">def</span> <span class="nf">get_folders_in_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list of all the folders at the given folder path.</span>

<span class="sd">        Args:</span>
<span class="sd">            folder_path     (str)   --  full path of the folder to get the list of folders from</span>

<span class="sd">        Returns:</span>
<span class="sd">            list    -   list of the folders present at the given path</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if path is not valid</span>

<span class="sd">                if failed to get the list of folders</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_files_or_folders_in_path</span><span class="p">(</span><span class="n">folder_path</span><span class="p">,</span> <span class="s1">&#39;FOLDER&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="WindowsMachine.get_folder_or_file_names"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.get_folder_or_file_names">[docs]</a>    <span class="k">def</span> <span class="nf">get_folder_or_file_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">,</span> <span class="n">filesonly</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list of files / folders present inside the given folder path on the client.</span>

<span class="sd">        Args:</span>
<span class="sd">            folder_path     (str)   --  folder path to get the list of files / folders from</span>

<span class="sd">            filesonly       (bool)  --  boolean flag to specify whether to get files or folders</span>

<span class="sd">        Returns:</span>
<span class="sd">            list    -   returns the list of all the files / folders present inside the</span>
<span class="sd">            given path based on the **filesonly** flag</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to get list of folders available in the path</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">filesonly</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;Get-ChildItem -file </span><span class="si">{}</span><span class="s2">  | Select-Object Name&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;Get-ChildItem -dir </span><span class="si">{}</span><span class="s2">  | Select-Object Name&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">output</span></div>

<div class="viewcode-block" id="WindowsMachine.get_files_and_directory_path"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.get_files_and_directory_path">[docs]</a>    <span class="k">def</span> <span class="nf">get_files_and_directory_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list of files and its directory paths present inside the given</span>
<span class="sd">        folder path on the client.</span>

<span class="sd">        Args:</span>
<span class="sd">            folder_path     (str)   --  folder path to get the list of files</span>
<span class="sd">        Returns:</span>
<span class="sd">            list    -   returns the list of all the files and its directory present inside the</span>
<span class="sd">            given path</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                if failed to get list of folders available in the path</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;Get-ChildItem &#39;</span><span class="si">{}</span><span class="s2">&#39; -Recurse | Format-List DirectoryName, Name&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">output</span></div>

<div class="viewcode-block" id="WindowsMachine.add_firewall_allow_port_rule"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.add_firewall_allow_port_rule">[docs]</a>    <span class="k">def</span> <span class="nf">add_firewall_allow_port_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tunnel_port</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds the inbound rule for the given port number</span>

<span class="sd">        Args:</span>
<span class="sd">            tunnel_port (int): port number to be added in the inbound rule</span>

<span class="sd">        Returns:</span>
<span class="sd">            None: if rule addition is successful</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if command to add the firewall rule fails</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cmd</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">r</span><span class="s1">&#39;netsh advfirewall firewall add rule name=&quot;Allow_</span><span class="si">{0}</span><span class="s1">&quot; dir=in&#39;</span>
            <span class="sa">r</span><span class="s1">&#39; action=allow enable=yes profile=any localport=</span><span class="si">{1}</span><span class="s1"> protocol=tcp&#39;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">tunnel_port</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">tunnel_port</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">exception_message</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;Ok&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">output</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Failed to add inbound rule on windows firewall on client: &quot;</span> <span class="o">+</span>
                            <span class="n">result</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span></div>

<div class="viewcode-block" id="WindowsMachine.start_firewall"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.start_firewall">[docs]</a>    <span class="k">def</span> <span class="nf">start_firewall</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;start firewall services on the current client machine</span>

<span class="sd">        Returns:</span>
<span class="sd">            None: if firewall started successfully</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if command to start firewall service fails</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;netsh advfirewall set allprofiles state on&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">exception_message</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;Ok&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">output</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Failed to enable windows firewall on client computer: &quot;</span> <span class="o">+</span>
                            <span class="n">result</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span></div>

<div class="viewcode-block" id="WindowsMachine.remove_firewall_allow_port_rule"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.remove_firewall_allow_port_rule">[docs]</a>    <span class="k">def</span> <span class="nf">remove_firewall_allow_port_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tunnel_port</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;removes the inbound rule for the given port number</span>

<span class="sd">        Args:</span>
<span class="sd">            tunnel_port (int): port number to be removed in the inbound rule</span>

<span class="sd">        Returns:</span>
<span class="sd">            None: if rule deletion is successful</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if command to delete the firewall rule fails</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;netsh advfirewall firewall delete rule name=&quot;Allow_</span><span class="si">{0}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">tunnel_port</span><span class="p">))</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">exception_message</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Failed to delete inbound rule on windows firewall on client: &quot;</span> <span class="o">+</span>
                            <span class="n">result</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span></div>

<div class="viewcode-block" id="WindowsMachine.stop_firewall"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.stop_firewall">[docs]</a>    <span class="k">def</span> <span class="nf">stop_firewall</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;turn off firewall service on the current client machine</span>

<span class="sd">        Returns:</span>
<span class="sd">            None: firewall is turned off successfully</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if command to turn off firewall fails</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;netsh advfirewall set allprofiles state off&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">exception_message</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Failed to remove windows firewall on client computer: &quot;</span> <span class="o">+</span>
                            <span class="n">result</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span></div>

<div class="viewcode-block" id="WindowsMachine.add_firewall_machine_exclusion"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.add_firewall_machine_exclusion">[docs]</a>    <span class="k">def</span> <span class="nf">add_firewall_machine_exclusion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">machine_to_exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds given machine to firewall exclusion list. If machine details is</span>
<span class="sd">           not passed, it considers current machine and adds it to exclusion list.</span>

<span class="sd">        Args:</span>
<span class="sd">            machine_to_exclude (str): hostname or IP address to be added to</span>
<span class="sd">                firewall exclusion list</span>

<span class="sd">        Returns:</span>
<span class="sd">            None: if machine is successfully added to firewall exclusion list</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if command to add the firewall exclusion rule fails</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">machine_to_exclude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">machine_to_exclude</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostbyname</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">())</span>

        <span class="n">cmd</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;netsh advfirewall firewall add rule name=&quot;Exclude_Machine&quot; dir=in &#39;</span> \
              <span class="sa">r</span><span class="s1">&#39;action=allow remoteip=&quot;</span><span class="si">{0}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">machine_to_exclude</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">exception_message</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;Ok&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">output</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;Failed to exclude machine_to_exclude on remote client computer: &quot;</span> <span class="o">+</span>
                <span class="n">res</span><span class="o">.</span><span class="n">output</span><span class="p">)</span></div>

<div class="viewcode-block" id="WindowsMachine.remove_firewall_machine_exclusion"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.remove_firewall_machine_exclusion">[docs]</a>    <span class="k">def</span> <span class="nf">remove_firewall_machine_exclusion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">excluded_machine</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;removes given machine from firewall exclusion list. If machine details is</span>
<span class="sd">           not passed, it considers current machine and removes it from exclusion list.</span>

<span class="sd">        Args:</span>
<span class="sd">            excluded_machine (str): hostname or IP address to be removed from</span>
<span class="sd">                firewall exclusion list</span>

<span class="sd">        Returns:</span>
<span class="sd">            None: if machine is successfully removed from firewall exclusion list</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                if command to delete from firewall exclusion rule fails</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;netsh advfirewall firewall delete rule Exclude_Machine&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">exception_message</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Failed to remove automation machine from &quot;</span>
                            <span class="s2">&quot;exclusion list on remote client: &quot;</span> <span class="o">+</span>
                            <span class="n">res</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span></div>

<div class="viewcode-block" id="WindowsMachine.disconnect"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.disconnect">[docs]</a>    <span class="k">def</span> <span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Disconnects the current session with the machine.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_commvault_client</span><span class="p">:</span>
            <span class="c1"># Reset the Execution Policy of the client</span>
            <span class="n">__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_object</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;powershell.exe Set-ExecutionPolicy </span><span class="si">{self._execution_policy}</span><span class="s1"> -Force&#39;</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_local_machine</span><span class="p">:</span>
            <span class="n">__</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;powershell.exe Set-ExecutionPolicy </span><span class="si">{self._execution_policy}</span><span class="s1"> -Force&#39;</span><span class="p">,</span>
                <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span>
            <span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">WindowsMachine</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span></div>

<div class="viewcode-block" id="WindowsMachine.toggle_time_service"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.toggle_time_service">[docs]</a>    <span class="k">def</span> <span class="nf">toggle_time_service</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Toggles the state of the windows time service</span>
<span class="sd">        Args:</span>
<span class="sd">            stop:  (bool) -- If set to True will stop the service else will start the service</span>

<span class="sd">        Returns:</span>
<span class="sd">                None: if Windows time service state is toggled successfully</span>

<span class="sd">            Raises:</span>
<span class="sd">                Exception:</span>
<span class="sd">                    If Time service state was not toggled successfully</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">stop</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Stopping Time Service&quot;</span><span class="p">)</span>
            <span class="n">service_command</span> <span class="o">=</span> <span class="s2">&quot;net stop w32time;Set-Service -Name W32Time -StartupType disabled&quot;</span>
            <span class="n">expected_output</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;stopped successfully&quot;</span><span class="p">,</span> <span class="s2">&quot;not started&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting Time Service&quot;</span><span class="p">)</span>
            <span class="n">service_command</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Set-Service -Name W32Time -StartupType automatic;&quot;</span>
                               <span class="s2">&quot;net start w32time; w32tm /resync&quot;</span><span class="p">)</span>
            <span class="n">expected_output</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;started successfully&quot;</span><span class="p">,</span> <span class="s2">&quot;already been started&quot;</span><span class="p">]</span>
        <span class="n">service_output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="n">service_command</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">service_output</span><span class="o">.</span><span class="n">output</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">expected_output</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Time service could not be toggled successfully with exception: </span><span class="si">{0}</span><span class="s2">&quot;</span>
                            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">service_output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Time service operation completed successfully&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="WindowsMachine.current_time"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.current_time">[docs]</a>    <span class="k">def</span> <span class="nf">current_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timezone_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns current machine time in UTC TZ as a datetime object</span>

<span class="sd">        Args:</span>
<span class="sd">            timezone_name:  (String) -- pytz timezone to which the system time will be converted</span>
<span class="sd">                                        if not specified will return in UTC</span>

<span class="sd">        Returns:</span>
<span class="sd">                datetimeobj -- machine&#39;s current time</span>

<span class="sd">        Raises:</span>
<span class="sd">                Exception:</span>
<span class="sd">                    If not able to fetch current time</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">pytz</span> <span class="k">import</span> <span class="n">timezone</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">time_output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="s2">&quot;$a = Get-Date; &quot;</span>
                                               <span class="s2">&quot;$a.ToUniversalTime().&quot;</span>
                                               <span class="s2">&quot;ToString(</span><span class="se">\&quot;</span><span class="s2">dd-MM-yyyy HH:mm:ss</span><span class="se">\&quot;</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">current_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">time_output</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
                                                      <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%m-%Y %H:%M:%S&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">timezone_name</span> <span class="ow">and</span> <span class="n">timezone_name</span> <span class="o">!=</span> <span class="s1">&#39;UTC&#39;</span><span class="p">:</span>
                <span class="n">current_time</span> <span class="o">=</span> <span class="n">timezone</span><span class="p">(</span><span class="s1">&#39;UTC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">localize</span><span class="p">(</span><span class="n">current_time</span><span class="p">)</span>
                <span class="n">current_time</span> <span class="o">=</span> <span class="n">current_time</span><span class="o">.</span><span class="n">astimezone</span><span class="p">(</span><span class="n">timezone</span><span class="p">(</span><span class="n">timezone_name</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">current_time</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Current Time could not be fetched with exception: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span>
                            <span class="nb">format</span><span class="p">(</span><span class="n">time_output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">))</span></div>

<div class="viewcode-block" id="WindowsMachine.scan_directory"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.scan_directory">[docs]</a>    <span class="k">def</span> <span class="nf">scan_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Scans the directory and returns a list of items under it along with its properties</span>

<span class="sd">            Args:</span>
<span class="sd">                path            (str)           Path of directory to scan</span>

<span class="sd">            Returns:</span>
<span class="sd">                list    -       List of items under the directory with each item being a</span>
<span class="sd">                dictionary of item properties</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">scanned_items</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">script_arguments</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">path</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">SCAN_DIRECTORY</span>

        <span class="n">scan_test_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">script_arguments</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">scan_test_data</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">scan_test_data</span><span class="p">)</span>

        <span class="n">items</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="n">i_props</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">i_props</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s1">&#39;Some properties are missing for item [</span><span class="si">{0}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i_props</span><span class="p">)))</span>

            <span class="n">scanned_items</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">i_props</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">i_props</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">i_props</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                <span class="s1">&#39;mtime&#39;</span><span class="p">:</span> <span class="n">i_props</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="p">})</span>

        <span class="k">return</span> <span class="n">scanned_items</span></div>

<div class="viewcode-block" id="WindowsMachine.get_file_attributes"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.get_file_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">get_file_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the attributes of a file on the client.</span>

<span class="sd">            Args:</span>
<span class="sd">                file_path   (str)   --  path of the file to get the size of</span>

<span class="sd">            Returns:</span>
<span class="sd">                string   -   file attributes info</span>

<span class="sd">            Raises:</span>
<span class="sd">                Exception(Exception_Code, Exception_Message):</span>
<span class="sd">                    if failed to get the size of the file</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">script</span> <span class="o">=</span> <span class="n">GET_FILE_ATTRIBUTES</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;FilePath&#39;</span><span class="p">:</span> <span class="n">file_path</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">get_file_attributes_script</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_script_generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">get_file_attributes_script</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">get_file_attributes_script</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception_message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">exception_code</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">formatted_output</span></div>

<div class="viewcode-block" id="WindowsMachine.get_acl_list"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.get_acl_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_acl_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_path</span><span class="p">,</span> <span class="n">sorted_output</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the list of acl of items from the machine on a give path</span>

<span class="sd">              Args:</span>
<span class="sd">                 data_path     (str)   -- data folder path to get the acl list</span>

<span class="sd">                 sorted_output (bool)  --  to specify whether</span>
<span class="sd">                                           the acl list should be sorted.</span>
<span class="sd">                                           default is True</span>
<span class="sd">                                           mean the output result is sorted</span>
<span class="sd">             Returns:</span>
<span class="sd">                 list    -   list of acl of items</span>

<span class="sd">             Raises:</span>
<span class="sd">                 Exception:</span>
<span class="sd">                     if any error occurred while getting the acl of items.</span>
<span class="sd">         &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">acl_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_test_data_info</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">acls</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">acl_list</span> <span class="o">=</span> <span class="n">acl_data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">while</span> <span class="s1">&#39;&#39;</span> <span class="ow">in</span> <span class="n">acl_list</span><span class="p">:</span>
                <span class="n">acl_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">sorted_output</span><span class="p">:</span>
                <span class="n">acl_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">acl_list</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;Error occurred at getting ACL from machine </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">excp</span><span class="p">))</span></div>

<div class="viewcode-block" id="WindowsMachine.compare_acl"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.compare_acl">[docs]</a>    <span class="k">def</span> <span class="nf">compare_acl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_path</span><span class="p">,</span> <span class="n">destination_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compares the acl of source path with destination path</span>
<span class="sd">             and checks if they are same.</span>

<span class="sd">              Args:</span>
<span class="sd">                 source_path         (str)  -- source path to compare</span>

<span class="sd">                 destination_path    (str)  -- destination path to compare</span>

<span class="sd">            Returns:</span>
<span class="sd">                 bool, str   -   Returns True</span>
<span class="sd">                                  if acls of source and destination are same</span>
<span class="sd">                                 diff output between source and destination</span>
<span class="sd">            Raises:</span>
<span class="sd">                 Exception:</span>
<span class="sd">                     if any error occurred while comparing the acl of paths.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">source_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_acl_list</span><span class="p">(</span><span class="n">source_path</span><span class="p">)</span>
            <span class="n">destination_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_acl_list</span><span class="p">(</span><span class="n">destination_path</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compare_lists</span><span class="p">(</span><span class="n">source_list</span><span class="p">,</span> <span class="n">destination_list</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s1">&#39;Error occurred while comparing the acls: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">excp</span><span class="p">))</span></div>

<div class="viewcode-block" id="WindowsMachine.is_stub"><a class="viewcode-back" href="../../../Automation.AutomationUtils.html#Automation.AutomationUtils.windows_machine.WindowsMachine.is_stub">[docs]</a>    <span class="k">def</span> <span class="nf">is_stub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function will windows file&#39;s attributes</span>
<span class="sd">        to check whether file is stub</span>
<span class="sd">        Args:</span>

<span class="sd">            log : log instance</span>
<span class="sd">            file_name (str): file full name</span>
<span class="sd">        Return: True is the file is stub otherwise return False</span>
<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                    if error occured</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_stub_file_attributes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;OFFLINE&#39;</span><span class="p">,</span> <span class="s1">&#39;SPARSEFILE&#39;</span><span class="p">,</span> <span class="s1">&#39;REPARSEPOINT&#39;</span><span class="p">])</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_ret_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file_attributes</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
            <span class="n">_ret_val_list</span> <span class="o">=</span> <span class="n">_ret_val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\r\n&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
            <span class="n">_washed_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">_each_item</span> <span class="ow">in</span> <span class="n">_ret_val_list</span><span class="p">:</span>
                <span class="n">_washed_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_each_item</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>

            <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">_stub_file_attributes</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">_washed_list</span><span class="p">)))</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;exception raised on with error </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">excp</span><span class="p">))</span></div></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Commvault Systems Inc..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
    </div>

    

    
  </body>
</html>