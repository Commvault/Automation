

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Web.AdminConsole.AdminConsolePages.Plans &mdash; Commvault Automation 11.24 documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home" alt="Documentation Home"> Commvault Automation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"></div>
            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Commvault Automation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
      <li>Web.AdminConsole.AdminConsolePages.Plans</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for Web.AdminConsole.AdminConsolePages.Plans</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># --------------------------------------------------------------------------</span>
<span class="c1"># Copyright Commvault Systems, Inc.</span>
<span class="c1"># See LICENSE.txt in the project root for</span>
<span class="c1"># license information.</span>
<span class="c1"># --------------------------------------------------------------------------</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module provides the function or operations that can be performed on the</span>
<span class="sd">plans page on the AdminConsole</span>

<span class="sd">Class:</span>

<span class="sd">    Plans() -&gt; AdminPage() -&gt; AdminConsoleBase() -&gt; object</span>

<span class="sd">Functions:</span>

<span class="sd">    _add_replication_details()                      --  add replication details</span>
<span class="sd">    _select_entities()                              --  Selects Entities Needed For a</span>
<span class="sd">                                                        Data Classification Plan</span>
<span class="sd">    _deselect_entities()                            --  Delects Entities For a given</span>
<span class="sd">                                                        Data Classification Plan</span>
<span class="sd">    _click_create_index_server()                    --  Clicks the create index server button</span>
<span class="sd">    create_replication_plan()                       --  creates backup and replication plan</span>
<span class="sd">    create_data_classification_plan()               --  Creates a Data Classification plan</span>
<span class="sd">    edit_data_classification_plan()                 --  Edit a given data classification</span>
<span class="sd">                                                         plan and add/remove the given entities</span>
<span class="sd">    deselect_entities_in_data_classification_plan() --  Deselects all entities</span>
<span class="sd">                                                         in a given data classification plan</span>
<span class="sd">    action_delete_plan()                            --  deletes the plan with the given name</span>
<span class="sd">    list_plans()                                    --  lists all the plans</span>
<span class="sd">    select_plan()                                   --  selects the plan</span>
<span class="sd">    create_server_plan()                            --  create server plan by entering necessary data</span>
<span class="sd">    create_laptop_plan()                            --  create laptop plan by entering necessary data</span>
<span class="sd">    delete_plan                                     --  deletes the plans given in the dictionary</span>
<span class="sd">    create_laptop_derived_plan()                    --  create laptop derived plan by entering necessary data</span>
<span class="sd">    create_archive_plan()                           --  Method to create Archival plan</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support.ui</span> <span class="kn">import</span> <span class="n">Select</span>
<span class="kn">from</span> <span class="nn">Web.Common.page_object</span> <span class="kn">import</span> <span class="p">(</span><span class="n">WebAction</span><span class="p">,</span> <span class="n">PageService</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">Web.AdminConsole.Components.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span> <span class="nn">Web.AdminConsole.Components.panel</span> <span class="kn">import</span> <span class="n">ModalPanel</span><span class="p">,</span> <span class="n">DropDown</span>
<span class="kn">from</span> <span class="nn">Web.AdminConsole.GovernanceAppsPages.GovernanceApps</span> <span class="kn">import</span> <span class="n">GovernanceApps</span>


<div class="viewcode-block" id="Plans"><a class="viewcode-back" href="../../../../source/Web.AdminConsole.AdminConsolePages.html#Web.AdminConsole.AdminConsolePages.Plans.Plans">[docs]</a><span class="k">class</span> <span class="nc">Plans</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Class for the Plans page &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">admin_console</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to initiate Plans class</span>

<span class="sd">        Args:</span>
<span class="sd">            admin_console   (Object) :   admin console object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span> <span class="o">=</span> <span class="n">admin_console</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">driver</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">_load_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">log</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__modal_panel</span> <span class="o">=</span> <span class="n">ModalPanel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__drop_down</span> <span class="o">=</span> <span class="n">DropDown</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__governance_apps</span> <span class="o">=</span> <span class="n">GovernanceApps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">_check_if_entity_selected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entity</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if the entity is already selected</span>

<span class="sd">            Args:</span>
<span class="sd">                entity (list)   :   List of entities</span>
<span class="sd">                    Example Values:</span>
<span class="sd">                        &quot;Credit card number&quot;,</span>
<span class="sd">                        &quot;Social Security number&quot;,</span>
<span class="sd">                        &quot;Email&quot;</span>
<span class="sd">            Returns:</span>
<span class="sd">                True if entity already selected</span>
<span class="sd">                False if entity not selected</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">check_if_entity_exists</span><span class="p">(</span>
            <span class="s2">&quot;xpath&quot;</span><span class="p">,</span> <span class="s2">&quot;//cv-entity-multi-select//label[text() = &#39;</span><span class="si">%s</span><span class="s2">&#39;]</span><span class="se">\</span>
<span class="s2">            /preceding-sibling::input[@checked=&#39;checked&#39;]&quot;</span> <span class="o">%</span> <span class="n">entity</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__enable_entity_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enable Entity selection checkbox while DC plan creation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//label[text()=&#39;Entity detection&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">_expand_classification</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Expands the classification accordion&quot;&quot;&quot;</span>
        <span class="n">accordion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;//div[contains(@class,&#39;cv-accordion&#39;)]/*//span[contains(text(),&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.classification&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;)]&quot;</span><span class="p">)</span>
        <span class="n">accordion</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">_select_entities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entities_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects Entities Needed For a Data Classification Plan</span>

<span class="sd">            Args:</span>
<span class="sd">                entities_list (list)   :   List of entities</span>
<span class="sd">                    Example Values:</span>
<span class="sd">                        &quot;Credit card number&quot;,</span>
<span class="sd">                        &quot;Social Security number&quot;,</span>
<span class="sd">                        &quot;Email&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="n">entities_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_if_entity_selected</span><span class="p">(</span><span class="n">entity</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                    <span class="s2">&quot;//cv-entity-multi-select//label[text() = &#39;</span><span class="si">%s</span><span class="s2">&#39;]&quot;</span> <span class="o">%</span> <span class="n">entity</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Entity: </span><span class="si">%s</span><span class="s2"> already selected&quot;</span> <span class="o">%</span> <span class="n">entity</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">_deselect_entities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entities_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deselects Entities For a Given Data Classification Plan</span>

<span class="sd">            Args:</span>
<span class="sd">                entities_list (list)   :   List of entities</span>
<span class="sd">                    Example Values:</span>
<span class="sd">                        &quot;Credit card number&quot;,</span>
<span class="sd">                        &quot;Social Security number&quot;,</span>
<span class="sd">                        &quot;Email&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="n">entities_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_if_entity_selected</span><span class="p">(</span><span class="n">entity</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                    <span class="s2">&quot;//cv-entity-multi-select//label[text() = &#39;</span><span class="si">%s</span><span class="s2">&#39;]&quot;</span> <span class="o">%</span> <span class="n">entity</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Entity: </span><span class="si">%s</span><span class="s2"> already deselected&quot;</span> <span class="o">%</span> <span class="n">entity</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">backup_window_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">not_run_interval</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Edits the backup window time slot based on the input given</span>

<span class="sd">        Args:</span>
<span class="sd">            not_run_interval    (dict)   --  the time slots when the backup should not be run</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_link_text</span><span class="p">(</span><span class="s2">&quot;Clear&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">not_run_interval</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">days</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Monday&#39;</span><span class="p">,</span> <span class="s1">&#39;Tuesday&#39;</span><span class="p">,</span> <span class="s1">&#39;Wednesday&#39;</span><span class="p">,</span> <span class="s1">&#39;Thursday&#39;</span><span class="p">,</span> <span class="s1">&#39;Friday&#39;</span><span class="p">,</span> <span class="s1">&#39;Saturday&#39;</span><span class="p">,</span> <span class="s1">&#39;Sunday&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="n">days</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;//a[text()=&#39;&quot;</span> <span class="o">+</span> <span class="n">day</span> <span class="o">+</span> <span class="s2">&quot;&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">day</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                <span class="n">slot_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_elements_by_xpath</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;//a[text()=&#39;</span><span class="si">{</span><span class="n">day</span><span class="si">}</span><span class="s2">&#39;]/../../td&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="n">slot_values</span><span class="p">:</span>
                    <span class="n">class_name</span> <span class="o">=</span> <span class="n">slot</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">class_name</span> <span class="o">!=</span> <span class="s1">&#39;label-day&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">slot</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;date-time-id&#39;</span><span class="p">))</span> <span class="ow">in</span> <span class="n">not_run_interval</span><span class="p">[</span><span class="n">day</span><span class="p">]:</span>
                            <span class="k">if</span> <span class="s1">&#39;selected&#39;</span> <span class="ow">in</span> <span class="n">class_name</span><span class="p">:</span>
                                <span class="n">slot</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">_click_create_index_server</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks the create index server button&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Clicking create index server button&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_class_name</span><span class="p">(</span><span class="s2">&quot;k-i-plus-outline&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">create_data_classification_plan</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">plan</span><span class="p">,</span> <span class="n">index_server</span><span class="p">,</span> <span class="n">content_analyzer</span><span class="p">,</span> <span class="n">entities_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">select_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">content_search</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metadata_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">content_analysis</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">enable_ocr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">target_app</span><span class="o">=</span><span class="s1">&#39;gdpr&#39;</span><span class="p">,</span>
            <span class="n">create_index_server</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">node_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index_directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">classifier_list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a Data Classification plan</span>

<span class="sd">            Args:</span>
<span class="sd">                plan (str)           :   Name of the plan to be created</span>
<span class="sd">                index_server (str)        :   Index Server name</span>
<span class="sd">                content_analyzer (str)      :   Content Analyzer name</span>
<span class="sd">                entities_list (list)   :   List of entities</span>
<span class="sd">                    Values:</span>
<span class="sd">                        &quot;Credit card number&quot;,</span>
<span class="sd">                        &quot;Social Security number&quot;,</span>
<span class="sd">                        &quot;Email&quot;</span>
<span class="sd">                select_all (bool)   :   True/False to select all entities</span>
<span class="sd">                content_search (bool)    : True/False to enable content search</span>
<span class="sd">                metadata_only (bool)    : True to select Metadata.</span>
<span class="sd">                                          False to select both Metadata and content</span>
<span class="sd">                content_analysis (bool)    : True/False to enable content analysis for Case Manager</span>
<span class="sd">                enable_ocr (bool)    : True/False to enable</span>
<span class="sd">                                            content extraction from scanned docs for SDG</span>
<span class="sd">                target_app (str)     :    The target app for the plan to be created for.</span>
<span class="sd">                                        Default is gdpr</span>
<span class="sd">                    Values:</span>
<span class="sd">                        &quot;gdpr&quot;(default),</span>
<span class="sd">                        &quot;casemanager&quot;,</span>
<span class="sd">                        &quot;fso&quot;</span>
<span class="sd">                create_index_server (bool)  :   True if new index server has to be created</span>
<span class="sd">                                                False if existing index server to use</span>
<span class="sd">                node_name   (str)           :   Index server node name for new index server</span>
<span class="sd">                index_directory (str)       :   Index directory for the new index server</span>
<span class="sd">                classifier_list (list)      :   list of classifier to be selected</span>

<span class="sd">            &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating data classification plan with name: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">plan</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_link_text</span><span class="p">(</span><span class="s2">&quot;Create plan&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_link_text</span><span class="p">(</span><span class="s2">&quot;Data classification&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">target_app</span> <span class="o">==</span> <span class="s1">&#39;casemanager&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__governance_apps</span><span class="o">.</span><span class="n">select_case_manager</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">target_app</span> <span class="o">==</span> <span class="s1">&#39;fso&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__governance_apps</span><span class="o">.</span><span class="n">select_file_storage_optimization</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__governance_apps</span><span class="o">.</span><span class="n">select_sensitive_data_analysis</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Entering plan name&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;planName&quot;</span><span class="p">,</span> <span class="n">plan</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">create_index_server</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating Index Server with node: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">node_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_click_create_index_server</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Filling in Index server name&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;newIndexServerName&quot;</span><span class="p">,</span> <span class="n">index_server</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Selecting index server node name&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__drop_down</span><span class="o">.</span><span class="n">select_drop_down_values</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="n">node_name</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Filling in Index directory&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="n">node_name</span><span class="p">,</span> <span class="n">index_directory</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__modal_panel</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Selecting Index Server&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__drop_down</span><span class="o">.</span><span class="n">select_drop_down_values</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="n">index_server</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">target_app</span> <span class="o">!=</span> <span class="s1">&#39;fso&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">target_app</span> <span class="o">==</span> <span class="s1">&#39;casemanager&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">button_next</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">content_analysis</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Clicking on Enabling Entity detection&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__enable_entity_detection</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">content_analysis</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Selecting content analyzer&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__drop_down</span><span class="o">.</span><span class="n">select_drop_down_values</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">content_analyzer</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">select_all</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_select_entities</span><span class="p">([</span><span class="s1">&#39;Select all&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_select_entities</span><span class="p">(</span><span class="n">entities_list</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">classifier_list</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_expand_classification</span><span class="p">()</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__drop_down</span><span class="o">.</span><span class="n">select_drop_down_values</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">classifier_list</span><span class="p">,</span> <span class="n">default_unselect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">target_app</span> <span class="o">==</span> <span class="s1">&#39;gdpr&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">button_next</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">enable_ocr</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">enable_toggle</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cv_toggle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">submit_form</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">edit_data_classification_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plan</span><span class="p">,</span> <span class="n">entities_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Edit a given data classification plan and add/remove the given entities</span>
<span class="sd">        :param plan    (str)   --  Plan name to be edited</span>
<span class="sd">        :param entities_list    (list)    -- Entities list to be added or removed in the plan</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Click Edit in plan &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="n">plan</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//*[@title=&#39;Entity detection&#39;]//a[contains(text(),&#39;Edit&#39;)]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_select_entities</span><span class="p">(</span><span class="n">entities_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Clicking on Save after the selection of the entities&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">submit_form</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">deselect_entities_in_data_classification_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plan</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deselects all entities in a given data classification plan</span>
<span class="sd">        :param plan    (str)   --  Plan name from which entities will be deselcted</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Click Edit in plan &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="n">plan</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//*[@title=&#39;Entity detection&#39;]//a[contains(text(),&#39;Edit&#39;)]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_deselect_entities</span><span class="p">([</span><span class="s1">&#39;Select all&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__modal_panel</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">action_delete_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plan</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes the plan with the given name</span>
<span class="sd">            plan    :   a string, the name of the plan to be deleted</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">access_action_item</span><span class="p">(</span><span class="n">plan</span><span class="p">,</span> <span class="s2">&quot;Delete&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">click_button</span><span class="p">(</span><span class="s1">&#39;Yes&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">check_error_message</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">list_plans</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Lists all the plans</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plans_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">get_table_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;The list of all plan details is </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">plans_dict</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">plans_dict</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">select_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plan</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects the given plan</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">access_link</span><span class="p">(</span><span class="n">plan</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__set_plan_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plan_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set plan name</span>
<span class="sd">        Args:</span>
<span class="sd">            plan_name (str) : name of the plan</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;planName&quot;</span><span class="p">,</span> <span class="n">plan_name</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__open_edit_backup_window_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to open edit backup window dialog &quot;&quot;&quot;</span>
        <span class="n">edit_backup_window_link</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//cv-backup-window-list[@data-cv-model=&#39;globalTemplate.backupWindow&#39;]&quot;</span><span class="p">)</span>
        <span class="n">edit_backup_window_link</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__open_edit_full_backup_window_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to open edit backup window dialog &quot;&quot;&quot;</span>
        <span class="n">edit_full_backup_window_link</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//cv-backup-window-list[@data-cv-model=&#39;globalTemplate.fullBackupWindow&#39;]&quot;</span><span class="p">)</span>
        <span class="n">edit_full_backup_window_link</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__set_backup_window</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backup_day</span><span class="p">,</span> <span class="n">backup_time</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set back up window</span>
<span class="sd">        Args:</span>
<span class="sd">            backup_day (dict): dictionary containing values of backup days for backup window</span>
<span class="sd">                Eg.- dict.fromkeys([&#39;1&#39;, &#39;2&#39;, &#39;3&#39;], 1)</span>
<span class="sd">                        backup days for schedule</span>
<span class="sd">                            1 : Monday</span>
<span class="sd">                            2: Tuesday and so on</span>
<span class="sd">            backup_time (dict): dictionary containing values of backup time for backup window</span>
<span class="sd">                Eg.- dict.fromkeys([&#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;], 1)</span>
<span class="sd">                    backup time for schedule</span>
<span class="sd">                        2 : 12:00am to 1:00 am</span>
<span class="sd">                        3 : 1:00am to 2:00 am</span>
<span class="sd">                        and so on..</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">select_hyperlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;action.clear&#39;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">key_day</span><span class="p">,</span> <span class="n">val_day</span> <span class="ow">in</span> <span class="n">backup_day</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">val_day</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">key_time</span><span class="p">,</span> <span class="n">val_time</span> <span class="ow">in</span> <span class="n">backup_time</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">val_time</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;//table[@class=&#39;time-obj&#39;]/tbody/tr[</span><span class="si">{</span><span class="n">key_day</span><span class="si">}</span><span class="s2">]/td[</span><span class="si">{</span><span class="n">key_time</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;//*[@id=&#39;editPlanOperationWindowModal_button_#4242&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">check_error_message</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__open_edit_storage_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to set primary storage of a plan &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//cv-grid//a[contains(@class,&#39;uib-dropdown-toggle&#39;)]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;//a[contains(text(),&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;action.edit&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;)]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__set_retention_period</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ret_period</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set retention period</span>

<span class="sd">        Args:</span>
<span class="sd">            ret_period (str) : Value of retention period</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">textbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//input[@data-ng-change=&#39;changePolicyRetention()&#39;]&quot;</span><span class="p">)</span>
        <span class="n">textbox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">textbox</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">ret_period</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__set_retention_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ret_unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set retention unit</span>

<span class="sd">        Args:</span>
<span class="sd">            ret_unit (str) : retention unit to be set</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">retention_unit</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//select[@data-ng-change=&#39;changePolicyRetention()&#39;]&quot;</span><span class="p">))</span>
        <span class="n">retention_unit</span><span class="o">.</span><span class="n">select_by_visible_text</span><span class="p">(</span><span class="n">ret_unit</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__set_rpo_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rpo_unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set unit for RPO</span>

<span class="sd">        Args:</span>
<span class="sd">            rpo_unit (str): RPO Unit to be set</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">frequency_unit</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//select[@data-ng-model=&#39;incrementalBackupFreq.type&#39;]&quot;</span><span class="p">))</span>
        <span class="n">frequency_unit</span><span class="o">.</span><span class="n">select_by_visible_text</span><span class="p">(</span><span class="n">rpo_unit</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__set_rpo_hours</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rpo_hours</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set hours for Backup Start Time for RPO</span>

<span class="sd">        Args:</span>
<span class="sd">            rpo_hours (str):    Value of hour to be set</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">textbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//input[@ng-change=&#39;updateHours()&#39;]&quot;</span><span class="p">)</span>
        <span class="n">textbox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">textbox</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">rpo_hours</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__set_rpo_minutes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rpo_minutes</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set minutes for Backup Start Time for RPO</span>

<span class="sd">        Args:</span>
<span class="sd">            rpo_minutes (str):  Value of minutes to be set</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">textbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//input[@ng-change=&#39;updateMinutes()&#39;]&quot;</span><span class="p">)</span>
        <span class="n">textbox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">textbox</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">rpo_minutes</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__set_am_or_pm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">am_or_pm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set whether AM/PM for Backup Start Time under RPO</span>

<span class="sd">        Args:</span>
<span class="sd">            am_or_pm (str): Whether AM/PM</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">am_or_pm</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;AM&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                <span class="s2">&quot;//button[@ng-click=&#39;toggleMeridian()&#39;]&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__click_plan_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plan_type_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to select type of plan to be created from create plan option menu</span>

<span class="sd">        Args:</span>
<span class="sd">            plan_type_id (str) : id of the plan type to be selected</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;//div[@class=&#39;k-animation-container&#39;]//a[@id=&#39;</span><span class="si">{</span><span class="n">plan_type_id</span><span class="si">}</span><span class="s2">&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__expand_sub_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub_panel_text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to expand sub panel &quot;&quot;&quot;</span>
        <span class="n">panel_xpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;//span[contains(text(),&#39;</span><span class="si">{</span><span class="n">sub_panel_text</span><span class="si">}</span><span class="s2">&#39;)]&quot;</span><span class="p">)</span>
        <span class="n">panel_xpath</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__select_file_system_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_system</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to select file system &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//ul[@class=&#39;nav nav-tabs nav-justified&#39;]//a[contains(text(),</span><span class="se">\</span>
<span class="s2">            &#39;&quot;</span> <span class="o">+</span> <span class="n">file_system</span> <span class="o">+</span> <span class="s2">&quot;&#39;)]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__set_sla_hours</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sla_hours</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to set sla hours &quot;&quot;&quot;</span>
        <span class="n">elems</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_elements_by_id</span><span class="p">(</span><span class="s2">&quot;logSlaHours&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elems</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">is_displayed</span><span class="p">():</span>
                <span class="n">elem</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="n">elem</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">sla_hours</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__set_sla_minutes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sla_minutes</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to set sla minutes &quot;&quot;&quot;</span>
        <span class="n">elems</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_elements_by_id</span><span class="p">(</span><span class="s2">&quot;logSlaMinutes&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elems</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">is_displayed</span><span class="p">():</span>
                <span class="n">elem</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="n">elem</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">sla_minutes</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__enable_allow_override</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to set allow over ride check box state &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                <span class="s2">&quot;//label[contains(@for,&#39;derivation-enabled&#39;)]/preceding-sibling::input&quot;</span><span class="p">)</span>\
                <span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;checked&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;checked&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                <span class="s2">&quot;//label[contains(@for,&#39;derivation-enabled&#39;)]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__select_override_backup_content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to select the overide backup content&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                <span class="s2">&quot;//label[contains(text(),&#39;Override base settings&#39;)]&quot;</span><span class="p">)</span>\
                <span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;checked&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;checked&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;//label[contains(text(),&#39;Override base settings&#39;)]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__select_override_retention</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to select the overide backup content&quot;&quot;&quot;</span>
        <span class="n">xpath</span> <span class="o">=</span> <span class="s2">&quot;//div[@class=&#39;bootstrap-wrapper ng-scope&#39;]/div/div/div/label[@class=&#39;override-toggle-label&#39;]&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;checked&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;checked&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__select_override_storage_rpo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">overrid_checkbox_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to select the overide backup content&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;//div[@id=&#39;</span><span class="si">{</span><span class="n">overrid_checkbox_id</span><span class="si">}</span><span class="s2">&#39;]//label[@class=&#39;override-toggle-label&#39;]&quot;</span><span class="p">)</span>\
                    <span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;checked&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;checked&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;//div[@id=&#39;</span><span class="si">{</span><span class="n">overrid_checkbox_id</span><span class="si">}</span><span class="s2">&#39;]//label[@class=&#39;override-toggle-label&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__set_override_option</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">override_drop_down_id</span><span class="p">,</span> <span class="n">override_value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to set override option &quot;&quot;&quot;</span>
        <span class="n">override_drop_down</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;//select[contains(@id,&#39;</span><span class="si">{</span><span class="n">override_drop_down_id</span><span class="si">}</span><span class="s2">&#39;)]&quot;</span><span class="p">))</span>
        <span class="n">override_drop_down</span><span class="o">.</span><span class="n">select_by_visible_text</span><span class="p">(</span><span class="n">override_value</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__click_browse_button</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to click on browse button &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s2">&quot;generalSetup_button_#6532&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__select_browse_root</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to select Browse root  &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//span[@class=&#39;path-title ng-binding&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__click_new_folder_button</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to click on New folder button &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//*[@id=&#39;machineBrowse_button_#5674&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__create_index_server</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to create index server &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__click_browse_button</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__select_browse_root</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__click_new_folder_button</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s1">&#39;folder-name&#39;</span><span class="p">,</span> <span class="s2">&quot;IndexServer&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__modal_panel</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">click_button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.save&#39;</span><span class="p">])</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__enable_secondary_storage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to enable secondary storage for laptop plan &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                <span class="s2">&quot;//input[@id=&#39;enableSecondaryStorage&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_selected</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                <span class="s2">&quot;//label[@for=&#39;enableSecondaryStorage&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__select_radio_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radio_button_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to select radio button based on id &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="n">radio_button_id</span><span class="p">)</span><span class="o">.</span><span class="n">is_selected</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="n">radio_button_id</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__select_checkbox_by_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to select checkbox by label &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;//label[text()=&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&#39;]/preceding-sibling::input&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_selected</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;//label[text()=&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__click_next_button</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to click next button on Laptop plan creation page &quot;&quot;&quot;</span>
        <span class="n">next_buttons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_elements_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//div[contains(@class,&#39;button-container&#39;)]/button[contains(text(),&#39;Next&#39;)]&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">next_button</span> <span class="ow">in</span> <span class="n">next_buttons</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">next_button</span><span class="o">.</span><span class="n">is_displayed</span><span class="p">():</span>
                <span class="n">next_button</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                <span class="k">break</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__setup_edge_drive_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                    <span class="n">allowed_features</span><span class="p">,</span>
                                    <span class="n">media_agent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to setup edge drive features</span>

<span class="sd">        Args:</span>
<span class="sd">            allowed_features (dictionary): dictionary containing features to be enabled for the</span>
<span class="sd">                             plan and corresponding attributes</span>
<span class="sd">                Eg. - allowed_features = {&#39;Edge Drive&#39;: &#39;ON&#39;,</span>
<span class="sd">                                          &#39;audit_drive_operations&#39;: True,</span>
<span class="sd">                                          &#39;notification_for_shares&#39;: True,</span>
<span class="sd">                                          &#39;edge_drive_quota&#39;:&#39;200&#39;,</span>
<span class="sd">                                          &#39;DLP&#39;: &#39;ON&#39;,</span>
<span class="sd">                                          &#39;Archiving&#39;: &#39;ON&#39;}</span>

<span class="sd">            media_agent (string)    :   media agent to be used to configure edge drive for plan</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">check_if_entity_exists</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;client&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">select_value_from_dropdown</span><span class="p">(</span><span class="s1">&#39;client&#39;</span><span class="p">,</span> <span class="n">media_agent</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">select_value_from_dropdown</span><span class="p">(</span><span class="s1">&#39;mediaAgent&#39;</span><span class="p">,</span> <span class="n">media_agent</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">check_if_entity_exists</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;mountPath&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__create_index_server</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">allowed_features</span><span class="p">[</span><span class="s1">&#39;audit_drive_operations&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_select</span><span class="p">(</span><span class="s1">&#39;auditDriveActivities&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_deselect</span><span class="p">(</span><span class="s1">&#39;auditDriveActivities&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">allowed_features</span><span class="p">[</span><span class="s1">&#39;notification_for_shares&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_select</span><span class="p">(</span><span class="s1">&#39;enableNotificationsForShares&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_deselect</span><span class="p">(</span><span class="s1">&#39;enableNotificationsForShares&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">allowed_features</span><span class="p">[</span><span class="s1">&#39;edge_drive_quota&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_select</span><span class="p">(</span><span class="s1">&#39;isEdgeDriveQuotaEnabled&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;edgeDriveQuota&quot;</span><span class="p">,</span> <span class="n">allowed_features</span><span class="p">[</span><span class="s1">&#39;edge_drive_quota&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_deselect</span><span class="p">(</span><span class="s1">&#39;isEdgeDriveQuotaEnabled&#39;</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__click_remove_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tab_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to click on remove all content button</span>

<span class="sd">        Args:</span>
<span class="sd">            tab_id (str) : id of backup/exclusion content tab</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">remove_button</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;//div[@class=&#39;tab-pane ng-scope active&#39;]//div[@id=&#39;</span><span class="si">{</span><span class="n">tab_id</span><span class="si">}</span><span class="s2">&#39;]&quot;</span> \
                        <span class="s2">&quot;//a[contains(@data-ng-click,&#39;deleteAll&#39;)]&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">check_if_entity_exists</span><span class="p">(</span><span class="s2">&quot;xpath&quot;</span><span class="p">,</span> <span class="n">remove_button</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">remove_button</span><span class="p">)</span><span class="o">.</span><span class="n">is_displayed</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">remove_button</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__click_add_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tab_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to click on add content button</span>

<span class="sd">        Args:</span>
<span class="sd">            tab_id (str) : id of backup/exclusion content tab</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">add_button</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;//div[@class=&#39;tab-pane ng-scope active&#39;]//div[@id=&#39;</span><span class="si">{</span><span class="n">tab_id</span><span class="si">}</span><span class="s2">&#39;]&quot;</span> \
                     <span class="s2">&quot;//a[contains(text(),&#39;Add&#39;)]&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">add_button</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__select_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                         <span class="n">content</span><span class="p">,</span>
                         <span class="n">content_library</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to select backup/exclusion content</span>

<span class="sd">        Args:</span>
<span class="sd">            content (list) : List with folder names to be selected</span>
<span class="sd">                            for content backup</span>
<span class="sd">                Eg. - content_backup:[&quot;Content Library&quot;, &quot;Documents&quot;, &quot;Desktop&quot;,</span>
<span class="sd">                                        &quot;Office&quot;, &quot;Music&quot;, &quot;Pictures&quot;, &quot;Videos&quot;]</span>
<span class="sd">            content_library (list): List with content library values to be</span>
<span class="sd">                            selected for backup</span>
<span class="sd">                Eg. - content_library = [&#39;Content Library&#39;, &#39;GoogleDrive&#39;, &#39;Image&#39;,</span>
<span class="sd">                                         &#39;Office&#39;, &#39;OneDrive&#39;, &#39;System&#39;,</span>
<span class="sd">                                        &#39;Temporary Files&#39;, &#39;Text&#39;,</span>
<span class="sd">                                        &#39;Thumbnail Supported&#39;, &#39;Video&#39;,</span>
<span class="sd">                                        &#39;iCloudDrive&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;Content Library&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                        <span class="s2">&quot;//label[@for=&#39;&quot;</span> <span class="o">+</span> <span class="n">value</span> <span class="o">+</span> <span class="s2">&quot;&#39;]/../..//input&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_selected</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                        <span class="s2">&quot;//label[@for=&#39;&quot;</span> <span class="o">+</span> <span class="n">value</span> <span class="o">+</span> <span class="s2">&quot;&#39;]/../..//input&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;Library&#39;</span><span class="p">:</span>
                        <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">check_if_entity_exists</span><span class="p">(</span>
                        <span class="s2">&quot;xpath&quot;</span><span class="p">,</span> <span class="s2">&quot;//li[@class=&#39;ivh-treeview-node ng-scope ng-isolate-scope &quot;</span>
                                 <span class="s2">&quot;ivh-treeview-node-collapsed&#39;]&quot;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                        <span class="s2">&quot;//li[@class=&#39;ivh-treeview-node ng-scope ng-isolate-scope ivh-treeview&quot;</span>
                        <span class="s2">&quot;-node-collapsed&#39;]//span[@class=&#39;glyphicon glyphicon-chevron-right&#39;]&quot;</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">value_lib</span> <span class="ow">in</span> <span class="n">content_library</span><span class="p">:</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                                <span class="s2">&quot;//label[@for=&#39;&quot;</span> <span class="o">+</span> <span class="n">value</span> <span class="o">+</span> <span class="s2">&quot;&#39;]/../..//input&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_selected</span><span class="p">():</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                                <span class="s2">&quot;//label[@for=&#39;&quot;</span> <span class="o">+</span> <span class="n">value_lib</span> <span class="o">+</span> <span class="s2">&quot;&#39;]/../..//input&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__click_add_custom_content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to click on add custom content link &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//a[contains(text(),&#39;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.customContent&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&#39;)]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__click_create_derived_plan_button</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to click on derive plan&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//a[@id=&#39;actionDetail_DERIVE_PLAN_ENTITY&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__select_file_size_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_size_unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to select File Size Unit &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//select[@ng-model=&#39;fileSizeConfig.rule&#39;]/option[text()=&#39;</span><span class="si">{}</span><span class="s2">&#39;]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">file_size_unit</span><span class="p">))</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__select_last_modified_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">last_modified_unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to select Last Modified Unit &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//select[@ng-model=&#39;fileTimestampConfig.timestampRule&#39;]/option[text()=&#39;</span><span class="si">{}</span><span class="s2">&#39;]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">last_modified_unit</span><span class="p">))</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__select_last_accessed_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">last_accessed_unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to select Last Modified Unit &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//select[@ng-model=&#39;fileTimestampConfig.timestampRule&#39;]/option[text()=&#39;</span><span class="si">{}</span><span class="s2">&#39;]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">last_accessed_unit</span><span class="p">))</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__select_access_time_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to select access time rule. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//select[@ng-model=&#39;fileTimestampConfig.accessRule&#39;]/option[text()=&#39;Last accessed&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__select_modify_time_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to select modify time rule. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//select[@ng-model=&#39;fileTimestampConfig.accessRule&#39;]/option[text()=&#39;Last modified&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__select_archive_frequency_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">archive_frequency_unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to set Archive frequency unit. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//select[@ng-model=&#39;incrementalBackupFreq.type&#39;]/option[text()=&#39;</span><span class="si">{}</span><span class="s2">&#39;]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">archive_frequency_unit</span><span class="p">))</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__set_office365_retention_period</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">period</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set the Office 365 Plan Retention</span>

<span class="sd">        Args:</span>
<span class="sd">            period (int):   No. of days/months/years data should be retained</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//input[@picker-id=&#39;deletedRetentionDays&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="n">input_element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//input[@data-ng-model=&#39;ctrl.pickerNum&#39;]&quot;</span><span class="p">)</span>
        <span class="n">input_element</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">input_element</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">period</span><span class="p">))</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__click_edit_onedrive_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks on Edit option for OneDrive Filters for Office 365 Plan&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//*[@title=&#39;OneDrive&#39;]//ancestor::div[@class=&quot;</span>
            <span class="s2">&quot;&#39;page-details group&#39;]//a[contains(text(),&#39;Edit&#39;)]&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__click_file_filters_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks on File Filters Tab for Office 365 Plan&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//li/a[normalize-space()=&#39;File filters&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__add_include_folder_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_filter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds the include folder filter</span>

<span class="sd">        Args:</span>
<span class="sd">            include_filter (str):   Filter to be added</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">input_element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s1">&#39;includefolderName&#39;</span><span class="p">)</span>
        <span class="n">input_element</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">input_element</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">include_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//h4[normalize-space()=&#39;Include folder&#39;]//ancestor::div&quot;</span>
            <span class="s2">&quot;[@id=&#39;backup-content-folders&#39;]//*[contains(@class, &#39;k-i-plus&#39;)]&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__add_exclude_folder_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exclude_filter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds the exclude folder filter</span>

<span class="sd">        Args:</span>
<span class="sd">            exclude_filter (str):   Filter to be added</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">input_element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s1">&#39;excludefolderName&#39;</span><span class="p">)</span>
        <span class="n">input_element</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">input_element</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">exclude_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//h4[normalize-space()=&#39;Exclude folder&#39;]//ancestor::div&quot;</span>
            <span class="s2">&quot;[@id=&#39;exclude-folders&#39;]//*[contains(@class, &#39;k-i-plus&#39;)]&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__add_include_file_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_filter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds the include file filter</span>

<span class="sd">        Args:</span>
<span class="sd">            include_filter (str):   Filter to be added</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">input_element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s1">&#39;includefileName&#39;</span><span class="p">)</span>
        <span class="n">input_element</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">input_element</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">include_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//h4[normalize-space()=&#39;Include file&#39;]//ancestor::div&quot;</span>
            <span class="s2">&quot;[@id=&#39;backup-content-folders&#39;]//*[contains(@class, &#39;k-i-plus&#39;)]&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__add_exclude_file_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exclude_filter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds the exclude file filter</span>

<span class="sd">        Args:</span>
<span class="sd">            exclude_filter (str):   Filter to be added</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">input_element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_elements_by_id</span><span class="p">(</span><span class="s1">&#39;includefolderName&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">input_element</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">input_element</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">exclude_filter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s2">&quot;//h4[normalize-space()=&#39;Exclude file&#39;]//ancestor::div&quot;</span>
            <span class="s2">&quot;[@id=&#39;exclude-folders&#39;]//*[contains(@class, &#39;k-i-plus&#39;)]&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">click_create_derived_plan_button</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        click on derive plan button</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__click_create_derived_plan_button</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">backup_content_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                 <span class="n">content_backup</span><span class="p">,</span>
                                 <span class="n">content_library</span><span class="p">,</span>
                                 <span class="n">custom_content</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to select backup content for the plan</span>

<span class="sd">        Args:</span>
<span class="sd">            content_backup (list): List with folder names to be selected</span>
<span class="sd">                            for content backup</span>
<span class="sd">                Eg. - content_backup:[&quot;Content Library&quot;, &quot;Documents&quot;, &quot;Desktop&quot;,</span>
<span class="sd">                                        &quot;Office&quot;, &quot;Music&quot;, &quot;Pictures&quot;, &quot;Videos&quot;]</span>
<span class="sd">            content_library (list): List with content library values to be</span>
<span class="sd">                            selected for backup</span>
<span class="sd">                Eg. - content_library = [&#39;Content Library&#39;, &#39;GoogleDrive&#39;, &#39;Image&#39;,</span>
<span class="sd">                                         &#39;Office&#39;, &#39;OneDrive&#39;, &#39;System&#39;,</span>
<span class="sd">                                        &#39;Temporary Files&#39;, &#39;Text&#39;,</span>
<span class="sd">                                        &#39;Thumbnail Supported&#39;, &#39;Video&#39;,</span>
<span class="sd">                                        &#39;iCloudDrive&#39;]</span>
<span class="sd">            custom_content (str): path for custom(extra) content to be backed up</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                -- if fails to select Backup content</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">content_backup</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__click_remove_content</span><span class="p">(</span><span class="s1">&#39;backup-content-folders&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__click_add_content</span><span class="p">(</span><span class="s1">&#39;backup-content-folders&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">content_backup</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__select_content</span><span class="p">(</span><span class="n">content_backup</span><span class="p">,</span>
                                  <span class="n">content_library</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">custom_content</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__click_add_custom_content</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="n">custom_content</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;//*[@id=&#39;createNewFolder_button_#8189&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">check_error_message</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">exclusion_content_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                    <span class="n">exclude_folder</span><span class="p">,</span>
                                    <span class="n">exclude_folder_library</span><span class="p">,</span>
                                    <span class="n">exclude_folder_custom_content</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to select content to be excluded from backup for the plan</span>

<span class="sd">        Args:</span>
<span class="sd">            exclude_folder (list): List with folder names to be excluded</span>
<span class="sd">                            from backup</span>
<span class="sd">                Eg. - exclude_folder = [&#39;Content Library&#39;, &#39;Documents&#39;]</span>
<span class="sd">            exclude_folder_library (list): List with content library folders to be</span>
<span class="sd">                                excluded from backup</span>
<span class="sd">                Eg. - exclude_folder_library = [&#39;DropBox&#39;, &#39;EdgeDrive&#39;, &#39;Executable&#39;,</span>
<span class="sd">                                                &#39;GoogleDrive&#39;, &#39;Image&#39;, &#39;Office&#39;,</span>
<span class="sd">                                                &#39;OneDrive&#39;, &#39;Thumbnail Supported&#39;,</span>
<span class="sd">                                                &#39;Video&#39;, &#39;iCloudDrive&#39;]</span>
<span class="sd">            exclude_folder_custom_content (str): path for custom(extra) content to be</span>
<span class="sd">                                            excluded</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                -- if fails to provide exclusion values for the plan</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">exclude_folder</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__click_remove_content</span><span class="p">(</span><span class="s1">&#39;exclude-folders&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__click_add_content</span><span class="p">(</span><span class="s1">&#39;exclude-folders&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">exclude_folder</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__select_content</span><span class="p">(</span><span class="n">exclude_folder</span><span class="p">,</span> <span class="n">exclude_folder_library</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">exclude_folder_custom_content</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__click_add_custom_content</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;folderName&quot;</span><span class="p">,</span> <span class="n">exclude_folder_custom_content</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;//*[@id=&#39;createNewFolder_button_#8189&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">check_error_message</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">set_network_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                              <span class="n">throttle_send</span><span class="p">,</span>
                              <span class="n">throttle_receive</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set network resources</span>

<span class="sd">        Args:</span>
<span class="sd">            throttle_send (string ot integer): Network Resource send parameter value</span>

<span class="sd">            throttle_receive (string or integer): Network Resource receive parameter value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">throttle_send</span> <span class="o">==</span> <span class="s2">&quot;No limit&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_select</span><span class="p">(</span><span class="s1">&#39;throttleSend&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_deselect</span><span class="p">(</span><span class="s1">&#39;throttleSend&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s1">&#39;maxLANBandwidth&#39;</span><span class="p">,</span> <span class="n">throttle_send</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">throttle_receive</span> <span class="o">==</span> <span class="s2">&quot;No limit&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_select</span><span class="p">(</span><span class="s1">&#39;throttleReceive&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_deselect</span><span class="p">(</span><span class="s1">&#39;throttleReceive&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s1">&#39;maxWANBandwidth&#39;</span><span class="p">,</span> <span class="n">throttle_send</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__alert_checkbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to get alert checkbox element &quot;&quot;&quot;</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;//*[@id=&#39;tileContent_Alerts&#39;]//*[text()=&#39;</span><span class="si">{</span><span class="n">alert</span><span class="si">}</span><span class="s2">&#39;]&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">xp</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">__edit_alert_checkbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Method to edit alert checkbox element &quot;&quot;&quot;</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;//form[@name=&#39;editAlertsForm&#39;]//*[text()=&#39;</span><span class="si">{</span><span class="n">alert</span><span class="si">}</span><span class="s2">&#39;]&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">xp</span><span class="p">)</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">set_alerts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alerts</span><span class="p">,</span> <span class="n">edit_alert</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set alerts</span>

<span class="sd">        Args:</span>
<span class="sd">            alerts (dictionary): Dictionary with values for determining whether alerts should</span>
<span class="sd">                be Enabled/Disabled</span>
<span class="sd">                Eg. - alerts = {&quot;Backup&quot; : &quot;No backup for last 4 days&quot;,</span>
<span class="sd">                                &quot;Jobfail&quot;: &quot;Restore Job failed&quot;,</span>
<span class="sd">                                &quot;edge_drive_quota&quot;:&quot;Edge drive quota alert&quot;,</span>
<span class="sd">                                &quot;edge_drive_operations&quot;:&quot;Edge drive/share operations alert&quot;}</span>
<span class="sd">            edit_alert (boolean) = Whether to edit alerts or not</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">alerts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Backup&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">edit_alert</span><span class="p">:</span>
                <span class="n">elem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__alert_checkbox</span><span class="p">(</span><span class="s1">&#39;No backup for last 4 days&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">elem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__edit_alert_checkbox</span><span class="p">(</span><span class="s1">&#39;No backup for last 4 days&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">alerts</span><span class="p">[</span><span class="s2">&quot;Backup&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;No backup for last 4 days&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_select</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;for&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_deselect</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;for&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">alerts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Jobfail&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">edit_alert</span><span class="p">:</span>
                <span class="n">elem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__alert_checkbox</span><span class="p">(</span><span class="s1">&#39;Restore Job failed&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">elem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__edit_alert_checkbox</span><span class="p">(</span><span class="s1">&#39;Restore Job failed&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">alerts</span><span class="p">[</span><span class="s2">&quot;Jobfail&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Restore Job failed&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_select</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;for&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_deselect</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;for&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">alerts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;edge_drive_quota&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">edit_alert</span><span class="p">:</span>
                <span class="n">elem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__alert_checkbox</span><span class="p">(</span><span class="s1">&#39;Edge drive quota alert&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">elem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__edit_alert_checkbox</span><span class="p">(</span><span class="s1">&#39;Edge drive quota alert&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">alerts</span><span class="p">[</span><span class="s2">&quot;edge_drive_quota&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Edge drive quota alert&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_select</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;for&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_deselect</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;for&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">alerts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file_system_quota&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">edit_alert</span><span class="p">:</span>
                <span class="n">elem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__alert_checkbox</span><span class="p">(</span><span class="s1">&#39;File system quota alert&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">elem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__edit_alert_checkbox</span><span class="p">(</span><span class="s1">&#39;File system quota alert&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">alerts</span><span class="p">[</span><span class="s2">&quot;file_system_quota&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;File system quota alert&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_select</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;for&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_deselect</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;for&#39;</span><span class="p">))</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">set_override_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">allow_override</span><span class="p">,</span> <span class="n">edit_override_laptop</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set override options</span>

<span class="sd">        Args:</span>
<span class="sd">            allow_override (dictionary): dictionary containing values for Override parameters</span>
<span class="sd">                Eg. - allow_override = {&quot;Storage_pool&quot;: &quot;Override required&quot;,</span>
<span class="sd">                                        &quot;RPO&quot;: &quot;Override optional&quot;,</span>
<span class="sd">                                        &quot;Folders_to_backup&quot;: &quot;Override not allowed&quot;,</span>
<span class="sd">                                        &quot;Retention&quot;: &quot;Override not allowed&quot;}</span>

<span class="sd">            edit_override_laptop (boolean) = Whether to edit override or not</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">allow_override</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Folders_to_backup&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">edit_override_laptop</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__set_override_option</span><span class="p">(</span><span class="s1">&#39;override-select-SubclientPolicyWin&#39;</span><span class="p">,</span> <span class="n">allow_override</span><span class="p">[</span><span class="s1">&#39;Folders_to_backup&#39;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__set_override_option</span><span class="p">(</span><span class="s1">&#39;override-select-SubclientContentWin&#39;</span><span class="p">,</span> <span class="n">allow_override</span><span class="p">[</span><span class="s1">&#39;Folders_to_backup&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">allow_override</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Storage_pool&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__set_override_option</span><span class="p">(</span><span class="s1">&#39;override-select-StoragePolicy&#39;</span><span class="p">,</span> <span class="n">allow_override</span><span class="p">[</span><span class="s1">&#39;Storage_pool&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">allow_override</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;RPO&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__set_override_option</span><span class="p">(</span><span class="s1">&#39;override-select-SchedulePolicy&#39;</span><span class="p">,</span> <span class="n">allow_override</span><span class="p">[</span><span class="s1">&#39;RPO&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">allow_override</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Retention&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__set_override_option</span><span class="p">(</span><span class="s1">&#39;override-select-SubclientRetentionWin&#39;</span><span class="p">,</span> <span class="n">allow_override</span><span class="p">[</span><span class="s1">&#39;Retention&#39;</span><span class="p">])</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">set_retention</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">retention</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set retention values</span>

<span class="sd">        Args:</span>
<span class="sd">             retention (dict) : dictionary containing retention attributes for laptop plan</span>
<span class="sd">                Eg. - retention = {&#39;deleted_item_retention&#39;: {&#39;value&#39;: &#39;5&#39;, &#39;unit&#39;: &#39;day(s)&#39;},</span>
<span class="sd">                                   &#39;file_version_retention&#39;: {&#39;duration&#39;: {&#39;value&#39;: &#39;4&#39;,</span>
<span class="sd">                                                                          &#39;unit&#39;: &#39;day(s)&#39;},</span>
<span class="sd">                                                              &#39;versions&#39;: &#39;5&#39;,</span>
<span class="sd">                                                              &#39;rules&#39;: {&#39;days&#39;: &#39;4&#39;,</span>
<span class="sd">                                                                        &#39;weeks&#39;: &#39;5&#39;,</span>
<span class="sd">                                                                        &#39;months&#39;: &#39;6&#39;}}}</span>
<span class="sd">                    OR</span>
<span class="sd">                        retention = {&#39;deleted_item_retention&#39;: {&#39;value&#39;: &#39;5&#39;, &#39;unit&#39;: &#39;day(s)&#39;},</span>
<span class="sd">                                       &#39;file_version_retention&#39;: {&#39;duration&#39;: None,</span>
<span class="sd">                                                                  &#39;versions&#39;: None,</span>
<span class="sd">                                                                  &#39;rules&#39;: {&#39;days&#39;: &#39;4&#39;,</span>
<span class="sd">                                                                            &#39;weeks&#39;: &#39;5&#39;,</span>
<span class="sd">                                                                            &#39;months&#39;: &#39;6&#39;}}}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">retention</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;deleted_item_retention&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">retention</span><span class="p">[</span><span class="s1">&#39;deleted_item_retention&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Indefinitely&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__select_radio_by_id</span><span class="p">(</span><span class="s2">&quot;radio2_1&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__select_radio_by_id</span><span class="p">(</span><span class="s2">&quot;radio1_1&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;radio1_1years&quot;</span><span class="p">,</span>
                                                     <span class="n">retention</span><span class="p">[</span><span class="s1">&#39;deleted_item_retention&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">select_value_from_dropdown</span><span class="p">(</span><span class="s2">&quot;deleted_time&quot;</span><span class="p">,</span>
                                                                <span class="n">retention</span><span class="p">[</span><span class="s1">&#39;deleted_item_retention&#39;</span><span class="p">][</span><span class="s1">&#39;unit&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">retention</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;file_version_retention&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">retention</span><span class="p">[</span><span class="s1">&#39;file_version_retention&#39;</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__select_radio_by_id</span><span class="p">(</span><span class="s2">&quot;radio1_2&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;radio1_2years&quot;</span><span class="p">,</span>
                                                     <span class="n">retention</span><span class="p">[</span><span class="s1">&#39;file_version_retention&#39;</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">select_value_from_dropdown</span><span class="p">(</span><span class="s2">&quot;file_time&quot;</span><span class="p">,</span>
                                                                <span class="n">retention</span><span class="p">[</span><span class="s1">&#39;file_version_retention&#39;</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span>
                                                                <span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">retention</span><span class="p">[</span><span class="s1">&#39;file_version_retention&#39;</span><span class="p">][</span><span class="s1">&#39;versions&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__select_radio_by_id</span><span class="p">(</span><span class="s2">&quot;radio2_2&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;radio2_2versions&quot;</span><span class="p">,</span>
                                                     <span class="n">retention</span><span class="p">[</span><span class="s1">&#39;file_version_retention&#39;</span><span class="p">][</span><span class="s1">&#39;versions&#39;</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">retention</span><span class="p">[</span><span class="s1">&#39;file_version_retention&#39;</span><span class="p">][</span><span class="s1">&#39;rules&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__select_radio_by_id</span><span class="p">(</span><span class="s2">&quot;radio3_3&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;radio3_2perday&quot;</span><span class="p">,</span>
                                                     <span class="n">retention</span><span class="p">[</span><span class="s1">&#39;file_version_retention&#39;</span><span class="p">][</span><span class="s1">&#39;rules&#39;</span><span class="p">][</span><span class="s1">&#39;days&#39;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;radio3_3perweek&quot;</span><span class="p">,</span>
                                                     <span class="n">retention</span><span class="p">[</span><span class="s1">&#39;file_version_retention&#39;</span><span class="p">][</span><span class="s1">&#39;rules&#39;</span><span class="p">][</span><span class="s1">&#39;weeks&#39;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;radio3_4permonth&quot;</span><span class="p">,</span>
                                                     <span class="n">retention</span><span class="p">[</span><span class="s1">&#39;file_version_retention&#39;</span><span class="p">][</span><span class="s1">&#39;rules&#39;</span><span class="p">][</span><span class="s1">&#39;months&#39;</span><span class="p">])</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">set_archiving_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">archiving_rules</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to set archiving rules</span>

<span class="sd">        Args:</span>
<span class="sd">             archiving_rules (dictionary): dictionary containing values for Archive Feature rules</span>
<span class="sd">                Eg. - archiving_rules = {&quot;do_edit&quot;: True, &quot;start_clean&quot;: &quot;40&quot;, &quot;stop_clean&quot;: &quot;90&quot;,</span>
<span class="sd">                                        &quot;file_access_time&quot;: &quot;85&quot;, &quot;file_modify_time&quot;: None,</span>
<span class="sd">                                        &quot;file_create_time&quot;: &quot;2&quot;, &quot;archive_file_size&quot;: None,</span>
<span class="sd">                                        &quot;max_file_size&quot;: None, &quot;archive_read_only&quot;: True,</span>
<span class="sd">                                        &quot;replace_file&quot;: None, &quot;delete_file&quot;: None}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">archiving_rules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;start_clean&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;startCleanDisk&quot;</span><span class="p">,</span> <span class="n">archiving_rules</span><span class="p">[</span><span class="s2">&quot;start_clean&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">archiving_rules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;stop_clean&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;stopCleanDisk&quot;</span><span class="p">,</span> <span class="n">archiving_rules</span><span class="p">[</span><span class="s2">&quot;stop_clean&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">archiving_rules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file_access_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;fileAccessTime&quot;</span><span class="p">,</span> <span class="n">archiving_rules</span><span class="p">[</span><span class="s2">&quot;file_access_time&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">archiving_rules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file_modify_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;fileModifiedTime&quot;</span><span class="p">,</span> <span class="n">archiving_rules</span><span class="p">[</span><span class="s2">&quot;file_modify_time&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">archiving_rules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;file_create_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;fileCreatedTime&quot;</span><span class="p">,</span> <span class="n">archiving_rules</span><span class="p">[</span><span class="s2">&quot;file_create_time&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">archiving_rules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;archive_file_size&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;archiveFileSize&quot;</span><span class="p">,</span> <span class="n">archiving_rules</span><span class="p">[</span><span class="s2">&quot;archive_file_size&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">archiving_rules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_file_size&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;maxFileSize&quot;</span><span class="p">,</span> <span class="n">archiving_rules</span><span class="p">[</span><span class="s2">&quot;max_file_size&quot;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">archiving_rules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;archive_read_only&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_select</span><span class="p">(</span><span class="s1">&#39;archiveReadOnlyFile&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_deselect</span><span class="p">(</span><span class="s1">&#39;archiveReadOnlyFile&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">archiving_rules</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;replace_file&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">select_radio</span><span class="p">(</span><span class="s1">&#39;replaceFile&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">select_radio</span><span class="p">(</span><span class="s1">&#39;deleteFile&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__modal_panel</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">create_server_plan</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">plan_name</span><span class="p">,</span>
            <span class="n">storage</span><span class="p">,</span>
            <span class="n">rpo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">allow_override</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">backup_day</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">backup_duration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">backup_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">snapshot_options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">database_options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">system_state</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">full_backup</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">vss</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to create Server plan</span>

<span class="sd">        Args:</span>
<span class="sd">            plan_name (string): Name of the plan to be created</span>

<span class="sd">            storage (dict) : Dict containing storage attributes for admin console</span>
<span class="sd">                Eg. - self._storage = {&#39;pri_storage&#39;: None,</span>
<span class="sd">                         &#39;pri_ret_period&#39;:&#39;30&#39;,</span>
<span class="sd">                         &#39;sec_storage&#39;: None,</span>
<span class="sd">                         &#39;sec_ret_period&#39;:&#39;45&#39;,</span>
<span class="sd">                         &#39;ret_unit&#39;:&#39;day(s)&#39;}</span>

<span class="sd">            rpo (dict): Dictionary containing values for RPO</span>
<span class="sd">                Eg. - rpo_dict = {&#39;bkp_frequency&#39;: &#39;1&#39;,</span>
<span class="sd">                                  &#39;frequency_unit&#39;: &#39;Day(s)&#39;,</span>
<span class="sd">                                  &#39;hours&#39;: &#39;09&#39;,</span>
<span class="sd">                                  &#39;minutes&#39;: &#39;00&#39;,</span>
<span class="sd">                                  &#39;am_or_pm&#39;: &#39;PM&#39;}</span>

<span class="sd">            allow_override (dictionary): dictionary containing values for Override parameters</span>
<span class="sd">                Eg. - allow_override = {&quot;Storage_pool&quot;: &quot;Override required&quot;,</span>
<span class="sd">                                        &quot;RPO&quot;: &quot;Override optional&quot;}</span>

<span class="sd">            backup_day (dictionary): dictionary containing values of backup days for backup</span>
<span class="sd">                window</span>
<span class="sd">                Eg. - backup_day = dict.fromkeys([&#39;1&#39;, &#39;2&#39;, &#39;3&#39;], 1)</span>

<span class="sd">            backup_duration (dictionary): dictionary containing values of excluded backup</span>
<span class="sd">                time for backup window</span>
<span class="sd">                Eg. - backup_duration = dict.fromkeys([&#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;], 1)</span>

<span class="sd">            backup_data (Dictionary): Dictionary with data to be selected</span>
<span class="sd">                for backup or excluded from backup</span>
<span class="sd">                Eg. - backup_data = {&#39;file_system&#39;:[&quot;Mac&quot;, &quot;Unix&quot;, &quot;Windows&quot;],</span>
<span class="sd">                                    &#39;content_backup&#39;:[&quot;Content Library&quot;],</span>
<span class="sd">                                    &#39;content_library&#39;:[&#39;Content Library&#39;, &#39;GoogleDrive&#39;],</span>
<span class="sd">                                    &#39;custom_content&#39;:None,</span>
<span class="sd">                                    &#39;exclude_folder&#39;:[&#39;Content Library&#39;, &#39;Documents&#39;],</span>
<span class="sd">                                    &#39;exclude_folder_library&#39;:[&#39;DropBox&#39;, &#39;EdgeDrive&#39;, &#39;Executable&#39;]</span>
<span class="sd">                                    &#39;exclude_folder_custom_content&#39;:None}</span>

<span class="sd">            system_state (boolean): value, if &quot;Backup system state&quot; should be checked or not</span>

<span class="sd">            full_backup (boolean): value, if &quot;Only with full backup&quot; should be checked or not</span>

<span class="sd">            vss (boolean): value, if &quot;Use VSS for system state&quot; should be checked or not</span>

<span class="sd">            snapshot_options (dictionary) : dictionary containing values for snapshot parameters</span>
<span class="sd">                Eg. - snapshot_options = {&#39;snap_recovery_points&#39;:&#39;5&#39;,</span>
<span class="sd">                                          &#39;Enable_backup_copy&#39;:True,</span>
<span class="sd">                                          &#39;sla_hours&#39;:&#39;5&#39;,</span>
<span class="sd">                                          &#39;sla_minutes&#39;:&#39;20&#39;}</span>

<span class="sd">            database_options (dictionary) : dictionary containing values for databse parameters</span>
<span class="sd">                Eg. - database_options = {&#39;sla_hours&#39;:&#39;5&#39;,</span>
<span class="sd">                                          &#39;sla_minutes&#39;:&#39;20&#39;}</span>
<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                -- if fails to create the plan</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">select_hyperlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.createProfile&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__click_plan_type</span><span class="p">(</span><span class="s1">&#39;CreateServerPlan&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__set_plan_name</span><span class="p">(</span><span class="n">plan_name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">select_hyperlink</span><span class="p">(</span><span class="s2">&quot;Add&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;storageName&quot;</span><span class="p">,</span> <span class="s2">&quot;Primary&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__drop_down</span><span class="o">.</span><span class="n">select_drop_down_values</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="n">storage</span><span class="p">[</span><span class="s1">&#39;pri_storage&#39;</span><span class="p">]])</span>

        <span class="k">if</span> <span class="n">storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pri_ret_period&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">storage</span><span class="p">[</span><span class="s1">&#39;pri_ret_period&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Infinite&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__set_retention_unit</span><span class="p">(</span><span class="n">storage</span><span class="p">[</span><span class="s1">&#39;ret_unit&#39;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__set_retention_period</span><span class="p">(</span><span class="n">storage</span><span class="p">[</span><span class="s1">&#39;pri_ret_period&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ret_unit&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__set_retention_unit</span><span class="p">(</span><span class="n">storage</span><span class="p">[</span><span class="s1">&#39;ret_unit&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">submit_form</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sec_storage&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">select_hyperlink</span><span class="p">(</span><span class="s2">&quot;Add copy&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;storageName&quot;</span><span class="p">,</span> <span class="s2">&quot;Secondary&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__drop_down</span><span class="o">.</span><span class="n">select_drop_down_values</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="n">storage</span><span class="p">[</span><span class="s1">&#39;sec_storage&#39;</span><span class="p">]])</span>

            <span class="k">if</span> <span class="n">storage</span><span class="p">[</span><span class="s1">&#39;sec_ret_period&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">storage</span><span class="p">[</span><span class="s1">&#39;sec_ret_period&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Infinite&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__set_retention_unit</span><span class="p">(</span><span class="n">storage</span><span class="p">[</span><span class="s1">&#39;ret_unit&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__set_retention_period</span><span class="p">(</span><span class="n">storage</span><span class="p">[</span><span class="s1">&#39;sec_ret_period&#39;</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ret_unit&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__set_retention_unit</span><span class="p">(</span><span class="n">storage</span><span class="p">[</span><span class="s1">&#39;ret_unit&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">submit_form</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">rpo</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rpo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bkp_frequency&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;rpo&quot;</span><span class="p">,</span> <span class="n">rpo</span><span class="p">[</span><span class="s1">&#39;bkp_frequency&#39;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__set_rpo_unit</span><span class="p">(</span><span class="n">rpo</span><span class="p">[</span><span class="s1">&#39;frequency_unit&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">rpo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;hours&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__set_rpo_hours</span><span class="p">(</span><span class="n">rpo</span><span class="p">[</span><span class="s1">&#39;hours&#39;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__set_rpo_minutes</span><span class="p">(</span><span class="n">rpo</span><span class="p">[</span><span class="s1">&#39;minutes&#39;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__set_am_or_pm</span><span class="p">(</span><span class="n">rpo</span><span class="p">[</span><span class="s1">&#39;am_or_pm&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">backup_day</span> <span class="ow">and</span> <span class="n">backup_duration</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__open_edit_backup_window_dialog</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__set_backup_window</span><span class="p">(</span><span class="n">backup_day</span><span class="p">,</span> <span class="n">backup_duration</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;setting up full back up window&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__open_edit_full_backup_window_dialog</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__set_backup_window</span><span class="p">(</span><span class="n">backup_day</span><span class="p">,</span> <span class="n">backup_duration</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">backup_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__expand_sub_panel</span><span class="p">(</span><span class="s1">&#39;Folders to backup&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">backup_data</span><span class="p">[</span><span class="s1">&#39;file_system&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__select_file_system_tab</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">backup_content_selection</span><span class="p">(</span>
                    <span class="n">backup_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content_backup&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="n">backup_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content_library&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="n">backup_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;custom_content&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

                <span class="k">if</span> <span class="n">backup_data</span><span class="p">[</span><span class="s1">&#39;exclude_folder&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">backup_data</span><span class="p">[</span><span class="s1">&#39;exclude_folder_library&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">backup_data</span><span class="p">[</span>
                        <span class="s1">&#39;exclude_folder_custom_content&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">exclusion_content_selection</span><span class="p">(</span>
                        <span class="n">backup_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude_folder&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                        <span class="n">backup_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude_folder_library&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                        <span class="n">backup_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude_folder_custom_content&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

                <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">system_state</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_select</span><span class="p">(</span><span class="s1">&#39;backupSystemState&#39;</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">full_backup</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_select</span><span class="p">(</span><span class="s1">&#39;backupSystemStateforFullBkpOnly&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_deselect</span><span class="p">(</span><span class="s1">&#39;backupSystemStateforFullBkpOnly&#39;</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">vss</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_select</span><span class="p">(</span><span class="s1">&#39;useVSSForSystemState&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_deselect</span><span class="p">(</span><span class="s1">&#39;useVSSForSystemState&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_deselect</span><span class="p">(</span><span class="s1">&#39;backupSystemState&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">snapshot_options</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__expand_sub_panel</span><span class="p">(</span><span class="s1">&#39;Snapshot options&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">snapshot_options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;snap_recovery_points&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">check_if_entity_exists</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;snapRecoveryPoints&quot;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;snapRecoveryPoints&quot;</span><span class="p">,</span>
                                                         <span class="n">snapshot_options</span><span class="p">[</span><span class="s1">&#39;snap_recovery_points&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">snapshot_options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Enable_backup_copy&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">snapshot_options</span><span class="p">[</span><span class="s1">&#39;Enable_backup_copy&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ON&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">enable_toggle</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">disable_toggle</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">snapshot_options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sla_hours&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__set_sla_hours</span><span class="p">(</span><span class="n">snapshot_options</span><span class="p">[</span><span class="s1">&#39;sla_hours&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">snapshot_options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sla_minutes&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__set_sla_minutes</span><span class="p">(</span><span class="n">snapshot_options</span><span class="p">[</span><span class="s1">&#39;sla_minutes&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">database_options</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__expand_sub_panel</span><span class="p">(</span><span class="s1">&#39;Database options&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">database_options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sla_hours&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__set_sla_hours</span><span class="p">(</span><span class="n">database_options</span><span class="p">[</span><span class="s1">&#39;sla_hours&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">database_options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sla_minutes&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__set_sla_minutes</span><span class="p">(</span><span class="n">database_options</span><span class="p">[</span><span class="s1">&#39;sla_minutes&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">allow_override</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__expand_sub_panel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.overrideRestrictions&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__enable_allow_override</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_override_options</span><span class="p">(</span><span class="n">allow_override</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">click_button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.save&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">check_error_message</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">create_laptop_plan</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">plan_name</span><span class="p">,</span>
            <span class="n">allowed_features</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">media_agent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">archiving_rules</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">backup_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">file_system_quota</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">storage</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">rpo_hours</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">retention</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">throttle_send</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">throttle_receive</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">alerts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">allow_override</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to create Laptop plan</span>

<span class="sd">        Args:</span>

<span class="sd">            plan_name (string): Name of the plan to be created</span>

<span class="sd">            rpo_hours (string): RPO Hours value</span>

<span class="sd">            allowed_features (dictionary): dictionary containing features to be enabled for the</span>
<span class="sd">                             plan and corresponding attributes</span>
<span class="sd">                Eg. - allowed_features = {&#39;Edge Drive&#39;: &#39;ON&#39;,</span>
<span class="sd">                                          &#39;audit_drive_operations&#39;: True,</span>
<span class="sd">                                          &#39;notification_for_shares&#39;: True,</span>
<span class="sd">                                          &#39;edge_drive_quota&#39;:&#39;200&#39;,</span>
<span class="sd">                                          &#39;DLP&#39;: &#39;ON&#39;,</span>
<span class="sd">                                          &#39;Archiving&#39;: &#39;ON&#39;}</span>

<span class="sd">            media_agent (string)    :   media agent to be used to configure edge drive for plan</span>

<span class="sd">            archiving_rules (dictionary): dictionary containing values for Archive Feature rules</span>
<span class="sd">                Eg. - archiving_rules = {&quot;do_edit&quot;: True, &quot;start_clean&quot;: &quot;40&quot;, &quot;stop_clean&quot;: &quot;90&quot;,</span>
<span class="sd">                                        &quot;file_access_time&quot;: &quot;85&quot;, &quot;file_modify_time&quot;: None,</span>
<span class="sd">                                        &quot;file_create_time&quot;: &quot;2&quot;, &quot;archive_file_size&quot;: None,</span>
<span class="sd">                                        &quot;max_file_size&quot;: None, &quot;archive_read_only&quot;: True,</span>
<span class="sd">                                        &quot;replace_file&quot;: None, &quot;delete_file&quot;: None}</span>

<span class="sd">            backup_data (dictionary) : Dictionary containing multiple lists with values for back</span>
<span class="sd">                up content to be selected and excluded while creating the plan</span>
<span class="sd">                Eg. - backup_data = {&#39;file_system&#39;:[&quot;Mac&quot;, &quot;Unix&quot;, &quot;Windows&quot;],</span>
<span class="sd">                                    &#39;content_backup&#39;:[&quot;Content Library&quot;],</span>
<span class="sd">                                    &#39;content_library&#39;:[&#39;Content Library&#39;, &#39;GoogleDrive&#39;],</span>
<span class="sd">                                    &#39;custom_content&#39;:None,</span>
<span class="sd">                                    &#39;exclude_folder&#39;:[&#39;Content Library&#39;, &#39;Documents&#39;],</span>
<span class="sd">                                    &#39;exclude_folder_library&#39;:[&#39;DropBox&#39;, &#39;EdgeDrive&#39;, &#39;Executable&#39;]</span>
<span class="sd">                                    &#39;exclude_folder_custom_content&#39;:None</span>
<span class="sd">                                   }</span>

<span class="sd">            file_system_quota (string): Variable containing value for File system quota</span>

<span class="sd">            storage (dict) : Dict containing storage attributes for admin console</span>
<span class="sd">                Eg. - self._storage = {&#39;pri_storage&#39;: None,</span>
<span class="sd">                         &#39;pri_ret_period&#39;:&#39;30&#39;,</span>
<span class="sd">                         &#39;sec_storage&#39;: None,</span>
<span class="sd">                         &#39;sec_ret_period&#39;:&#39;45&#39;,</span>
<span class="sd">                         &#39;ret_unit&#39;:&#39;day(s)&#39;}</span>

<span class="sd">            throttle_send (string ot integer): Network Resource send parameter value</span>

<span class="sd">            throttle_receive (string or integer): Network Resource receive parameter value</span>

<span class="sd">            alerts (dictionary): Dictionary with values for determining whether alerts should</span>
<span class="sd">                be Enabled/Disabled</span>
<span class="sd">                Eg. - alerts = {&quot;Backup&quot; : &quot;No backup for last 4 days&quot;,</span>
<span class="sd">                                &quot;Jobfail&quot;: &quot;Restore Job failed&quot;,</span>
<span class="sd">                                &quot;edge_drive_quota&quot;:&quot;Edge drive quota alert&quot;,</span>
<span class="sd">                                &quot;edge_drive_operations&quot;:&quot;Edge drive/share operations alert&quot;}</span>

<span class="sd">            allow_override (dictionary): dictionary containing values for Override parameters</span>
<span class="sd">                Eg. - allow_override = {&quot;Storage_pool&quot;: &quot;Override required&quot;,</span>
<span class="sd">                                        &quot;RPO&quot;: &quot;Override optional&quot;,</span>
<span class="sd">                                        &quot;Folders_to_backup&quot;: &quot;Override not allowed&quot;}</span>

<span class="sd">            retention (dict) : dictionary containing retention attributes for laptop plan</span>
<span class="sd">                Eg. - retention = {&#39;deleted_item_retention&#39;: {&#39;value&#39;: &#39;5&#39;, &#39;unit&#39;: &#39;day(s)&#39;},</span>
<span class="sd">                                   &#39;file_version_retention&#39;: {&#39;duration&#39;: {&#39;value&#39;: &#39;4&#39;,</span>
<span class="sd">                                                                          &#39;unit&#39;: &#39;day(s)&#39;},</span>
<span class="sd">                                                              &#39;versions&#39;: &#39;5&#39;,</span>
<span class="sd">                                                              &#39;rules&#39;: {&#39;days&#39;: &#39;4&#39;,</span>
<span class="sd">                                                                        &#39;weeks&#39;: &#39;5&#39;,</span>
<span class="sd">                                                                        &#39;months&#39;: &#39;6&#39;}}}</span>
<span class="sd">                    OR</span>
<span class="sd">                        retention = {&#39;deleted_item_retention&#39;: {&#39;value&#39;: &#39;5&#39;, &#39;unit&#39;: &#39;day(s)&#39;},</span>
<span class="sd">                                       &#39;file_version_retention&#39;: {&#39;duration&#39;: None,</span>
<span class="sd">                                                                  &#39;versions&#39;: None,</span>
<span class="sd">                                                                  &#39;rules&#39;: {&#39;days&#39;: &#39;4&#39;,</span>
<span class="sd">                                                                            &#39;weeks&#39;: &#39;5&#39;,</span>
<span class="sd">                                                                            &#39;months&#39;: &#39;6&#39;}}}</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                -- if fails to create the plan</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">select_hyperlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.createProfile&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__click_plan_type</span><span class="p">(</span><span class="s1">&#39;CreateLaptopPlan&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__set_plan_name</span><span class="p">(</span><span class="n">plan_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">allowed_features</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">allowed_features</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Edge Drive&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">allowed_features</span><span class="p">[</span><span class="s2">&quot;Edge Drive&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ON&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_select</span><span class="p">(</span><span class="s1">&#39;146&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__setup_edge_drive_features</span><span class="p">(</span><span class="n">allowed_features</span><span class="p">,</span>
                                                     <span class="n">media_agent</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_deselect</span><span class="p">(</span><span class="s1">&#39;146&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">allowed_features</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;DLP&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">allowed_features</span><span class="p">[</span><span class="s2">&quot;DLP&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ON&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Enabling DLP for the plan&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_select</span><span class="p">(</span><span class="s1">&#39;148&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_deselect</span><span class="p">(</span><span class="s1">&#39;148&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">allowed_features</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Archiving&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">allowed_features</span><span class="p">[</span><span class="s2">&quot;Archiving&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ON&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_select</span><span class="p">(</span><span class="s1">&#39;215&#39;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">archiving_rules</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">select_hyperlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;action.edit&#39;</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">set_archiving_rules</span><span class="p">(</span><span class="n">archiving_rules</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_deselect</span><span class="p">(</span><span class="s1">&#39;215&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__click_next_button</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">backup_data</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">backup_data</span><span class="p">[</span><span class="s1">&#39;file_system&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__select_file_system_tab</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">backup_content_selection</span><span class="p">(</span>
                    <span class="n">backup_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content_backup&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="n">backup_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content_library&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="n">backup_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;custom_content&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">exclusion_content_selection</span><span class="p">(</span>
                    <span class="n">backup_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude_folder&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="n">backup_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude_folder_library&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="n">backup_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude_folder_custom_content&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">file_system_quota</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">checkbox_select</span><span class="p">(</span><span class="s1">&#39;isQuotaEnabled&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;quota&quot;</span><span class="p">,</span> <span class="n">file_system_quota</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__click_next_button</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pri_storage&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">select_value_from_dropdown</span><span class="p">(</span><span class="s1">&#39;storage&#39;</span><span class="p">,</span> <span class="n">storage</span><span class="p">[</span><span class="s1">&#39;pri_storage&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">storage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sec_storage&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__enable_secondary_storage</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">select_value_from_dropdown</span><span class="p">(</span><span class="s1">&#39;secondaryStorage&#39;</span><span class="p">,</span> <span class="n">storage</span><span class="p">[</span><span class="s1">&#39;sec_storage&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">rpo_hours</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;rpoHours&quot;</span><span class="p">,</span> <span class="n">rpo_hours</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__click_next_button</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_retention</span><span class="p">(</span><span class="n">retention</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__click_next_button</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_network_resources</span><span class="p">(</span><span class="n">throttle_send</span><span class="p">,</span> <span class="n">throttle_receive</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_alerts</span><span class="p">(</span><span class="n">alerts</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">allow_override</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__enable_allow_override</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_override_options</span><span class="p">(</span><span class="n">allow_override</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__click_next_button</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">click_button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.save&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">check_error_message</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">delete_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plan_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to delete an existing plan</span>

<span class="sd">        Args:</span>
<span class="sd">            plan_name (str): Name of the plan to be deleted</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                -- if fails to delete plan</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">access_action_item</span><span class="p">(</span><span class="n">plan_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;action.delete&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">click_button_using_text</span><span class="p">(</span><span class="s1">&#39;Yes&#39;</span><span class="p">)</span>
        <span class="n">notification</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">get_notification</span><span class="p">(</span><span class="n">wait_time</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">notification</span> <span class="o">==</span> <span class="s1">&#39;The plan was successfully deleted&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">notification</span><span class="p">)</span>


    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">create_laptop_derived_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                   <span class="n">derived_plan</span><span class="p">,</span>
                                   <span class="n">backup_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">storage</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">rpo_hours</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">retention</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to create Laptop derived plan</span>

<span class="sd">        Args:</span>

<span class="sd">            derived_plan (string): Name of the derived plan to be created</span>

<span class="sd">            backup_data (dictionary) : Dictionary containing multiple lists with values for back</span>
<span class="sd">                up content to be selected and excluded while creating the plan</span>
<span class="sd">                Eg. - backup_data = {&#39;file_system&#39;:[&quot;Mac&quot;, &quot;Unix&quot;, &quot;Windows&quot;],</span>
<span class="sd">                                    &#39;content_backup&#39;:[&quot;Content Library&quot;],</span>
<span class="sd">                                    &#39;content_library&#39;:[&#39;Content Library&#39;, &#39;GoogleDrive&#39;],</span>
<span class="sd">                                    &#39;custom_content&#39;:None,</span>
<span class="sd">                                    &#39;exclude_folder&#39;:[&#39;Content Library&#39;, &#39;Documents&#39;],</span>
<span class="sd">                                    &#39;exclude_folder_library&#39;:[&#39;DropBox&#39;, &#39;EdgeDrive&#39;, &#39;Executable&#39;]</span>
<span class="sd">                                    &#39;exclude_folder_custom_content&#39;:None</span>
<span class="sd">                                   }</span>

<span class="sd">            storage (dict) : Dict containing storage attributes for admin console</span>
<span class="sd">                Eg. - self._storage = {&#39;pri_storage&#39;: None,</span>
<span class="sd">                         &#39;pri_ret_period&#39;:&#39;30&#39;,</span>
<span class="sd">                         &#39;sec_storage&#39;: None,</span>
<span class="sd">                         &#39;sec_ret_period&#39;:&#39;45&#39;,</span>
<span class="sd">                         &#39;ret_unit&#39;:&#39;day(s)&#39;}</span>

<span class="sd">            rpo_hours (string): RPO Hours value</span>

<span class="sd">            retention (dict) : dictionary containing retention attributes for laptop plan</span>
<span class="sd">                Eg. - retention = {&#39;deleted_item_retention&#39;: {&#39;value&#39;: &#39;5&#39;, &#39;unit&#39;: &#39;day(s)&#39;},</span>
<span class="sd">                                   &#39;file_version_retention&#39;: {&#39;duration&#39;: {&#39;value&#39;: &#39;4&#39;,</span>
<span class="sd">                                                                          &#39;unit&#39;: &#39;day(s)&#39;},</span>
<span class="sd">                                                              &#39;versions&#39;: &#39;5&#39;,</span>
<span class="sd">                                                              &#39;rules&#39;: {&#39;days&#39;: &#39;4&#39;,</span>
<span class="sd">                                                                        &#39;weeks&#39;: &#39;5&#39;,</span>
<span class="sd">                                                                        &#39;months&#39;: &#39;6&#39;}}}</span>
<span class="sd">                    OR</span>
<span class="sd">                        retention = {&#39;deleted_item_retention&#39;: {&#39;value&#39;: &#39;5&#39;, &#39;unit&#39;: &#39;day(s)&#39;},</span>
<span class="sd">                                       &#39;file_version_retention&#39;: {&#39;duration&#39;: None,</span>
<span class="sd">                                                                  &#39;versions&#39;: None,</span>
<span class="sd">                                                                  &#39;rules&#39;: {&#39;days&#39;: &#39;4&#39;,</span>
<span class="sd">                                                                            &#39;weeks&#39;: &#39;5&#39;,</span>
<span class="sd">                                                                            &#39;months&#39;: &#39;6&#39;}}}</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                -- if fails to create the plan</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__set_plan_name</span><span class="p">(</span><span class="n">derived_plan</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__click_next_button</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">backup_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__select_override_backup_content</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">backup_data</span><span class="p">[</span><span class="s1">&#39;file_system&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__select_file_system_tab</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">backup_content_selection</span><span class="p">(</span>
                    <span class="n">backup_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content_backup&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="n">backup_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content_library&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="n">backup_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;custom_content&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">exclusion_content_selection</span><span class="p">(</span>
                    <span class="n">backup_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude_folder&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="n">backup_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude_folder_library&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="n">backup_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude_folder_custom_content&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">__click_next_button</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">storage</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__select_override_storage_rpo</span><span class="p">(</span><span class="s1">&#39;tileContent_Copies&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">select_value_from_dropdown</span><span class="p">(</span><span class="s1">&#39;storage&#39;</span><span class="p">,</span> <span class="n">storage</span><span class="p">[</span><span class="s1">&#39;pri_storage&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">rpo_hours</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__select_override_storage_rpo</span><span class="p">(</span><span class="s1">&#39;tileContent_RPO&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;rpoHours&quot;</span><span class="p">,</span> <span class="n">rpo_hours</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__click_next_button</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">retention</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__select_override_retention</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_retention</span><span class="p">(</span><span class="n">retention</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__click_next_button</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__click_next_button</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">click_button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.save&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">check_error_message</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">create_archive_plan</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">plan_name</span><span class="p">,</span>
            <span class="n">storage</span><span class="p">,</span>
            <span class="n">rpo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">archive_day</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">archive_duration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">archiving_rules</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">allow_override</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to create Archival plan</span>

<span class="sd">        Args:</span>
<span class="sd">            plan_name (string): Name of the plan to be created</span>

<span class="sd">            storage (dict) : Dict containing storage attributes for admin console</span>
<span class="sd">                Eg. - self._storage = {&#39;pri_storage&#39;: None,</span>
<span class="sd">                         &#39;pri_ret_period&#39;:&#39;30&#39;,</span>
<span class="sd">                         &#39;sec_storage&#39;: None,</span>
<span class="sd">                         &#39;sec_ret_period&#39;:&#39;45&#39;,</span>
<span class="sd">                         &#39;ret_unit&#39;:&#39;day(s)&#39;}</span>

<span class="sd">            rpo (dictionary): dictionary containing RPO values</span>
<span class="sd">                Eg. -   rpo = {</span>
<span class="sd">                &quot;archive_frequency&quot;: 2</span>
<span class="sd">                &quot;archive_frequency_unit&quot;: Hours</span>
<span class="sd">                }</span>

<span class="sd">            archive_day (dictionary): dictionary containing values of backup days for backup</span>
<span class="sd">                window</span>
<span class="sd">                Eg. - archive_day = dict.fromkeys([&#39;1&#39;, &#39;2&#39;, &#39;3&#39;], 1)</span>

<span class="sd">            archive_duration (dictionary): dictionary containing values of excluded backup</span>
<span class="sd">                time for backup window</span>
<span class="sd">                Eg. - archive_duration = dict.fromkeys([&#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;], 1)</span>

<span class="sd">            archiving_rules (dictionary):   dictionary containing values of diskcleanup/archiving rules</span>
<span class="sd">                Eg. -   archiving_rules = {</span>
<span class="sd">                &quot;last_accessed_unit&quot;:   &quot;days&quot;,</span>
<span class="sd">                &quot;last_accessed&quot;: 2,</span>
<span class="sd">                &quot;last_modified_unit&quot;: &quot;hours&quot;,</span>
<span class="sd">                &quot;last_modified&quot;: 3,</span>
<span class="sd">                &quot;file_size&quot;: 20,</span>
<span class="sd">                &quot;file_size_unit&quot;: &quot;KB&quot;</span>
<span class="sd">                }</span>

<span class="sd">            allow_override (dictionary): dictionary containing values for Override parameters</span>
<span class="sd">                Eg. - allow_override = {&quot;Storage_pool&quot;: &quot;Override required&quot;,</span>
<span class="sd">                                        &quot;RPO&quot;: &quot;Override optional&quot;}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">select_hyperlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.createProfile&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__click_plan_type</span><span class="p">(</span><span class="s1">&#39;CreateArchivePlan&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__set_plan_name</span><span class="p">(</span><span class="n">plan_name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">select_hyperlink</span><span class="p">(</span><span class="s2">&quot;Add&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__drop_down</span><span class="o">.</span><span class="n">select_drop_down_values</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="n">storage</span><span class="p">[</span><span class="s1">&#39;pri_storage&#39;</span><span class="p">]])</span>

        <span class="k">if</span> <span class="n">storage</span><span class="p">[</span><span class="s1">&#39;pri_ret_period&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">storage</span><span class="p">[</span><span class="s1">&#39;pri_ret_period&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s1">&#39;Infinite&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__set_retention_unit</span><span class="p">(</span><span class="n">storage</span><span class="p">[</span><span class="s1">&#39;ret_unit&#39;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__set_retention_period</span><span class="p">(</span><span class="n">storage</span><span class="p">[</span><span class="s1">&#39;pri_ret_period&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">submit_form</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">rpo</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rpo</span><span class="p">[</span><span class="s1">&#39;archive_frequency&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;rpo&quot;</span><span class="p">,</span> <span class="n">rpo</span><span class="p">[</span><span class="s1">&#39;archive_frequency&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">rpo</span><span class="p">[</span><span class="s1">&#39;archive_frequency_unit&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__select_archive_frequency_unit</span><span class="p">(</span><span class="n">rpo</span><span class="p">[</span><span class="s1">&#39;archive_frequency_unit&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">archive_day</span> <span class="ow">and</span> <span class="n">archive_duration</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__open_edit_backup_window_dialog</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__set_backup_window</span><span class="p">(</span><span class="n">archive_day</span><span class="p">,</span> <span class="n">archive_duration</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">archiving_rules</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">archiving_rules</span><span class="p">[</span><span class="s1">&#39;last_accessed&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__select_access_time_rule</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;accessedAgo&quot;</span><span class="p">,</span> <span class="n">archiving_rules</span><span class="p">[</span><span class="s1">&#39;last_accessed&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">archiving_rules</span><span class="p">[</span><span class="s1">&#39;last_accessed_unit&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__select_last_accessed_unit</span><span class="p">(</span><span class="n">archiving_rules</span><span class="p">[</span><span class="s1">&#39;last_accessed_unit&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">archiving_rules</span><span class="p">[</span><span class="s1">&#39;last_modified&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__select_modify_time_rule</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;accessedAgo&quot;</span><span class="p">,</span> <span class="n">archiving_rules</span><span class="p">[</span><span class="s1">&#39;last_modified&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">archiving_rules</span><span class="p">[</span><span class="s1">&#39;last_modified_unit&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__select_last_modified_unit</span><span class="p">(</span><span class="n">archiving_rules</span><span class="p">[</span><span class="s1">&#39;last_modified_unit&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">archiving_rules</span><span class="p">[</span><span class="s1">&#39;file_size&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">,</span> <span class="n">archiving_rules</span><span class="p">[</span><span class="s1">&#39;file_size&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">archiving_rules</span><span class="p">[</span><span class="s1">&#39;file_size_unit&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__select_file_size_unit</span><span class="p">(</span><span class="n">archiving_rules</span><span class="p">[</span><span class="s1">&#39;file_size_unit&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">allow_override</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__expand_sub_panel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.overrideRestrictions&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__enable_allow_override</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_override_options</span><span class="p">(</span><span class="n">allow_override</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;//*[@id=&#39;archivalPlanTemplate_button_#4019&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">check_error_message</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">create_office365_plan</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">plan_name</span><span class="p">,</span>
            <span class="n">retention</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">backup_archive_mailbox</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">set_content_search</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">generate_previews</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">set_entity_search</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">backup_all_versions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">onedrive_filters</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to create Office365 Plan</span>

<span class="sd">        Args:</span>
<span class="sd">            plan_name (str):                Name of the plan</span>

<span class="sd">            retention (dict):               How long the backed up data should be retained</span>
<span class="sd">                                            Eg: retention = {&#39;ret_period&#39;: &#39;365&#39;,</span>
<span class="sd">                                                             &#39;ret_unit&#39;: &#39;day(s)&#39;}</span>

<span class="sd">            backup_archive_mailbox (bool):  Whether or not archive mailbox has to be backed up</span>

<span class="sd">            set_content_search (bool):      Whether or not Content Search has to be enabled</span>

<span class="sd">            generate_previews (bool):       Whether or not Pre-generate previews has to be enabled</span>

<span class="sd">            set_entity_search (bool):       Whether or not Entity Search has to be enabled</span>

<span class="sd">            backup_all_versions (bool):     Whether or not all versions have to be backed up</span>

<span class="sd">            onedrive_filters (dict):        Filters that have to be applied</span>
<span class="sd">                                            Eg: filters = {&#39;include_folders&#39;: [&#39;test_folder&#39;],</span>
<span class="sd">                                                           &#39;include_files&#39;: [&#39;*.log&#39;, &#39;test_file.txt&#39;]}</span>
<span class="sd">                                            Eg: filters = {&#39;exclude_folders&#39;: [&#39;test_folder&#39;],</span>
<span class="sd">                                                           &#39;exclude_files&#39;: [&#39;*.log&#39;, &#39;test_file.txt&#39;]}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">select_hyperlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.createProfile&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__click_plan_type</span><span class="p">(</span><span class="s1">&#39;CreateOffice365Plan&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__set_plan_name</span><span class="p">(</span><span class="n">plan_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">backup_archive_mailbox</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">enable_toggle</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cv_toggle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">retention</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">retention</span><span class="p">[</span><span class="s1">&#39;ret_period&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;Infinite&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__select_radio_by_id</span><span class="p">(</span><span class="s1">&#39;retainBasedOnDeletionTime&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__set_office365_retention_period</span><span class="p">(</span><span class="n">retention</span><span class="p">[</span><span class="s1">&#39;ret_period&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">retention</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ret_unit&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">select_value_from_dropdown</span><span class="p">(</span>
                        <span class="n">select_id</span><span class="o">=</span><span class="s1">&#39;cvTimeRelativePicker_isteven-multi-select_#6209&#39;</span><span class="p">,</span>
                        <span class="n">value</span><span class="o">=</span><span class="n">retention</span><span class="p">[</span><span class="s1">&#39;ret_unit&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">set_content_search</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">enable_toggle</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cv_toggle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">generate_previews</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">enable_toggle</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">cv_toggle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">set_entity_search</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">enable_toggle</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">cv_toggle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">set_entity_search</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">enable_toggle</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">cv_toggle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">click_button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.save&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">check_error_message</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">backup_all_versions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">disable_toggle</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">cv_toggle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">disable_toggle</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">cv_toggle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">onedrive_filters</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__click_edit_onedrive_filters</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">onedrive_filters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;include_folders&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">onedrive_filters</span><span class="p">[</span><span class="s1">&#39;include_folders&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__add_include_folder_filter</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">onedrive_filters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude_folders&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">onedrive_filters</span><span class="p">[</span><span class="s1">&#39;exclude_folders&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__add_exclude_folder_filter</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">onedrive_filters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;include_files&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__click_file_filters_tab</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">onedrive_filters</span><span class="p">[</span><span class="s1">&#39;include_files&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__add_include_file_filter</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">onedrive_filters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exclude_files&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__click_file_filters_tab</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">onedrive_filters</span><span class="p">[</span><span class="s1">&#39;exclude_files&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__add_exclude_file_filter</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">click_button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.save&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__admin_console</span><span class="o">.</span><span class="n">check_error_message</span><span class="p">()</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright Commvault Systems Inc. All Rights Reserved

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>