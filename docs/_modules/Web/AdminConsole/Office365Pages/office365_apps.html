

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Web.AdminConsole.Office365Pages.office365_apps &mdash; Commvault Automation 11.22 documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home" alt="Documentation Home"> Commvault Automation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"></div>
            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Commvault Automation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
      <li>Web.AdminConsole.Office365Pages.office365_apps</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for Web.AdminConsole.Office365Pages.office365_apps</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="c1"># --------------------------------------------------------------------------</span>
<span class="c1"># Copyright Commvault Systems, Inc.</span>
<span class="c1"># See LICENSE.txt in the project root for</span>
<span class="c1"># license information.</span>
<span class="c1"># --------------------------------------------------------------------------</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module provides the function or operations that can be used to run</span>
<span class="sd">testcases of Office365 module.</span>

<span class="sd">To begin, create an instance of Office365Apps for test case.</span>

<span class="sd">To initialize the instance, pass the testcase object to the Office365Apps class.</span>

<span class="sd">Call the required definition using the instance object.</span>

<span class="sd">This file consists of only one class Office365Apps.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">NoSuchElementException</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">ElementNotInteractableException</span>

<span class="kn">from</span> <span class="nn">AutomationUtils</span> <span class="kn">import</span> <span class="n">logger</span>
<span class="kn">from</span> <span class="nn">Web.AdminConsole.Components.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span> <span class="nn">Web.Common.page_object</span> <span class="kn">import</span> <span class="n">PageService</span><span class="p">,</span> <span class="n">WebAction</span>
<span class="kn">from</span> <span class="nn">Web.Common.exceptions</span> <span class="kn">import</span> <span class="n">CVWebAutomationException</span>
<span class="kn">from</span> <span class="nn">Web.AdminConsole.Components.dialog</span> <span class="kn">import</span> <span class="n">ModalDialog</span>
<span class="kn">from</span> <span class="nn">Web.AdminConsole.Components.panel</span> <span class="kn">import</span> <span class="n">DropDown</span><span class="p">,</span> <span class="n">PanelInfo</span>
<span class="kn">from</span> <span class="nn">Web.AdminConsole.Components.browse</span> <span class="kn">import</span> <span class="n">Browse</span>
<span class="kn">from</span> <span class="nn">Web.AdminConsole.AdminConsolePages.Jobs</span> <span class="kn">import</span> <span class="n">Jobs</span>


<div class="viewcode-block" id="Office365Apps"><a class="viewcode-back" href="../../../../source/Web.AdminConsole.Office365Pages.html#Web.AdminConsole.Office365Pages.office365_apps.Office365Apps">[docs]</a><span class="k">class</span> <span class="nc">Office365Apps</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class for all Office 365 Apps page&quot;&quot;&quot;</span>
<div class="viewcode-block" id="Office365Apps.AppType"><a class="viewcode-back" href="../../../../source/Web.AdminConsole.Office365Pages.html#Web.AdminConsole.Office365Pages.office365_apps.Office365Apps.AppType">[docs]</a>    <span class="k">class</span> <span class="nc">AppType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;App types for Office 365&quot;&quot;&quot;</span>
        <span class="n">exchange_online</span> <span class="o">=</span> <span class="s1">&#39;ADD_EXCHANGEONLINE_APP&#39;</span>
        <span class="n">share_point_online</span> <span class="o">=</span> <span class="s1">&#39;ADD_SHAREPOINT_ONLINE_APP&#39;</span>
        <span class="n">one_drive_for_business</span> <span class="o">=</span> <span class="s1">&#39;ADD_ONEDRIVE_FOR_BUSINESS_APP&#39;</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcinputs</span><span class="p">,</span> <span class="n">admin_console</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initializes the Office365Apps class instance</span>

<span class="sd">                Args:</span>
<span class="sd">                    tc (Object)  --  Testcase object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span> <span class="o">=</span> <span class="n">tcinputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span> <span class="o">=</span> <span class="n">admin_console</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span> <span class="o">=</span> <span class="n">admin_console</span><span class="o">.</span><span class="n">driver</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_LOG</span> <span class="o">=</span> <span class="n">logger</span><span class="o">.</span><span class="n">get_log</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modern_authentication</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newly_created_app_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modal_dialog</span> <span class="o">=</span> <span class="n">ModalDialog</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_stats_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># Required Components</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dropdown</span> <span class="o">=</span> <span class="n">DropDown</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_jobs</span> <span class="o">=</span> <span class="n">Jobs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_browse</span> <span class="o">=</span> <span class="n">Browse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="p">)</span>

        <span class="c1"># Call Localization method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">_load_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Users&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">users</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;Users&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">_create_app</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates app with given app type</span>

<span class="sd">                Args:</span>
<span class="sd">                    app_type  (basestring)  -- Type of app to create</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">add_apps_xpath</span> <span class="o">=</span> <span class="s2">&quot;//a[@id=&#39;ADD_APPS&#39;]&quot;</span>
        <span class="n">add_apps_new_id</span> <span class="o">=</span> <span class="s2">&quot;addOffice365App&quot;</span>
        <span class="n">exchange_online_xpath</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;//div[text()=&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.nav.exchangeOnline&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;]&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">check_if_entity_exists</span><span class="p">(</span><span class="s1">&#39;xpath&#39;</span><span class="p">,</span> <span class="n">add_apps_xpath</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">add_apps_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;//a[@id=&#39;&quot;</span> <span class="o">+</span> <span class="n">app_type</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="s2">&quot;&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">check_if_entity_exists</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">add_apps_new_id</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="n">add_apps_new_id</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">exchange_online_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">check_if_entity_exists</span><span class="p">(</span><span class="s1">&#39;link&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.add.office365&#39;</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_link_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.add.office365&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">exchange_online_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">app_type</span> <span class="o">==</span> <span class="n">Office365Apps</span><span class="o">.</span><span class="n">AppType</span><span class="o">.</span><span class="n">exchange_online</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_link_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;link.addExchangeOnline&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">app_type</span> <span class="o">==</span> <span class="n">Office365Apps</span><span class="o">.</span><span class="n">AppType</span><span class="o">.</span><span class="n">share_point_online</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_link_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;link.addSharePointOnline&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_link_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;link.addOneDriveforBusiness&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_click_create_azure_ad_app</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks create azure ad app button&quot;&quot;&quot;</span>
        <span class="n">create_azure_ad_app_xpath</span> <span class="o">=</span> <span class="s2">&quot;//button[@id=&#39;createOffice365App_button_#6055&#39;]&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">create_azure_ad_app_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_for_errors</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">_check_for_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks for any errors while creating app&quot;&quot;&quot;</span>
        <span class="n">error_xpaths</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;//div[@class=&#39;help-block&#39;]&quot;</span><span class="p">,</span>
            <span class="s2">&quot;//div[@ng-bind=&#39;addOffice365.appCreationErrorResponse&#39;]&quot;</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">xpath</span> <span class="ow">in</span> <span class="n">error_xpaths</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">check_if_entity_exists</span><span class="p">(</span><span class="s1">&#39;xpath&#39;</span><span class="p">,</span> <span class="n">xpath</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span>
                        <span class="s1">&#39;Error while creating the app: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                    <span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_click_authorize_now</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks on authorize now button&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">select_hyperlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;action.authorize.app&#39;</span><span class="p">])</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_switch_to_window</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Switch to specified window</span>

<span class="sd">                Args:</span>
<span class="sd">                    window (WebElement)  -- Window element to switch to</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">switch_to_window</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_enter_email</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">email</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Enter email in email type input</span>

<span class="sd">                Args:</span>
<span class="sd">                    email (basestring)  --  Microsoft Global Admin email</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">check_if_entity_exists</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;i0116&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s1">&#39;i0116&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_click_submit</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_enter_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Enter password into password type input</span>

<span class="sd">                Args:</span>
<span class="sd">                    password (basestring)  --  Global Admin password</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">check_if_entity_exists</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;i0118&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s1">&#39;i0118&#39;</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_click_submit</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_click_submit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Click submit type button&quot;&quot;&quot;</span>
        <span class="c1"># This xpath is used to click submit button on Microsoft login pop up window</span>
        <span class="n">ms_submit_xpath</span> <span class="o">=</span> <span class="s2">&quot;//input[@type=&#39;submit&#39;]&quot;</span>
        <span class="c1">#element = self._driver.find_element_by_xpath(&quot;//input[@type=&#39;submit&#39;]&quot;)</span>
        <span class="c1">#self._driver.execute_script(&quot;arguments[0].scrollIntoView();&quot;, element)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">scroll_into_view</span><span class="p">(</span><span class="n">ms_submit_xpath</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">ms_submit_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_get_new_app_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fetches the newly created Azure app name from MS permission dialog&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;//div[@class=&#39;row app-name&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

    <span class="nd">@WebAction</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">_authorize_permissions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">global_admin</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks authorize now and enables permissions for the app</span>

<span class="sd">            Args:</span>
<span class="sd">                global_admin (basestring)  --  Microsoft Global admin email id</span>
<span class="sd">                password (basestring)  --  Global admin password</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_authorize_now</span><span class="p">()</span>

        <span class="n">admin_console_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">window_handles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">azure_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">window_handles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_switch_to_window</span><span class="p">(</span><span class="n">azure_window</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_enter_email</span><span class="p">(</span><span class="n">global_admin</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_enter_password</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">newly_created_app_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_new_app_name</span><span class="p">()</span>

        <span class="c1"># Final Accept button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_submit</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_switch_to_window</span><span class="p">(</span><span class="n">admin_console_window</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

        <span class="c1"># Clicking multiple times is required sometimes</span>
        <span class="n">authorize_now_xpath</span> <span class="o">=</span> <span class="s2">&quot;//button[@id=&#39;createOffice365App_button_#1691&#39;]&quot;</span>
        <span class="n">attempts</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">check_if_entity_exists</span><span class="p">(</span><span class="s1">&#39;xpath&#39;</span><span class="p">,</span> <span class="n">authorize_now_xpath</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">attempts</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s2">&quot;Failed to grant permissions.&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Accept permissions button did not work. Trying again..&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_click_authorize_now</span><span class="p">()</span>

            <span class="n">admin_console_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">window_handles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">azure_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">window_handles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_switch_to_window</span><span class="p">(</span><span class="n">azure_window</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_click_submit</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_switch_to_window</span><span class="p">(</span><span class="n">admin_console_window</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

            <span class="n">attempts</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_click_show_details</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks the Show details link for Azure App&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">check_if_entity_exists</span><span class="p">(</span><span class="s2">&quot;link&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.showDetails&#39;</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">select_hyperlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.showDetails&#39;</span><span class="p">])</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_verify_modern_authentication</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verifies if app is created using modern authentication enabled.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_show_details</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">modern_xpath</span> <span class="o">=</span> <span class="s2">&quot;//div[@data-ng-if=&#39;addOffice365.office365Attributes.exchangeAttributes.onePassProp.isModernAuthEnabled&#39;]&quot;</span>
            <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">modern_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="k">if</span> <span class="s2">&quot;Using modern authentication&quot;</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">modern_authentication</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">modern_authentication</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_click_add_mailbox</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks on Add Mailbox button of office365 mail client&quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;//a[@id=&#39;addMailbox&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;//a[@id=&#39;undefined&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;//span[text()=&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.addMailbox&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_select_all_users</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Selects all the users associated with the app&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;// label[@class =&#39;k-checkbox-label k-no-text&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_click_backup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks the backup button on the app page&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">access_toolbar_menu</span><span class="p">(</span><span class="n">menu_id</span><span class="o">=</span><span class="s1">&#39;ARCHIVE_GRID&#39;</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_click_more_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks the more actions link on the app page&quot;&quot;&quot;</span>
        <span class="n">more_actions_xpath</span> <span class="o">=</span> <span class="s2">&quot;//li[@id=&#39;batch-action-menu_moreItem&#39;]&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">more_actions_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_click_restore_mailbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mailbox</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks the browse button on the app page</span>

<span class="sd">                mailbox (boolean)  --  If true mailbox is restored. If false messages are restored</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">restore_id</span> <span class="o">=</span> <span class="s1">&#39;RESTORE&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="n">restore_id</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">mailbox</span><span class="p">:</span>
            <span class="n">restore_mailbox_xpath</span> <span class="o">=</span> <span class="s2">&quot;//li[@id=&#39;batch-action-menu_RESTORE_MAILBOX&#39;]//a[@id=&#39;RESTORE_MAILBOX&#39;]&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">restore_mailbox_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">restore_mailbox_xpath</span> <span class="o">=</span> <span class="s2">&quot;//li[@id=&#39;batch-action-menu_BROWSE&#39;]//a[@id=&#39;BROWSE&#39;]&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">restore_mailbox_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_restore_messages</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_click_selectall_browse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks the Select all checkbox&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_browse</span><span class="o">.</span><span class="n">select_for_restore</span><span class="p">(</span><span class="n">all_files</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_restore_messages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Restores messages from browse window&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_selectall_browse</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">select_hyperlink</span><span class="p">(</span><span class="s2">&quot;Restore&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;//a[@class=&#39;nowrap&#39;]//span[text()=&#39;Items in current page&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_fetch_all_apps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fetches the list of apps from configuration page&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">refresh_page</span><span class="p">()</span>
        <span class="n">panel</span> <span class="o">=</span> <span class="n">PanelInfo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Exchange connection settings&#39;</span><span class="p">)</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">access_tab</span><span class="p">(</span><span class="n">tab_text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.azureApps&#39;</span><span class="p">])</span>
        <span class="n">details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">get_column_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.addAzureApp&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">details</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_verify_app</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verifies whether the newly created app is present in the list on configuration page&quot;&quot;&quot;</span>
        <span class="n">apps_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_all_apps</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Apps list:</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">apps_list</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">newly_created_app_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">apps_list</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s2">&quot;New app was not found in the list on configuration page&quot;</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_get_job_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fetches the jobID from the toast&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">get_jobid_from_popup</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_verify_connection_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verifies the text on the modal after verifying connection&quot;&quot;&quot;</span>
        <span class="n">modal_content_xpath</span> <span class="o">=</span> <span class="s2">&quot;//div[@class=&#39;form-group ng-scope&#39;]&quot;</span>
        <span class="n">modal_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">modal_content_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">modal_text</span> <span class="o">==</span> <span class="s1">&#39;The status of Azure apps has been updated.&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s1">&#39;Verify connection did not succeed.&#39;</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_add_plan_and_verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">change</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Changes exchange plan and verifies the same</span>

<span class="sd">                Args:</span>
<span class="sd">                    change (boolean)  --  True if it&#39;s a change plan operation</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">change</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;NewPlan&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_inline_o365_plan</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;ExchangePlan&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dropdown</span><span class="o">.</span><span class="n">select_drop_down_values</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="n">value</span><span class="p">],</span>
                                               <span class="n">drop_down_id</span><span class="o">=</span><span class="s1">&#39;exchangePlan_isteven-multi-select_#2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modal_dialog</span><span class="o">.</span><span class="n">click_submit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="n">notification</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">get_notification</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;Successfully updated&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">notification</span><span class="p">:</span>
            <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s1">&#39;Change exchange plan was not successful&#39;</span><span class="p">)</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_job_details</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Waits for job completion and gets the job details&quot;&quot;&quot;</span>
        <span class="n">job_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_job_id</span><span class="p">()</span>
        <span class="n">job_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_jobs</span><span class="o">.</span><span class="n">job_completion</span><span class="p">(</span><span class="n">job_id</span><span class="o">=</span><span class="n">job_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;job details: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">job_details</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">job_details</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;Status&#39;</span><span class="p">]]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Committed&quot;</span><span class="p">,</span> <span class="s2">&quot;Completed&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s1">&#39;Job did not complete successfully&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">job_details</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_get_app_stat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stat_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the stats from the app page</span>

<span class="sd">                Args:</span>
<span class="sd">                    stat_type (basestring)  --  Type of stat we want to fetch from App details page</span>
<span class="sd">                        Valid options:</span>
<span class="sd">                            Mails -- To fetch the number of mails displayed on App page</span>
<span class="sd">                            Mailboxes -- To fetch the number of mailboxes displayed on App page</span>
<span class="sd">                            Indexed mails -- To fetch the number of Indexed mails displayed on App page</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">stat_type</span> <span class="o">==</span> <span class="s1">&#39;Mails&#39;</span><span class="p">:</span>
            <span class="n">stat_type_temp</span> <span class="o">=</span> <span class="s1">&#39;Number of emails&#39;</span>
        <span class="k">elif</span> <span class="n">stat_type</span> <span class="o">==</span> <span class="s1">&#39;Mailboxes&#39;</span><span class="p">:</span>
            <span class="n">stat_type_temp</span> <span class="o">=</span> <span class="s1">&#39;number of mailboxes&#39;</span>
        <span class="k">elif</span> <span class="n">stat_type</span> <span class="o">==</span> <span class="s1">&#39;Indexed mails&#39;</span><span class="p">:</span>
            <span class="n">stat_type_temp</span> <span class="o">=</span> <span class="s1">&#39;Index collection&#39;</span>
        <span class="n">stat_xpath</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;//a[contains(@data-uib-tooltip, &#39;</span><span class="si">{</span><span class="n">stat_type_temp</span><span class="si">}</span><span class="s2">&#39;)]/span[@ng-bind=&#39;entity.value&#39;]&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">stat_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_click_view_jobs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks the view jobs link from the app page&quot;&quot;&quot;</span>
        <span class="n">view_jobs_xpath</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;//span[text()=&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;action.jobs&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;]&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">view_jobs_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_click_view_exports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks the view jobs link from the app page&quot;&quot;&quot;</span>
        <span class="n">view_exports_xpath</span> <span class="o">=</span> <span class="s2">&quot;//span[text()=&#39;View exports&#39;]&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">view_exports_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_create_inline_o365_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create Office365 plan from edit association modal&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s1">&#39;createNewPlanInline&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s1">&#39;planName&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;NewPlan&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modal_dialog</span><span class="o">.</span><span class="n">click_submit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_click_exclude_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks the exclude plan button on action menu&quot;&quot;&quot;</span>
        <span class="n">exclude_plan_xpath</span> <span class="o">=</span> <span class="s2">&quot;//li[@id=&#39;exchangeMBListTable_actionContextMenu_DISABLE&#39;]//a[@id=&#39;DISABLE&#39;]&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">exclude_plan_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_click_change_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks the change plan button on action menu&quot;&quot;&quot;</span>
        <span class="n">change_plan_xpath</span> <span class="o">=</span> <span class="s2">&quot;//li[@id=&#39;exchangeMBListTable_actionContextMenu_ADD_PLAN&#39;]//a[@id=&#39;ADD_PLAN&#39;]&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">change_plan_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_click_exclude_user</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks the exclude user button under action context menu&quot;&quot;&quot;</span>
        <span class="n">exclude_user_xpath</span> <span class="o">=</span> <span class="s2">&quot;//li[@id=&#39;exchangeMBListTable_actionContextMenu_DISABLE&#39;]//a[@id=&#39;DISABLE&#39;]&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">exclude_user_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_click_remove_content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks on the remove content button under action menu&quot;&quot;&quot;</span>
        <span class="n">remove_content_xpath</span> <span class="o">=</span> <span class="s2">&quot;//li[@id=&#39;exchangeMBListTable_actionContextMenu_DELETE&#39;]//a[@id=&#39;DELETE&#39;]&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">remove_content_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_click_batch_change_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks the change plan button from Manage content&quot;&quot;&quot;</span>
        <span class="n">change_plan_xpath</span> <span class="o">=</span> <span class="s2">&quot;//li[@id=&#39;batch-action-menu_moreContextMenu_ADD_PLAN&#39;]//a[@id=&#39;ADD_PLAN&#39;]&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">change_plan_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_click_manage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks on the manage button under more actions&quot;&quot;&quot;</span>
        <span class="n">manage_xpath</span> <span class="o">=</span> <span class="s2">&quot;//li[@id=&#39;batch-action-menu_moreContextMenu_MANAGE&#39;]//a[@id=&#39;MANAGE&#39;]&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">manage_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_get_mb_refresh_error_msg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the Mailbox refresh error message&quot;&quot;&quot;</span>
        <span class="n">mailbox_refresh_error_xpath</span> <span class="o">=</span> <span class="s2">&quot;//p[@class=&#39;serverMessage error&#39;]&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">mailbox_refresh_error_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_click_mb_modal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks the close button on Add user modal&quot;&quot;&quot;</span>
        <span class="n">close_id</span> <span class="o">=</span> <span class="s2">&quot;createNewAssociation_button_#4219&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="n">close_id</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_all_office365_apps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of all App Names</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">get_column_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.name&#39;</span><span class="p">])</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">access_office365_app</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Accesses the Office365 app from the Office365 landing page</span>

<span class="sd">                Args:</span>
<span class="sd">                    app_name (basestring)  --  Name of the Office365 app to access</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">access_link</span><span class="p">(</span><span class="n">app_name</span><span class="p">)</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">check_if_app_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks if the given app already exists</span>

<span class="sd">                Args:</span>
<span class="sd">                    app_name (basestring)  --  Name of the Office365 app to check</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">search_for</span><span class="p">(</span><span class="n">app_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">check_if_entity_exists</span><span class="p">(</span><span class="s1">&#39;link&#39;</span><span class="p">,</span> <span class="n">app_name</span><span class="p">)</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">create_office365_app</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_out</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">poll_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates O365 App</span>

<span class="sd">        Args:</span>

<span class="sd">            time_out (int): Time out for app creation</span>

<span class="sd">            poll_interval (int): Regular interval for app creating check</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># General Required details</span>
        <span class="n">app_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;office_app_type&#39;</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_all_office365_apps</span><span class="p">()):</span>
            <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s2">&quot;App name already exists&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_create_app</span><span class="p">(</span><span class="n">app_type</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">app_type</span> <span class="o">==</span> <span class="n">Office365Apps</span><span class="o">.</span><span class="n">AppType</span><span class="o">.</span><span class="n">exchange_online</span><span class="p">:</span>
            <span class="c1"># Required details for Exchange Online</span>
            <span class="n">server_plan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;ServerPlan&#39;</span><span class="p">]</span>
            <span class="n">index_server</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;IndexServer&#39;</span><span class="p">]</span>
            <span class="n">access_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;AccessNode&#39;</span><span class="p">]</span>
            <span class="n">global_admin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;GlobalAdmin&#39;</span><span class="p">]</span>
            <span class="n">password</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;Password&#39;</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s1">&#39;appName&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_dropdown</span><span class="o">.</span><span class="n">select_drop_down_values</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="n">server_plan</span><span class="p">],</span>
                                                   <span class="n">drop_down_id</span><span class="o">=</span><span class="s1">&#39;planSummaryDropdown&#39;</span><span class="p">)</span>

            <span class="c1"># Check if infrastructure settings are inherited from plan or not</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">check_if_entity_exists</span><span class="p">(</span><span class="s1">&#39;xpath&#39;</span><span class="p">,</span>
                                                          <span class="s2">&quot;//button[contains(@id, &#39;indexServers&#39;)]&quot;</span>
                                                          <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dropdown</span><span class="o">.</span><span class="n">select_drop_down_values</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="n">index_server</span><span class="p">],</span>
                                                       <span class="n">drop_down_id</span><span class="o">=</span><span class="s1">&#39;createOffice365App_isteven-multi-select_#2568&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dropdown</span><span class="o">.</span><span class="n">select_drop_down_values</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="n">access_node</span><span class="p">],</span>
                                                       <span class="n">drop_down_id</span><span class="o">=</span><span class="s1">&#39;createOffice365App_isteven-multi-select_#5438&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dropdown</span><span class="o">.</span><span class="n">select_drop_down_values</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">]],</span>
                                                       <span class="n">drop_down_id</span><span class="o">=</span><span class="s1">&#39;createOffice365App_isteven-multi-select_#1167&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s1">&#39;globalUserName&#39;</span><span class="p">,</span> <span class="n">global_admin</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="s1">&#39;globalPassword&#39;</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_click_create_azure_ad_app</span><span class="p">()</span>

            <span class="n">attempts</span> <span class="o">=</span> <span class="n">time_out</span> <span class="o">//</span> <span class="n">poll_interval</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">attempts</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s1">&#39;App creation exceeded stipulated time.&#39;</span>
                                                   <span class="s1">&#39;Test case terminated.&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;App creation is in progress..&quot;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_check_for_errors</span><span class="p">()</span>

                <span class="c1"># Check authorize app available</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">check_if_entity_exists</span><span class="p">(</span><span class="s2">&quot;link&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;action.authorize.app&#39;</span><span class="p">]):</span>
                    <span class="k">break</span>

                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">poll_interval</span><span class="p">)</span>
                <span class="n">attempts</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_verify_modern_authentication</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_authorize_permissions</span><span class="p">(</span><span class="n">global_admin</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">submit_form</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># Wait for AdMailboxMonitor to launch in proxy server</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">delete_office365_app</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes the office365 app</span>
<span class="sd">                Args:</span>
<span class="sd">                    app_name (str)  --  Name of the office365 app to delete</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">steps</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;action.releaseLicense&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;action.delete&#39;</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">access_action_item</span><span class="p">(</span><span class="n">app_name</span><span class="p">,</span> <span class="n">steps</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_modal_dialog</span><span class="o">.</span><span class="n">click_submit</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">add_user</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds user to the office365 app&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_click_add_mailbox</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
            <span class="n">mailbox_refresh_error_xpath</span> <span class="o">=</span> <span class="s2">&quot;//p[@class=&#39;serverMessage error&#39;]&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">check_if_entity_exists</span><span class="p">(</span><span class="s1">&#39;link&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;action.refresh&#39;</span><span class="p">]):</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">select_hyperlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;action.refresh&#39;</span><span class="p">])</span>
                <span class="k">break</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">check_if_entity_exists</span><span class="p">(</span><span class="s1">&#39;xpath&#39;</span><span class="p">,</span> <span class="n">mailbox_refresh_error_xpath</span><span class="p">):</span>
                <span class="n">error_message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_mb_refresh_error_msg</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">error_message</span> <span class="o">==</span> <span class="s2">&quot;The mailbox list is getting refreshed. Please check back in few minutes.&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_click_mb_modal</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
                    <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dropdown</span><span class="o">.</span><span class="n">select_drop_down_values</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;ExchangePlan&#39;</span><span class="p">]],</span>
                                               <span class="n">drop_down_id</span><span class="o">=</span><span class="s1">&#39;exchangePlan_isteven-multi-select_#2&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">:</span>
            <span class="n">search_element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s1">&#39;searchInput&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">search_element</span><span class="o">.</span><span class="n">is_displayed</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">fill_form_by_id</span><span class="p">(</span><span class="n">element_id</span><span class="o">=</span><span class="s1">&#39;searchInput&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">user</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">select_rows</span><span class="p">([</span><span class="n">user</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">submit_form</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">run_backup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Runs backup by selecting all the associated users to the app&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_select_all_users</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_backup</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modal_dialog</span><span class="o">.</span><span class="n">click_submit</span><span class="p">()</span>
        <span class="n">job_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_job_details</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;job details: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">job_details</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backedup_mails</span> <span class="o">=</span> <span class="n">job_details</span><span class="p">[</span><span class="s1">&#39;Number of files transferred&#39;</span><span class="p">]</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">add_azure_app_and_verify</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a new azure app from configuration page and verifies it&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">select_configuration_tab</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">select_hyperlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;dialog.azureapp.title&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modal_dialog</span><span class="o">.</span><span class="n">click_submit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_authorize_permissions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;GlobalAdmin&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;Password&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modal_dialog</span><span class="o">.</span><span class="n">click_cancel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_verify_app</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">add_service_account</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a new Service account from configuration page and verifies it&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">select_configuration_tab</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">select_hyperlink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.addServiceAccount&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modal_dialog</span><span class="o">.</span><span class="n">click_submit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">verify_app_config_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verifies the configuration values on app configuration page against the input values provided&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">select_configuration_tab</span><span class="p">()</span>
        <span class="n">general_panel</span> <span class="o">=</span> <span class="n">PanelInfo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.generalPane&#39;</span><span class="p">])</span>
        <span class="n">details</span> <span class="o">=</span> <span class="n">general_panel</span><span class="o">.</span><span class="n">get_details</span><span class="p">()</span>
        <span class="n">global_admin</span> <span class="o">=</span> <span class="n">details</span><span class="p">[</span><span class="s1">&#39;Global Administrator&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">global_admin</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;GlobalAdmin&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s2">&quot;Global admin value is incorrect on configuration page&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">details</span><span class="p">[</span><span class="s1">&#39;Use modern authentication&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ON&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s2">&quot;Modern authentication toggle on configuration page is disabled.&quot;</span><span class="p">)</span>

        <span class="n">infra_panel</span> <span class="o">=</span> <span class="n">PanelInfo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.infrastructurePane&#39;</span><span class="p">])</span>
        <span class="n">infra_details</span> <span class="o">=</span> <span class="n">infra_panel</span><span class="o">.</span><span class="n">get_details</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">infra_details</span><span class="p">[</span><span class="s1">&#39;Server plan&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;ServerPlan&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s2">&quot;Server plan value is incorrect on configuration page&quot;</span><span class="p">)</span>
        <span class="n">access_node</span> <span class="o">=</span> <span class="n">infra_details</span><span class="p">[</span><span class="s1">&#39;Access nodes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">access_node</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;AccessNode&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s2">&quot;Access node value is incorrect on configuration page&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">[</span><span class="s1">&#39;IndexServer&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">infra_details</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s2">&quot;Index server value is incorrect on configuration page&quot;</span><span class="p">)</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">run_restore</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mailbox</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Runs the restore by selecting all users associated to the app</span>

<span class="sd">                Args:</span>
<span class="sd">                    mailbox  (Boolean)  --  Whether to restore mailbox or messages</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_select_all_users</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_restore_mailbox</span><span class="p">(</span><span class="n">mailbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">submit_form</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">job_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_job_details</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;job details: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">job_details</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restored_mails</span> <span class="o">=</span> <span class="n">job_details</span><span class="p">[</span><span class="s1">&#39;Number of files transferred&#39;</span><span class="p">]</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">verify_backedup_mails</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verifies whether backed up mails number is correct&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">backedup_mails</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">restored_mails</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s2">&quot;Number of mails in the mailbox and &quot;</span>
                                           <span class="s2">&quot;number of backed up messages on command center are not matching&quot;</span><span class="p">)</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">verify_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verifies the Azure app connection from configuration tab&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">select_configuration_tab</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">select_hyperlink</span><span class="p">(</span><span class="s2">&quot;Verify connection &quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_verify_connection_text</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modal_dialog</span><span class="o">.</span><span class="n">click_submit</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">verify_added_users</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verifies the users added to the app as against the input file&quot;&quot;&quot;</span>
        <span class="n">user_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">get_column_data</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;Email address&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">user_list</span><span class="p">)</span> <span class="o">==</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s2">&quot;User list on the app page does not match the input file user list&quot;</span><span class="p">)</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">change_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Changes the exchange plan for office365 user&quot;&quot;&quot;</span>

        <span class="c1"># Changing plan for all users using more actions link</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_select_all_users</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_more_actions</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_manage</span><span class="p">()</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_batch_change_plan</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_plan_and_verify</span><span class="p">(</span><span class="n">change</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Changing plan for an individual user</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">access_action_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.manage&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_change_plan</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_plan_and_verify</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">run_ci_job</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Runs the content indexing job and verifies job completes successfully&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_select_all_users</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_more_actions</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_ci_path</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modal_dialog</span><span class="o">.</span><span class="n">click_submit</span><span class="p">()</span>
        <span class="n">job_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_job_details</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indexed_mails</span> <span class="o">=</span> <span class="n">job_details</span><span class="p">[</span><span class="s1">&#39;Number of files transferred&#39;</span><span class="p">]</span>

    <span class="nd">@WebAction</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_click_ci_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clicks the content indexing job link&quot;&quot;&quot;</span>
        <span class="n">ci_xpath</span> <span class="o">=</span> <span class="s2">&quot;//li[@id=&#39;batch-action-menu_moreContextMenu_RUN_CONTENT_INDEXING_GRID&#39;]//a[@id=&#39;RUN_CONTENT_INDEXING_GRID&#39;]&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="n">ci_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">verify_app_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the stats from app page</span>

<span class="sd">                Raises:</span>
<span class="sd">                    Exception if stats do not match that of input file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_stats_dict</span><span class="p">[</span><span class="s1">&#39;Mails&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_app_stat</span><span class="p">(</span><span class="n">stat_type</span><span class="o">=</span><span class="s1">&#39;Mails&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_stats_dict</span><span class="p">[</span><span class="s1">&#39;Mailboxes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_app_stat</span><span class="p">(</span><span class="n">stat_type</span><span class="o">=</span><span class="s1">&#39;Mailboxes&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_stats_dict</span><span class="p">[</span><span class="s1">&#39;Indexed Mails&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_app_stat</span><span class="p">(</span><span class="n">stat_type</span><span class="o">=</span><span class="s1">&#39;Indexed mails&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">))</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_stats_dict</span><span class="p">[</span><span class="s1">&#39;Mailboxes&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s1">&#39;Mailboxes app stat is not matching with input file users&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_stats_dict</span><span class="p">[</span><span class="s1">&#39;Mails&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">backedup_mails</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s1">&#39;Mails app stat is not matching with backed up files from job details&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_stats_dict</span><span class="p">[</span><span class="s1">&#39;Indexed Mails&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexed_mails</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s1">&#39;Indexed Mails app stat is not matching with Indexed files from job details&#39;</span><span class="p">)</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">remove_from_content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes the content from app</span>

<span class="sd">                Raises:</span>
<span class="sd">                    Exception if user removal is unsuccessful</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get the list of existing users</span>
        <span class="n">user_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">get_column_data</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;column.email&#39;</span><span class="p">])</span>
        <span class="c1"># Now remove one user from the app</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">access_action_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.manage&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_remove_content</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modal_dialog</span><span class="o">.</span><span class="n">click_submit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="c1"># Verify that user was removed</span>
        <span class="n">user_list_new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">get_column_data</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;column.email&#39;</span><span class="p">])</span>
        <span class="n">diff_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">user_list</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">user_list_new</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">diff_list</span> <span class="ow">and</span> <span class="n">diff_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;user </span><span class="si">{</span><span class="n">diff_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1"> was removed from the app&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">diff_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s1">&#39;There was an error in removing user&#39;</span><span class="p">)</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">exclude_user</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;excludes the user from backup&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">access_action_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.manage&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_exclude_user</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modal_dialog</span><span class="o">.</span><span class="n">click_submit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">view_jobs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verifies the view jobs page from the app&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">access_tab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.mailboxes&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_view_jobs</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">select_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;All Users&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Selects the auto discover content</span>

<span class="sd">                Args:</span>
<span class="sd">                    content_type (str)  --  Type of auto discovery content</span>
<span class="sd">                        Valid Options:</span>
<span class="sd">                            All Users</span>
<span class="sd">                            All Public Folders</span>
<span class="sd">                            All O365 Group Mailboxes</span>
<span class="sd">                        Default:</span>
<span class="sd">                            All Users</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">access_tab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.content&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">select_rows</span><span class="p">([</span><span class="n">content_type</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">access_action_item</span><span class="p">(</span><span class="n">content_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.manage&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_change_plan</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_plan_and_verify</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">deselect_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;All Users&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Disables the auto discover content</span>

<span class="sd">                Args:</span>
<span class="sd">                    content_type (str)  --  Type of auto discovery content</span>
<span class="sd">                        Valid Options:</span>
<span class="sd">                            All Users</span>
<span class="sd">                            All Public Folders</span>
<span class="sd">                            All O365 Group Mailboxes</span>
<span class="sd">                        Default:</span>
<span class="sd">                            All Users</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">access_tab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.content&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">access_action_item</span><span class="p">(</span><span class="n">content_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.manage&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_exclude_plan</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modal_dialog</span><span class="o">.</span><span class="n">click_submit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">verify_content_association</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verifies whether all user association is properly added in command center</span>

<span class="sd">                Args:</span>
<span class="sd">                    content_list (List)  --  List of users or AD groups</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">access_tab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.mailboxes&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">wait_for_completion</span><span class="p">()</span>
        <span class="n">users_from_local_db</span> <span class="o">=</span> <span class="n">content_list</span>
        <span class="n">local_db_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">users_from_local_db</span><span class="p">)</span>
        <span class="n">cc_user_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">get_total_rows_count</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">cc_user_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">cc_user_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">get_column_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;column.email&#39;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Total rows count: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">cc_user_count</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;User from local db count : </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">local_db_count</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">local_db_count</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">cc_user_count</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Users from local db: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">users_from_local_db</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s2">&quot;All User association had mismatch of number of Users&quot;</span><span class="p">)</span>

    <span class="nd">@PageService</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">verify_content_deassociation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verifies whether the content is deassociated&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">access_tab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_admin_console</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;label.mailboxes&#39;</span><span class="p">])</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cc_user_count</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__table</span><span class="o">.</span><span class="n">get_total_rows_count</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">cc_user_count</span> <span class="o">!=</span> <span class="s1">&#39;0&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CVWebAutomationException</span><span class="p">(</span><span class="s2">&quot;Auto discovery de-association has some issues. Users/groups were not removed.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">NoSuchElementException</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;NoSuchElementException caught. In this case it means content has been deassociated.Positive&quot;</span><span class="p">)</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Commvault Systems Inc. All Rights Reserved

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>