

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>FileSystem.FSUtils.ibmihelper &mdash; Commvault Automation 11.23 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> Commvault Automation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"></div>
            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Commvault Automation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>FileSystem.FSUtils.ibmihelper</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for FileSystem.FSUtils.ibmihelper</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># --------------------------------------------------------------------------</span>
<span class="c1"># Copyright Commvault Systems, Inc.</span>
<span class="c1"># See LICENSE.txt in the project root for</span>
<span class="c1"># license information.</span>
<span class="c1"># --------------------------------------------------------------------------</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Helper file for performing IBMi File System operations</span>
<span class="sd">IBMiHelper: Helper class to perform file system operations which derives from the UnixFSHelper.</span>

<span class="sd">IBMiHelper</span>
<span class="sd">==========</span>

<span class="sd">    __init__()                      --  initializes IBMi helper object</span>

<span class="sd">    num_libraries()                 --  Returns the number of libraries that are generated.</span>

<span class="sd">    get_subclient_content()         --  Generates the subclient content list.</span>

<span class="sd">    add_new_data_incr()             --  Adds new data for incremental backups</span>

<span class="sd">    mod_data_incr()                 --  Modifies the data added by add_new_data_incr</span>

<span class="sd">    run_restore_verify()            --  Initiates restore for data</span>
<span class="sd">                                        backed up in the given job</span>
<span class="sd">                                        and performs the applicable verifications</span>

<span class="sd">    run_find_verify()               --  Finds items backed up in the given job</span>
<span class="sd">                                        and compares it with items from machine</span>

<span class="sd">    run_complete_restore_verify()   --  Initiates restore of complete /QSYS.LIB data backed up for</span>
<span class="sd">                                        this subclient</span>

<span class="sd">    set_client_side_deduplication() --  Set subclient property to perform client side deduplication</span>

<span class="sd">    set_object_level_backup()       --  Set the subclient property to backup data as objects.</span>

<span class="sd">    get_log_directory()             --  Returns the log directory of the IBMi client</span>

<span class="sd">    verify_from_log()               --  Parse the log file to match a regular expression.</span>

<span class="sd">    update_filter_and_exception()   --  Updates the subclient&#39;s filter and exception content.</span>

<span class="sd">    get_wildcard_content()          --  Returns a wildcard content for subclient.</span>

<span class="sd">    enable_synclib()                --  Enables synclib for subclient.</span>

<span class="sd">    create_ibmi_dr_subclient()      --  Create IBMi DR subclient with IBMi specific parameters</span>

<span class="sd">    set_savf_file_backup()          --  Enable SAVF file backups for an IBMi subclient</span>

<span class="sd">    configure_ibmi_default_sc()      --  Creates new backupset, check pre-defined subclient</span>
<span class="sd">                                            and set with specified parameters</span>
<span class="sd">                                            under the current testcase Instance.</span>

<span class="sd">    compare_ibmi_data()             --  Function to perform meta data comparision &amp; Checksum</span>
<span class="sd">                                            comparision of source and destination paths.</span>

<span class="sd">    verify_sc_defaults()            --  Function to verify all the default subclient options.</span>

<span class="sd">    set_ibmi_sc_options()           -- Function to set IBMi specific options to subclient.</span>

<span class="sd">    verify_ibmi_sc_options()        -- Function to verify subclient options in client logs.</span>

<span class="sd">Attributes</span>
<span class="sd">----------</span>

<span class="sd">    **num_libraries**               --  The number of libraries created for this testcase</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">FileSystem.FSUtils.fshelper</span> <span class="kn">import</span> <span class="n">ScanType</span>
<span class="kn">from</span> <span class="nn">FileSystem.FSUtils.unixfshelper</span> <span class="kn">import</span> <span class="n">UnixFSHelper</span>


<div class="viewcode-block" id="IBMiHelper"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper">[docs]</a><span class="k">class</span> <span class="nc">IBMiHelper</span><span class="p">(</span><span class="n">UnixFSHelper</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Helper class to perform file system operations&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">testcase</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize instance of the IBMi Helper class.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IBMiHelper</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">testcase</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_num_libraries</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">testcase</span><span class="o">.</span><span class="n">tcinputs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumLibraries&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">))</span>
        <span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">initialize_param_from_testcase</span><span class="p">(</span><span class="n">testcase</span><span class="o">.</span><span class="n">tcinputs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_testcaseid</span> <span class="o">=</span> <span class="n">testcase</span><span class="o">.</span><span class="n">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lfs_backup</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_incr_path</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_libraries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the number of libraries that are generated for this test&quot;&quot;&quot;</span>
        <span class="c1"># Never change this value, so we always have a reference as to how many libraries we</span>
        <span class="c1"># initially started the testcase with.  Hence no setter method for this.</span>
        <span class="c1"># To increase the number of libraries on client, update the IBMIMachine::num_libraries</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_libraries</span>

<div class="viewcode-block" id="IBMiHelper.get_subclient_content"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.get_subclient_content">[docs]</a>    <span class="k">def</span> <span class="nf">get_subclient_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_path</span><span class="p">,</span> <span class="n">slash_format</span><span class="p">,</span> <span class="n">subclient_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates the subclient content list. For IFS, calls the unix implementation.</span>

<span class="sd">        Args:</span>
<span class="sd">            test_path           (str)   : The test path provided for the test case</span>

<span class="sd">            slash_format        (str)   : The slash format for the platform</span>

<span class="sd">            subclient_name      (str)   : The name of the subclient for which data is generated.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list : list of subclient contents for this test case</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">if</span> <span class="s1">&#39;/QSYS.LIB&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">test_path</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">IBMiHelper</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_subclient_content</span><span class="p">(</span><span class="n">test_path</span><span class="p">,</span>
                                                                 <span class="n">slash_format</span><span class="p">,</span>
                                                                 <span class="n">subclient_name</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">itr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">num_libraries</span><span class="p">):</span>
            <span class="n">sub_lib</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}{1}</span><span class="s1">AL</span><span class="si">{2}{3}</span><span class="s1">.LIB&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">test_path</span><span class="p">,</span>
                                                  <span class="n">slash_format</span><span class="p">,</span>
                                                  <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_testcaseid</span><span class="p">),</span>
                                                  <span class="nb">str</span><span class="p">(</span><span class="n">itr</span><span class="p">)[:</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_lib</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">remove_directory</span><span class="p">(</span><span class="n">sub_lib</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">temp</span></div>

<div class="viewcode-block" id="IBMiHelper.add_new_data_incr"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.add_new_data_incr">[docs]</a>    <span class="k">def</span> <span class="nf">add_new_data_incr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                          <span class="n">incr_path</span><span class="p">,</span>
                          <span class="n">slash_format</span><span class="p">,</span>
                          <span class="n">scan_type</span><span class="o">=</span><span class="n">ScanType</span><span class="o">.</span><span class="n">RECURSIVE</span><span class="p">,</span>
                          <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds new data for incremental. For IFS paths, this will call the UnixFsHelper</span>
<span class="sd">        implementation with provisions for modification after this function execution call</span>
<span class="sd">        mod_data_incr for modifications</span>

<span class="sd">        Args:</span>
<span class="sd">            incr_path           (str)   : path for adding data</span>

<span class="sd">            slash_format        (str)   : OS path separator format</span>

<span class="sd">            scan_type           (str)   : scan type as one of below</span>
<span class="sd">                                RECURSIVE</span>
<span class="sd">                                OPTIMIZED</span>
<span class="sd">                                CHANGEJOURNAL</span>
<span class="sd">                default: ScanType.RECURSIVE</span>

<span class="sd">            **kwargs            (dict)  : dictionary of optional arguments</span>

<span class="sd">                options:</span>

<span class="sd">                    dirs        (int)   : number of directories in each level.</span>
<span class="sd">                        default: 3</span>

<span class="sd">                    files       (int)   : number of files in each directory</span>
<span class="sd">                        default: 5</span>

<span class="sd">                    file_size   (int)   : Size of the files in KB</span>
<span class="sd">                        default: 20</span>

<span class="sd">                    levels      (int)   : number of levels to be created</span>
<span class="sd">                        default: 1</span>

<span class="sd">                    hlinks      (bool)  : whether to create hardlink files</span>
<span class="sd">                        default: True</span>

<span class="sd">                    slinks      (bool)  : whether to create symbolic link files</span>
<span class="sd">                        default: True</span>

<span class="sd">                    sparse      (bool)  : whether to create sparse files</span>
<span class="sd">                        default: True</span>

<span class="sd">                    sparse_hole_size (int) : Size of the holes in sparse files in KB</span>
<span class="sd">                        default: 1024</span>

<span class="sd">                    options     (str)   : to specify any other additional parameters to the script.</span>
<span class="sd">                        default: &quot;&quot;</span>

<span class="sd">                    increment_count (bool)  : to specify if counters need to be incremented</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                Any error occurred while populating the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;QSYS.LIB&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">incr_path</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;hlinks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">IBMiHelper</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_new_data_incr</span><span class="p">(</span>
                <span class="n">incr_path</span><span class="p">,</span>
                <span class="n">slash_format</span><span class="p">,</span>
                <span class="n">scan_type</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>

        <span class="c1"># Not adding any new data area during incremental. Same data area is modified again before</span>
        <span class="c1"># incremental backups.</span>
        <span class="n">increment_count</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;increment_count&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lfs_backup</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_incr_path</span> <span class="o">=</span> <span class="n">incr_path</span>

        <span class="k">if</span> <span class="n">increment_count</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">num_data_files</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">num_data_files</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">num_members</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">num_members</span> <span class="o">+=</span> <span class="mi">2</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">num_empty_files</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">num_empty_files</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">num_attribute_changes</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">num_attribute_changes</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">num_savf_files</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">num_savf_files</span> <span class="o">+=</span> <span class="mi">2</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">generate_test_data</span><span class="p">(</span><span class="n">incr_path</span><span class="p">)</span></div>

<div class="viewcode-block" id="IBMiHelper.mod_data_incr"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.mod_data_incr">[docs]</a>    <span class="k">def</span> <span class="nf">mod_data_incr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_type</span><span class="o">=</span><span class="n">ScanType</span><span class="o">.</span><span class="n">RECURSIVE</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Modifies the data added by add_new_data_incr call add_new_data_incr before calling this.</span>
<span class="sd">        For LFS, it adds more incremental data. For IFS, it calls the UnixFsHelper implementation</span>

<span class="sd">            Args:</span>
<span class="sd">                scan_type       (ScanType(Enum))    : scan type</span>
<span class="sd">                    default : ScanType.RECURSIVE</span>

<span class="sd">            Returns:</span>
<span class="sd">                None</span>

<span class="sd">            Raises:</span>
<span class="sd">                Exception:</span>
<span class="sd">                    Any error occurred while modifying the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lfs_backup</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_new_data_incr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_incr_path</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">scan_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># IBMi doesn&#39;t support ACL changes, Permission changes and XATTR changes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Deleting path: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">incr_delete_data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">remove_directory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">incr_delete_data</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Renaming directory: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">incr_dir_rename</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">rename_file_or_folder</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">incr_dir_rename</span><span class="p">,</span>
                <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">_renamed&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">incr_dir_rename</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Modifying files on path: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">incr_modify</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">modify_test_data</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">incr_modify</span><span class="p">,</span>
                <span class="n">modify</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Renaming folders on path: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">incr_file_rename</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">rename_file_or_folder</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">incr_file_rename</span><span class="p">,</span>
                <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">_renamed&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">incr_file_rename</span><span class="p">)</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="IBMiHelper.run_find_verify"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.run_find_verify">[docs]</a>    <span class="k">def</span> <span class="nf">run_find_verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">machine_path</span><span class="p">,</span> <span class="n">job</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finds items backed up in the given job and compares it with items from machine</span>

<span class="sd">            Args:</span>
<span class="sd">                machine_path    (str)   : Source data path on the machine</span>

<span class="sd">                job             (obj)   : instance of the job class whose data needs to be restored</span>
<span class="sd">                    default : None</span>

<span class="sd">            Returns:</span>
<span class="sd">                None</span>

<span class="sd">            Raises:</span>
<span class="sd">                Exception:</span>
<span class="sd">                    Any error occurred while finding items or during verification.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">from_time</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;jobStartTime&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">job</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">to_time</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;jobEndTime&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">job</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="n">_</span><span class="p">,</span> <span class="n">meta_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_items_subclient</span><span class="p">(</span><span class="n">from_time</span><span class="o">=</span><span class="n">from_time</span><span class="p">,</span> <span class="n">to_time</span><span class="o">=</span><span class="n">to_time</span><span class="p">)</span>

        <span class="n">machine_items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">get_items_list</span><span class="p">(</span>
            <span class="n">machine_path</span><span class="p">,</span>
            <span class="n">include_parents</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">sorted_output</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="n">index_items</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">meta_data</span> <span class="k">if</span> <span class="n">meta_data</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;Folder&#39;</span>
                       <span class="ow">and</span> <span class="n">machine_path</span> <span class="ow">in</span> <span class="n">item</span><span class="p">]</span>
        <span class="n">index_items</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_lists</span><span class="p">(</span><span class="n">index_items</span><span class="p">,</span> <span class="n">machine_items</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;Items from find operation matches with items on the machine&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;Items from find operation doesn&#39;t match&quot;</span>
                <span class="s2">&quot; with items on the machine&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="IBMiHelper.run_restore_verify"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.run_restore_verify">[docs]</a>    <span class="k">def</span> <span class="nf">run_restore_verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                           <span class="n">slash_format</span><span class="p">,</span>
                           <span class="n">data_path</span><span class="p">,</span>
                           <span class="n">tmp_path</span><span class="p">,</span>
                           <span class="n">data_path_leaf</span><span class="p">,</span>
                           <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initiates restore for data backed up in the given job</span>
<span class="sd">        and performs the applicable verifications</span>

<span class="sd">            Args:</span>
<span class="sd">                slash_format    (str)   : OS path separator format</span>

<span class="sd">                data_path       (str)   : Source data path</span>

<span class="sd">                tmp_path        (str)   : temporary path for restoring the data</span>

<span class="sd">                data_path_leaf  (str)   : leaf level of the data_path</span>

<span class="sd">                **kwargs        (dict)  : Dictionary of optional arguments.</span>

<span class="sd">                    options             :</span>

<span class="sd">                        job     (obj)   : instance of the job class whose data needs to be restored</span>
<span class="sd">                            default : None</span>

<span class="sd">                        cleanup (bool)  : to indicate if restored data should be cleaned up</span>
<span class="sd">                            default : True</span>

<span class="sd">            Returns:</span>
<span class="sd">                None</span>

<span class="sd">            Raises:</span>
<span class="sd">                Exception:</span>
<span class="sd">                    Any error occurred while running restore or during verification.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=arguments-differ</span>
        <span class="n">job</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;job&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">cleanup</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cleanup&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="c1"># For IFS do the same as Unix restore verification.</span>
        <span class="k">if</span> <span class="s1">&#39;/QSYS.LIB&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data_path</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">IBMiHelper</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">run_restore_verify</span><span class="p">(</span><span class="n">slash_format</span><span class="p">,</span>
                                                       <span class="n">data_path</span><span class="p">,</span>
                                                       <span class="n">tmp_path</span><span class="p">,</span>
                                                       <span class="n">data_path_leaf</span><span class="p">,</span>
                                                       <span class="n">job</span><span class="p">,</span>
                                                       <span class="n">cleanup</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># For LFS, source and destination paths will be of the form /QSYS.LIB/XYZ.LIB</span>
            <span class="k">if</span> <span class="n">data_path_leaf</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">data_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">join_path</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_path_leaf</span><span class="p">)</span>

            <span class="n">paths</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
            <span class="n">dest_path</span> <span class="o">=</span> <span class="n">tmp_path</span>

            <span class="n">restore_from_time</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">restore_to_time</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">job</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">restore_from_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcfromtimestamp</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;jobStartTime&#39;</span><span class="p">]))</span>
                <span class="n">restore_to_time</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcfromtimestamp</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;jobEndTime&#39;</span><span class="p">]))</span>

            <span class="c1"># clean up destination directory before starting restore</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">remove_directory</span><span class="p">(</span><span class="n">dest_path</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Starting restore with source:</span><span class="si">%s</span><span class="s1"> destination:</span><span class="si">%s</span><span class="s1"> from_time:</span><span class="si">%s</span><span class="s1"> to_time:</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                          <span class="nb">str</span><span class="p">(</span><span class="n">paths</span><span class="p">),</span>
                          <span class="n">dest_path</span><span class="p">,</span>
                          <span class="nb">str</span><span class="p">(</span><span class="n">restore_from_time</span><span class="p">),</span>
                          <span class="nb">str</span><span class="p">(</span><span class="n">restore_to_time</span><span class="p">)</span>
                          <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">restore_out_of_place</span><span class="p">(</span><span class="n">destination_path</span><span class="o">=</span><span class="n">dest_path</span><span class="p">,</span>
                                      <span class="n">paths</span><span class="o">=</span><span class="n">paths</span><span class="p">,</span>
                                      <span class="n">from_time</span><span class="o">=</span><span class="n">restore_from_time</span><span class="p">,</span>
                                      <span class="n">to_time</span><span class="o">=</span><span class="n">restore_to_time</span><span class="p">)</span>

            <span class="n">compare_source</span> <span class="o">=</span> <span class="n">data_path</span>
            <span class="k">if</span> <span class="n">data_path_leaf</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">compare_destination</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">join_path</span><span class="p">(</span><span class="n">dest_path</span><span class="p">,</span> <span class="n">data_path_leaf</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">compare_destination</span> <span class="o">=</span> <span class="n">dest_path</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Comparing source: </span><span class="si">%s</span><span class="s2"> destination: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">compare_source</span><span class="p">,</span> <span class="n">compare_destination</span><span class="p">)</span>
            <span class="n">result</span><span class="p">,</span> <span class="n">diff_output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">compare_meta_data</span><span class="p">(</span>
                <span class="n">compare_source</span><span class="p">,</span>
                <span class="n">compare_destination</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Meta data comparison successful&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Meta data comparison failed&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Diff output: </span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">diff_output</span><span class="p">))</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Meta data comparison failed&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">cleanup</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">remove_directory</span><span class="p">(</span><span class="n">dest_path</span><span class="p">)</span></div>

<div class="viewcode-block" id="IBMiHelper.run_complete_restore_verify"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.run_complete_restore_verify">[docs]</a>    <span class="k">def</span> <span class="nf">run_complete_restore_verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initiates restore of complete /QSYS.LIB data backed up for this subclient.</span>
<span class="sd">        This runs a find on source, then deletes all the source files and</span>
<span class="sd">        attempts an in-place restore. The initial find is compared with find on restored data.</span>

<span class="sd">            Args:</span>
<span class="sd">                content     (list)  : list of the content for this testcase</span>

<span class="sd">            Returns:</span>
<span class="sd">                None</span>

<span class="sd">            Raises:</span>
<span class="sd">                Exception:</span>
<span class="sd">                    Any error occurred while running restore or during verification.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">complete_source_find_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">source_path</span> <span class="o">=</span> <span class="s1">&#39;/QSYS.LIB&#39;</span>
        <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source_path</span><span class="p">)</span>
        <span class="n">restore_from_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">restore_to_time</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">for</span> <span class="n">data_path</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;QSYS.LIB&#39;</span> <span class="ow">in</span> <span class="n">data_path</span><span class="p">:</span>
                <span class="n">complete_source_find_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">get_items_list</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">remove_directory</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">complete_source_find_list</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Starting restore for:</span><span class="si">%s</span><span class="s1"> from_time:</span><span class="si">%s</span><span class="s1"> to_time:</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                      <span class="n">source_path</span><span class="p">,</span>
                      <span class="nb">str</span><span class="p">(</span><span class="n">restore_from_time</span><span class="p">),</span>
                      <span class="nb">str</span><span class="p">(</span><span class="n">restore_to_time</span><span class="p">)</span>
                      <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">restore_in_place</span><span class="p">(</span>
            <span class="n">paths</span><span class="o">=</span><span class="n">paths</span><span class="p">,</span>
            <span class="n">from_time</span><span class="o">=</span><span class="n">restore_from_time</span><span class="p">,</span>
            <span class="n">to_time</span><span class="o">=</span><span class="n">restore_to_time</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Restored complete </span><span class="si">%s</span><span class="s1"> data in place.&#39;</span><span class="p">,</span> <span class="n">source_path</span><span class="p">)</span>

        <span class="n">complete_restore_find_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">data_path</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;QSYS.LIB&#39;</span> <span class="ow">in</span> <span class="n">data_path</span><span class="p">:</span>
                <span class="n">complete_restore_find_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">get_items_list</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_lists</span><span class="p">(</span><span class="n">complete_source_find_list</span><span class="p">,</span> <span class="n">complete_restore_find_list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Restore of </span><span class="si">%s</span><span class="s1"> was successful&#39;</span><span class="p">,</span> <span class="n">source_path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;Restored and source data do not match&quot;</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="IBMiHelper.set_client_side_deduplication"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.set_client_side_deduplication">[docs]</a>    <span class="k">def</span> <span class="nf">set_client_side_deduplication</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generate_signature_on_ibmi</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the subclient property to generate signature on ibmi client.</span>

<span class="sd">        Args:</span>
<span class="sd">            generate_signature_on_ibmi  (bool)  : Enable or disable the property</span>
<span class="sd">                default: True</span>

<span class="sd">        Returns:</span>
<span class="sd">            SDKException:</span>
<span class="sd">                if failed to update number properties for subclient</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">generate_signature_on_ibmi</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">generate_signature_on_ibmi</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">generate_signature_on_ibmi</span> <span class="o">=</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="IBMiHelper.set_object_level_backup"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.set_object_level_backup">[docs]</a>    <span class="k">def</span> <span class="nf">set_object_level_backup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_level_backup</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the subclient property to backup data as objects.</span>

<span class="sd">        Args:</span>
<span class="sd">            object_level_backup     (bool)  : Enable or disable the property</span>
<span class="sd">                default: True</span>

<span class="sd">        Returns:</span>
<span class="sd">            SDKException:</span>
<span class="sd">                if failed to update number properties for subclient</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">object_level_backup</span> <span class="o">=</span> <span class="n">object_level_backup</span></div>

<div class="viewcode-block" id="IBMiHelper.get_log_directory"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.get_log_directory">[docs]</a>    <span class="k">def</span> <span class="nf">get_log_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the log directory of the IBMi client</span>

<span class="sd">        Returns:</span>
<span class="sd">            str : The log directory path</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># IBMI needs this because IBMI doesn&#39;t maintain a registry key file in text format to grep</span>
        <span class="c1"># the dataFolder from.</span>
        <span class="n">data_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">_properties</span><span class="p">[</span><span class="s1">&#39;pseudoClientInfo&#39;</span><span class="p">][</span><span class="s1">&#39;ibmiInstallOptions&#39;</span><span class="p">][</span><span class="s1">&#39;dataFolder&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">join_path</span><span class="p">(</span><span class="n">data_folder</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="IBMiHelper.verify_from_log"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.verify_from_log">[docs]</a>    <span class="k">def</span> <span class="nf">verify_from_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logfile</span><span class="p">,</span> <span class="n">regex</span><span class="p">,</span> <span class="n">jobid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">expectedvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse the log file for regex and check if the expected value matches.</span>

<span class="sd">        Args:</span>
<span class="sd">            logfile         (str) : Log file to parse</span>

<span class="sd">            regex           (str) : Regex to parse the log file with</span>

<span class="sd">            jobid           (str) : Job id</span>
<span class="sd">                default: None</span>

<span class="sd">            expectedvalue   (str) : The expected value in regex match</span>
<span class="sd">                default: None</span>

<span class="sd">        Returns:</span>
<span class="sd">             bool : True if lines matching regex and expected value were found.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                If no lines matching the regex and expected value is found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logfilepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">join_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_log_directory</span><span class="p">(),</span> <span class="n">logfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Checking </span><span class="si">%s</span><span class="s2"> for Job:[</span><span class="si">%s</span><span class="s2">] regex:[</span><span class="si">%s</span><span class="s2">]&quot;</span><span class="p">,</span>
                      <span class="n">logfilepath</span><span class="p">,</span>
                      <span class="n">jobid</span><span class="p">,</span>
                      <span class="n">regex</span><span class="p">)</span>

        <span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">parse_log_file</span><span class="p">(</span><span class="n">logfilepath</span><span class="p">,</span> <span class="n">regex</span><span class="p">,</span> <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">expectedvalue</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">lines</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No lines match the regular expression in the logs&quot;</span><span class="p">)</span>

        <span class="n">expected_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span> <span class="k">if</span> <span class="n">expectedvalue</span> <span class="ow">in</span> <span class="n">line</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">expected_lines</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No lines match the expected value in the logs&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Matching lines</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">expected_lines</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="IBMiHelper.get_wildcard_content"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.get_wildcard_content">[docs]</a>    <span class="k">def</span> <span class="nf">get_wildcard_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subclient_content</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a wildcard to substitute for the subclient content.</span>

<span class="sd">        Args:</span>
<span class="sd">            subclient_content       (str) : subclient content path</span>

<span class="sd">        Returns:</span>
<span class="sd">            str : subclient content in wildcard format.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                If the subclient content provided is not library file system.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">list_path_element</span> <span class="o">=</span> <span class="n">subclient_content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>  <span class="c1"># Ignore the first empty element.</span>
        <span class="k">if</span> <span class="n">list_path_element</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;QSYS.LIB&quot;</span><span class="p">:</span>
            <span class="n">wildcard_library</span> <span class="o">=</span> <span class="s2">&quot;/</span><span class="si">{0}</span><span class="s2">/AL</span><span class="si">{1}</span><span class="s2">*&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">list_path_element</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                    <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_testcaseid</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">wildcard_library</span>
        <span class="k">elif</span> <span class="n">list_path_element</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;QSYS.LIB&quot;</span><span class="p">:</span>
            <span class="n">wildcard_library</span> <span class="o">=</span> <span class="s2">&quot;/</span><span class="si">{0}</span><span class="s2">/</span><span class="si">{1}</span><span class="s2">/AL</span><span class="si">{2}</span><span class="s2">*&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">list_path_element</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                        <span class="n">list_path_element</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                                        <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_testcaseid</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">wildcard_library</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Not library file system content. Can&#39;t generate wildcard.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="IBMiHelper.update_filter_and_exception"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.update_filter_and_exception">[docs]</a>    <span class="k">def</span> <span class="nf">update_filter_and_exception</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exception_content</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update subclient with new filters and exceptions</span>

<span class="sd">        Args:</span>
<span class="sd">            filter_content          (list) : List of filters</span>
<span class="sd">                default : None</span>

<span class="sd">            exception_content       (list) : List of exceptions</span>
<span class="sd">                default : None</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                If the filter and exception update fails.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">filter_list</span> <span class="o">=</span> <span class="n">filter_content</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">exception_list</span> <span class="o">=</span> <span class="n">exception_content</span>

            <span class="k">if</span> <span class="n">filter_content</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">filter_content</span> <span class="o">=</span> <span class="n">filter_content</span>

            <span class="k">if</span> <span class="n">exception_content</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">exception_content</span> <span class="o">=</span> <span class="n">exception_content</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Filter and exception creation failed with error: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">excp</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Filter and exception creation failed. Error:</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">excp</span><span class="p">)))</span></div>

<div class="viewcode-block" id="IBMiHelper.verify_dc"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.verify_dc">[docs]</a>    <span class="k">def</span> <span class="nf">verify_dc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jobid</span><span class="p">,</span> <span class="n">log_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verifies whether the job used Scan optimization</span>

<span class="sd">             Args:</span>
<span class="sd">                jobid       (int)   : jobid to be checked</span>

<span class="sd">                log_dir     (str)   : path of the log directory</span>
<span class="sd">                    default: None</span>

<span class="sd">            Returns:</span>
<span class="sd">                bool    : Returns True if dc scan was successful or else false</span>

<span class="sd">            Raises:</span>
<span class="sd">                Exception:</span>
<span class="sd">                    if any error occurred while verifying the scan status</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># DC Verification not supported by IBMi</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="IBMiHelper.enable_synclib"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.enable_synclib">[docs]</a>    <span class="k">def</span> <span class="nf">enable_synclib</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">synclib_value</span><span class="o">=</span><span class="s2">&quot;*SYNCLIB&quot;</span><span class="p">,</span>
                       <span class="n">sync_queue</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                       <span class="n">sync_all_lib</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">check_point</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                       <span class="n">active_wait_time</span><span class="o">=</span><span class="mi">600</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enables the synclib backups for the subclient in testcase.</span>

<span class="sd">        Args:</span>
<span class="sd">                synclib_value       (str)   :  Value to which save while active option is set.</span>
<span class="sd">                    default: &#39;*SYNCLIB&#39;</span>

<span class="sd">                sync_queue          (str)   :  Path for the sync queue</span>
<span class="sd">                    default: &#39;&#39;</span>

<span class="sd">                sync_all_lib        (bool)  :  Whether to synchronize all libraries before backup</span>
<span class="sd">                    default: True</span>

<span class="sd">                check_point         (str)   :  Command to run on checkpoint</span>
<span class="sd">                    default: &#39;&#39;</span>

<span class="sd">                active_wait_time    (int)   :  Amount of time to wait for check point in seconds.</span>
<span class="sd">                    default: 600</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">synclib_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;saveWhileActiveOpt&#39;</span><span class="p">:</span> <span class="n">synclib_value</span><span class="p">,</span>
            <span class="s1">&#39;syncQueue&#39;</span><span class="p">:</span> <span class="n">sync_queue</span><span class="p">,</span>
            <span class="s1">&#39;syncAllLibForBackup&#39;</span><span class="p">:</span> <span class="n">sync_all_lib</span><span class="p">,</span>
            <span class="s1">&#39;txtlibSyncCheckPoint&#39;</span><span class="p">:</span> <span class="n">check_point</span><span class="p">,</span>
            <span class="s1">&#39;activeWaitTime&#39;</span><span class="p">:</span> <span class="n">active_wait_time</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">enable_synclib</span> <span class="o">=</span> <span class="n">synclib_config</span></div>

<div class="viewcode-block" id="IBMiHelper.create_ibmi_dr_subclient"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.create_ibmi_dr_subclient">[docs]</a>    <span class="k">def</span> <span class="nf">create_ibmi_dr_subclient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                 <span class="n">subclient_name</span><span class="p">,</span>
                                 <span class="n">storage_policy</span><span class="p">,</span>
                                 <span class="n">additional_library</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">data_readers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                 <span class="n">allow_multiple_readers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a IBMi DR subclient with specific IBMi configurations set.</span>
<span class="sd">        Args:</span>
<span class="sd">            subclient_name          (str)   :   Name of the new subclient</span>

<span class="sd">            storage_policy          (str)   :   Name of the storage policy to use</span>

<span class="sd">            additional_library      (list)  :   List of additional libraries to backup</span>
<span class="sd">                default :   None</span>

<span class="sd">            data_readers            (int)   :   number of data readers</span>
<span class="sd">                default: 2</span>

<span class="sd">            allow_multiple_readers (bool)   : enable / disable allow multiple readers</span>
<span class="sd">                default: False</span>

<span class="sd">            delete                  (bool)  :   Should subclient be deleted if existing</span>
<span class="sd">                default :   False</span>

<span class="sd">             **kwargs               (dict)  : Dictionary of optional arguments.</span>

<span class="sd">                    options                 :</span>

<span class="sd">                        tmp_dir         (str)   :   Temporary path</span>

<span class="sd">                        backup_max_time (int)   :   Maximum time the backup can run, in minutes</span>

<span class="sd">                        save_security   (bool)  :   Option to enable SAVSEC backup</span>
<span class="sd">                            default : True</span>

<span class="sd">                        save_config     (bool)  :   Option to enable SAVCFG backup</span>
<span class="sd">                            default : False</span>

<span class="sd">                        user_program    (str)   :   program to bring system to ristricted state</span>

<span class="sd">                        print_system_info   (bool)  :   Pring system information during backup</span>

<span class="sd">                        notify_user     (bool)  : notify users about DR backup initiation</span>

<span class="sd">                        notify_delay    (int)   :   delay time before ending subsystems, in minutes</span>

<span class="sd">                        notify_message  (str)   : message content to noitify users</span>

<span class="sd">                        user_ipl_program    (str)   : custom startup program</span>

<span class="sd">                        rstd_cmd        (str)   : command to run in ristricted state.</span>

<span class="sd">                        dvd_image_format    (str)   ; dvd image naming format</span>

<span class="sd">            Returns:</span>
<span class="sd">                None    :   Sets the testcase.subclient object</span>

<span class="sd">            Raises:</span>
<span class="sd">                Exception:</span>
<span class="sd">                    Any error occurred while creating subclient:</span>
<span class="sd">    &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_subclient</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">subclient_name</span><span class="p">,</span>
                              <span class="n">storage_policy</span><span class="o">=</span><span class="n">storage_policy</span><span class="p">,</span>
                              <span class="n">content</span><span class="o">=</span><span class="n">additional_library</span><span class="p">,</span>
                              <span class="n">scan_type</span><span class="o">=</span><span class="n">ScanType</span><span class="o">.</span><span class="n">RECURSIVE</span><span class="p">,</span>
                              <span class="n">data_readers</span><span class="o">=</span><span class="n">data_readers</span><span class="p">,</span>
                              <span class="n">allow_multiple_readers</span><span class="o">=</span><span class="n">allow_multiple_readers</span><span class="p">,</span>
                              <span class="n">delete</span><span class="o">=</span><span class="n">delete</span><span class="p">)</span>
        <span class="n">dr_config</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">dr_config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;library&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">lib</span><span class="p">}</span> <span class="k">for</span> <span class="n">lib</span> <span class="ow">in</span> <span class="n">additional_library</span><span class="p">]})</span>
        <span class="k">if</span> <span class="s1">&#39;temp_dir&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dr_config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;SRBootServerDir&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;temp_dir&#39;</span><span class="p">)})</span>

        <span class="k">if</span> <span class="s1">&#39;backup_max_time&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dr_config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;backupMaxTime&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;backup_max_time&#39;</span><span class="p">)})</span>

        <span class="k">if</span> <span class="s1">&#39;save_security&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dr_config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;saveSecData&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;save_security&#39;</span><span class="p">)})</span>

        <span class="k">if</span> <span class="s1">&#39;save_config&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dr_config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;saveConfObject&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;save_config&#39;</span><span class="p">)})</span>

        <span class="k">if</span> <span class="s1">&#39;user_program&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dr_config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;userProgram&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;user_program&#39;</span><span class="p">)})</span>

        <span class="k">if</span> <span class="s1">&#39;print_system_info&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dr_config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;printSysInfo&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;print_system_info&#39;</span><span class="p">)})</span>

        <span class="k">if</span> <span class="s1">&#39;notify_user&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dr_config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;notifyuser&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;notify_user&#39;</span><span class="p">)})</span>

        <span class="k">if</span> <span class="s1">&#39;notify_delay&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dr_config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;notifyDelay&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;notify_delay&#39;</span><span class="p">)})</span>

        <span class="k">if</span> <span class="s1">&#39;notify_message&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dr_config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;notifyMessage&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;notify_message&#39;</span><span class="p">)})</span>

        <span class="k">if</span> <span class="s1">&#39;user_ipl_program&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dr_config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;userIPLProgram&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;user_ipl_program&#39;</span><span class="p">)})</span>

        <span class="k">if</span> <span class="s1">&#39;rstd_cmd&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dr_config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;userCommand&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rstd_cmd&#39;</span><span class="p">)})</span>

        <span class="k">if</span> <span class="s1">&#39;dvd_image_format&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dr_config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;DVDImageFileFormat&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dvd_image_format&#39;</span><span class="p">)})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;setting the IBMi DR SC options </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dr_config</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">ibmi_dr_config</span> <span class="o">=</span> <span class="n">dr_config</span>

        <span class="n">fs_options</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="s1">&#39;accpth&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">fs_options</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;accpth&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;accpth&#39;</span><span class="p">)})</span>

        <span class="k">if</span> <span class="s1">&#39;updhst&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">fs_options</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;updhst&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;updhst&#39;</span><span class="p">)})</span>

        <span class="k">if</span> <span class="s1">&#39;splfdta&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">fs_options</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;splfdta&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;splfdta&#39;</span><span class="p">)})</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fs_options</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_ibmi_sc_options</span><span class="p">(</span><span class="o">**</span><span class="n">fs_options</span><span class="p">)</span></div>

<div class="viewcode-block" id="IBMiHelper.set_savf_file_backup"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.set_savf_file_backup">[docs]</a>    <span class="k">def</span> <span class="nf">set_savf_file_backup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the savf file backup property to user provided value</span>

<span class="sd">        Args:</span>
<span class="sd">            value   (bool)  :   Boolean to set/unset the savf file backup property</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">backup_savf_file_data</span> <span class="o">=</span> <span class="n">value</span></div>

<div class="viewcode-block" id="IBMiHelper.configure_ibmi_default_sc"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.configure_ibmi_default_sc">[docs]</a>    <span class="k">def</span> <span class="nf">configure_ibmi_default_sc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backupset_name</span><span class="p">,</span>
                                  <span class="n">subclient_name</span><span class="p">,</span>
                                  <span class="n">storage_policy</span><span class="p">,</span>
                                  <span class="n">filter_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">exception_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">scan_type</span><span class="o">=</span><span class="n">ScanType</span><span class="o">.</span><span class="n">RECURSIVE</span><span class="p">,</span>
                                  <span class="n">data_readers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                  <span class="n">allow_multiple_readers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                  <span class="n">savfdta</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                  <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates new backupset, check pre-defined subclient and set with specified parameters</span>
<span class="sd">                     under the current testcase Instance.</span>

<span class="sd">                    Checks if the backupset exists or not.</span>
<span class="sd">                    If the backupset exists, deletes the existing backupset</span>
<span class="sd">                    and creates new one with the testcase id.</span>

<span class="sd">                    Args:</span>
<span class="sd">                        backupset_name   (str)          -- name of the backupset</span>

<span class="sd">                        subclient_name   (str)          -- subclient name</span>

<span class="sd">                        storage_policy (str)            -- storage policy to assign to subclient</span>

<span class="sd">                        content (list)                  -- content list</span>

<span class="sd">                        filter_content (list)           -- filter list</span>
<span class="sd">                            default: None</span>

<span class="sd">                        exception_conent (list)         -- exception list</span>
<span class="sd">                            default: None</span>

<span class="sd">                         data_readers (int)             -- number of data readers</span>
<span class="sd">                            default: 2</span>

<span class="sd">                        allow_multiple_readers (bool)   -- enable / disable allow multiple readers</span>
<span class="sd">                            default: False</span>

<span class="sd">                        scan_type(ScanType(Enum))        --  scan type (RECURSIVE/OPTIMIZED)</span>
<span class="sd">                            default: ScanType.RECURSIVE</span>

<span class="sd">                        savfdta (bool)                   -- backup save file data along with SAVF object</span>
<span class="sd">                            default: True</span>

<span class="sd">                        delete (bool)                    -- indicates whether existing backupset should be deleted</span>
<span class="sd">                            default: False</span>

<span class="sd">                    Returns:</span>
<span class="sd">                        None</span>

<span class="sd">                    Raises:</span>
<span class="sd">                        Exception - Any error occured while configuring pre-defined subclient.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Create backupset for this testcase if it does not exist&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_backupset</span><span class="p">(</span><span class="n">backupset_name</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="n">delete</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Checking if pre-defined subclient </span><span class="si">%s</span><span class="s2"> exists.&quot;</span><span class="p">,</span> <span class="n">subclient_name</span><span class="p">)</span>
        <span class="n">subclients_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">backupset</span><span class="o">.</span><span class="n">subclients</span>
        <span class="k">if</span> <span class="n">subclients_object</span><span class="o">.</span><span class="n">has_subclient</span><span class="p">(</span><span class="n">subclient_name</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Pre-defined Subclient </span><span class="si">{0}</span><span class="s2"> exists. Now, updating with &quot;</span>
                          <span class="s2">&quot;additional parameters&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">subclient_name</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span> <span class="o">=</span> <span class="n">subclients_object</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">subclient_name</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">update_subclient</span><span class="p">(</span><span class="n">storage_policy</span><span class="o">=</span><span class="n">storage_policy</span><span class="p">,</span>
                                  <span class="n">content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">filter_content</span><span class="o">=</span><span class="n">filter_content</span><span class="p">,</span>
                                  <span class="n">exception_content</span><span class="o">=</span><span class="n">exception_content</span><span class="p">,</span>
                                  <span class="n">scan_type</span><span class="o">=</span><span class="n">scan_type</span><span class="p">,</span>
                                  <span class="n">data_readers</span><span class="o">=</span><span class="n">data_readers</span><span class="p">,</span>
                                  <span class="n">allow_multiple_readers</span><span class="o">=</span><span class="n">allow_multiple_readers</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">savfdta</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_savf_file_backup</span><span class="p">(</span><span class="n">savfdta</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Failed: Pre-defined Subclient </span><span class="si">{0}</span><span class="s2"> is not auto-created&quot;</span>
                            <span class="s2">&quot;under backupSet </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">subclient_name</span><span class="p">,</span> <span class="n">backupset_name</span><span class="p">))</span></div>

<div class="viewcode-block" id="IBMiHelper.compare_ibmi_data"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.compare_ibmi_data">[docs]</a>    <span class="k">def</span> <span class="nf">compare_ibmi_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_path</span><span class="p">,</span> <span class="n">destination_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function to perform meta data comparision &amp; Checksum comparision</span>
<span class="sd">            of source and destination paths.</span>
<span class="sd">            Args:</span>
<span class="sd">                source_path(str)       -- Source Path for the restore</span>
<span class="sd">                destination_path(str)  -- Destination Path you want to restore</span>
<span class="sd">            Returns:</span>
<span class="sd">                None</span>
<span class="sd">            Raises:</span>
<span class="sd">                Exception - error while comparing the paths.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Comparing source:</span><span class="si">%s</span><span class="s2"> destination:</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">source_path</span><span class="p">,</span> <span class="n">destination_path</span><span class="p">)</span>
        <span class="n">result</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">compare_meta_data</span><span class="p">(</span><span class="n">source_path</span><span class="p">,</span> <span class="n">destination_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Meta data comparison successful&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Meta data comparison failed&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Diff output: </span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Meta data comparison failed&quot;</span><span class="p">)</span>

        <span class="n">result</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">client_machine</span><span class="o">.</span><span class="n">compare_checksum</span><span class="p">(</span><span class="n">source_path</span><span class="p">,</span> <span class="n">destination_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Checksum comparison successful&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Checksum comparison failed&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Diff output: </span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Checksum comparison failed&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="IBMiHelper.verify_sc_defaults"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.verify_sc_defaults">[docs]</a>    <span class="k">def</span> <span class="nf">verify_sc_defaults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function to verify all the default subclient options.</span>
<span class="sd">            Args:</span>
<span class="sd">                job         (str)-- Job details</span>
<span class="sd">            Returns:</span>
<span class="sd">                None</span>
<span class="sd">            Raises:</span>
<span class="sd">                Exception - error while verifying logs for default values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Check Default value for Private authorities&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                    <span class="n">jobid</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
                                    <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_PrivateAuthority_Enabled] - [0]&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                    <span class="n">jobid</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
                                    <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;PVTAUT(*NO)&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Check Default value for data queue data&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                    <span class="n">jobid</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
                                    <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_QueueData_Enabled] - [0]&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                    <span class="n">jobid</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
                                    <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;QDTA(*NONE)&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Check Default value for save access path&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                    <span class="n">jobid</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
                                    <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_Save_Access_Path] - [*SYSVAL]&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                    <span class="n">jobid</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
                                    <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;ACCPTH(*SYSVAL)&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Check Default value for save while active&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                    <span class="n">jobid</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
                                    <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;SAVACT(*LIB)&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Check Default value for save while active wait time&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                    <span class="n">jobid</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
                                    <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_Save_ActiveWait_Time] - [0]&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                    <span class="n">jobid</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
                                    <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;SAVACTWAIT(0 &quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Check Default value for save file data&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                    <span class="n">jobid</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
                                    <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_SaveFileData_Enabled] - [1]&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                    <span class="n">jobid</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
                                    <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;SAVFDTA(*YES)&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Check Default value for spool file data&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                    <span class="n">jobid</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
                                    <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_SpoolFileData_Enabled] - [0]&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                    <span class="n">jobid</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
                                    <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;SPLFDTA(*NONE&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Check Default value for client side data compression&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                    <span class="n">jobid</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
                                    <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[JOB_COMPRESSION_LEVEL] - [*NO]&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                    <span class="n">jobid</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
                                    <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;DTACPR(*NO)&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Check Default value for update history&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                    <span class="n">jobid</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
                                    <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;UPDHST(*NO)&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Check Default value for optimized scan option&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                    <span class="n">jobid</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
                                    <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[ScanlessBackup] - [0]&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Check Default value for target and release&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                    <span class="n">jobid</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
                                    <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Target_release_For_Backup_Data] - []&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="IBMiHelper.set_ibmi_sc_options"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.set_ibmi_sc_options">[docs]</a>    <span class="k">def</span> <span class="nf">set_ibmi_sc_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set IBMi specific options to subclient.</span>
<span class="sd">        **kwargs               (dict)  : Dictionary of optional arguments.</span>

<span class="sd">                savact              (str)   : Value to which save while active option is set</span>
<span class="sd">                    default: &#39;*LIB&#39;</span>
<span class="sd">                    allowedValues: &#39;*LIB&#39; or &#39;*NO&#39; or &#39;*SYSDFN&#39; or *SYNCLIB</span>

<span class="sd">                savactwait          (int)   :  Amount of time to wait for check point in seconds.</span>
<span class="sd">                    default: 0</span>

<span class="sd">                savactmsgq          (str)   :  specify the name of the message queue in &lt;lib&gt;/&lt;msgq&gt; format.</span>
<span class="sd">                    example: QSYS/QSYSOPR</span>

<span class="sd">                sync_cmd            (str)   : specify the command which runs once backup reaches check-point</span>
<span class="sd">                    example: QGPL/SYNCREACH</span>

<span class="sd">                dtacpr              (str)   :  compression level on IBMi</span>
<span class="sd">                    default: &#39;*NO&#39;</span>
<span class="sd">                    allowedValues: *NO or *LOW or *MEDIUM or *HIGH</span>

<span class="sd">                dedupe_on_ibmi      (bool)  : dedeplication to run on IBMi client</span>
<span class="sd">                    default: False</span>

<span class="sd">                updhst              (bool)  : update backup history on IBMi client</span>
<span class="sd">                    default: False</span>

<span class="sd">                accpth              (str)   : save access path</span>
<span class="sd">                    default: &quot;*SYSVAL&quot;</span>
<span class="sd">                    allowedValues: &quot;*SYSVAL&quot; or &quot;*YES&quot; or &quot;*NO&quot;</span>

<span class="sd">                tgtrls              (str)   : OS release version of targeted IBMi for restore</span>
<span class="sd">                    default: &#39;&#39;</span>
<span class="sd">                    allowedValues: version of OS in the format of VXRXMX</span>

<span class="sd">                pvtaut              (bool)  : backup private authorities</span>
<span class="sd">                    default: False</span>

<span class="sd">                qdta                (bool)  : backup data inside data queue</span>
<span class="sd">                    default: False</span>

<span class="sd">                splfdta             (bool)  : backup spool files along with OUTQ object</span>
<span class="sd">                    default: False</span>

<span class="sd">                savfdta             (bool)  : backup save file data along with SAVF object</span>
<span class="sd">                    default: True</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception:</span>
<span class="sd">                Raises exception if no inputs.</span>

<span class="sd">        Dict sample:</span>
<span class="sd">        sc_options = {&#39;savact&#39;: &#39;*LIB/*NO/*SYSDFN/*SYNCLIB&#39;,</span>
<span class="sd">                          &#39;savactwait&#39;: &#39;&lt;Value in seconds&gt;&#39;,</span>
<span class="sd">                          &#39;savactmsgq&#39;: &#39;&lt;LIB_NAME&gt;/&lt;MSGQ_NAME&gt;&#39;,</span>
<span class="sd">                          &#39;sync_cmd&#39;: &#39;&lt;LIB_NAME&gt;/&lt;CMD_NAME&gt;&#39;,</span>
<span class="sd">                          &#39;dtacpr&#39;: &#39;*NO/*LOW/*MEDIUM/*HIGH&#39;,</span>
<span class="sd">                          &#39;dedupe_on_ibmi&#39;: &#39;True/False&#39;,</span>
<span class="sd">                          &#39;updhst&#39;: &#39;True/False&#39;,</span>
<span class="sd">                          &#39;accpth&#39;: &#39;*SYSVAL/*YES/*NO&#39;,</span>
<span class="sd">                          &#39;tgtrls&#39;: &#39;VXRXMX&#39;,</span>
<span class="sd">                          &#39;pvtaut&#39;: &#39;True/False&#39;,</span>
<span class="sd">                          &#39;qdta&#39;: &#39;True/False&#39;,</span>
<span class="sd">                          &#39;splfdta&#39;: &#39;True/False&#39;,</span>
<span class="sd">                          &#39;savfdta&#39;: &#39;True/False&#39;</span>
<span class="sd">                          }</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;inputs expected for function set_ibmi_sc_options()&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No inputs received for function set_ibmi_sc_options()&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;setting the IBMi SC options </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">if</span> <span class="s1">&#39;savact&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savact&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;*SYNCLIB&quot;</span><span class="p">:</span>
                <span class="n">synclib_config</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;saveWhileActiveOpt&#39;</span><span class="p">:</span> <span class="s2">&quot;*SYNCLIB&quot;</span><span class="p">,</span>
                    <span class="s1">&#39;syncQueue&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savactmsgq&#39;</span><span class="p">),</span>
                    <span class="s1">&#39;syncAllLibForBackup&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;txtlibSyncCheckPoint&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sync_cmd&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
                    <span class="s1">&#39;activeWaitTime&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savactwait&#39;</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;set [SWA] to value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">synclib_config</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">enable_synclib</span> <span class="o">=</span> <span class="n">synclib_config</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">swa_config</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;saveWhileActiveOpt&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savact&#39;</span><span class="p">),</span>
                    <span class="s1">&#39;activeWaitTime&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savactwait&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;set [SWA] to value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">swa_config</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">save_while_active_option</span> <span class="o">=</span> <span class="n">swa_config</span>

        <span class="k">if</span> <span class="s1">&#39;dtacpr&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;set [DTACPR] to value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dtacpr&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">ibmi_compression</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dtacpr&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;dedupe_on_ibmi&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;set [DEDUP ON IBMi] to value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dedupe_on_ibmi&#39;</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dedupe_on_ibmi&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">generate_signature_on_ibmi</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">generate_signature_on_ibmi</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="s1">&#39;updhst&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;set [UPDHST] to value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;updhst&#39;</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;updhst&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">update_history</span> <span class="o">=</span> <span class="s1">&#39;*YES&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">update_history</span> <span class="o">=</span> <span class="s1">&#39;*NO&#39;</span>

        <span class="k">if</span> <span class="s1">&#39;accpth&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;set [ACCPTH] to value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;accpth&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">save_access_path</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;accpth&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;tgtrls&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;set [TGTRLS] to value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tgtrls&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">target_release</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tgtrls&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;pvtaut&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;set [PVTAUT] to value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pvtaut&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">backup_private_authorities</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pvtaut&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;qdta&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;set [QDTA] to value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;qdta&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">backup_queue_data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;qdta&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;splfdta&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;set [SPLFDTA] to value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;splfdta&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">backup_spool_file_data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;splfdta&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;savfdta&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;set [SAVFDTA] to value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savfdta&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">backup_savf_file_data</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savfdta&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;object_level&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;set [OBJECT_LEVEL] to value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;object_level&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">testcase</span><span class="o">.</span><span class="n">subclient</span><span class="o">.</span><span class="n">object_level_backup</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;object_level&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="IBMiHelper.verify_ibmi_sc_options"><a class="viewcode-back" href="../../../source/FileSystem.FSUtils.html#FileSystem.FSUtils.ibmihelper.IBMiHelper.verify_ibmi_sc_options">[docs]</a>    <span class="k">def</span> <span class="nf">verify_ibmi_sc_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jobid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">          Function to verify subclient options in client logs</span>
<span class="sd">                Args:</span>
<span class="sd">                        jobid           (str)  : Job ID</span>

<span class="sd">                **kwargs               (dict)  : Dictionary of optional arguments.</span>

<span class="sd">                        savact              (str)   : Value to which save while active option is set</span>
<span class="sd">                            default: &#39;*LIB&#39;</span>
<span class="sd">                            allowedValues: &#39;*LIB&#39; or &#39;*NO&#39; or &#39;*SYSDFN&#39; or *SYNCLIB</span>

<span class="sd">                        savactwait          (int)   :  Amount of time to wait for check point in seconds.</span>
<span class="sd">                            default: 0</span>

<span class="sd">                        savactmsgq          (str)   :  specify the name of the message queue in &lt;lib&gt;/&lt;msgq&gt; format.</span>
<span class="sd">                            example: QSYS/QSYSOPR</span>

<span class="sd">                        sync_cmd            (str)   : specify the command which runs once backup reaches check-point</span>
<span class="sd">                            example: QGPL/SYNCREACH</span>

<span class="sd">                        dtacpr              (str)   :  compression level on IBMi</span>
<span class="sd">                            default: &#39;*NO&#39;</span>
<span class="sd">                            allowedValues: *NO or *LOW or *MEDIUM or *HIGH</span>

<span class="sd">                        dedupe_on_ibmi      (bool)  : dedeplication to run on IBMi client</span>
<span class="sd">                            default: False</span>

<span class="sd">                        updhst              (bool)  : update backup history on IBMi client</span>
<span class="sd">                            default: False</span>

<span class="sd">                        accpth              (str)   : save access path</span>
<span class="sd">                            default: &quot;*SYSVAL&quot;</span>
<span class="sd">                            allowedValues: &quot;*SYSVAL&quot; or &quot;*YES&quot; or &quot;*NO&quot;</span>

<span class="sd">                        object_level        (bool)  : backup library content as objects</span>
<span class="sd">                            default: False</span>
<span class="sd">                            allowedValues: True or False</span>

<span class="sd">                        tgtrls              (str)   : OS release version of targeted IBMi for restore</span>
<span class="sd">                            default: &#39;&#39;</span>
<span class="sd">                            allowedValues: version of OS in the format of VXRXMX</span>

<span class="sd">                        pvtaut              (bool)  : backup private authorities</span>
<span class="sd">                            default: False</span>

<span class="sd">                        qdta                (bool)  : backup data inside data queue</span>
<span class="sd">                            default: False</span>

<span class="sd">                        splfdta             (bool)  : backup spool files along with OUTQ object</span>
<span class="sd">                            default: False</span>

<span class="sd">                        savfdta             (bool)  : backup save file data along with SAVF object</span>
<span class="sd">                            default: True</span>

<span class="sd">                Returns:</span>
<span class="sd">                    None</span>

<span class="sd">                Raises:</span>
<span class="sd">                    Exception:</span>
<span class="sd">                        Raises exception if no inputs.</span>

<span class="sd">                Dict sample:</span>
<span class="sd">                sc_options = {&#39;savact&#39;: &#39;*LIB/*NO/*SYSDFN/*SYNCLIB&#39;,</span>
<span class="sd">                              &#39;savactwait&#39;: &#39;&lt;Value in seconds&gt;&#39;,</span>
<span class="sd">                              &#39;savactmsgq&#39;: &#39;&lt;LIB_NAME&gt;/&lt;MSGQ_NAME&gt;&#39;,</span>
<span class="sd">                              &#39;sync_cmd&#39;: &#39;&lt;LIB_NAME&gt;/&lt;CMD_NAME&gt;&#39;,</span>
<span class="sd">                              &#39;dtacpr&#39;: &#39;*NO/*LOW/*MEDIUM/*HIGH&#39;,</span>
<span class="sd">                              &#39;dedupe_on_ibmi&#39;: &#39;True/False&#39;,</span>
<span class="sd">                              &#39;updhst&#39;: &#39;True/False&#39;,</span>
<span class="sd">                              &#39;accpth&#39;: &#39;*SYSVAL/*YES/*NO&#39;,</span>
<span class="sd">                              &#39;tgtrls&#39;: &#39;VXRXMX&#39;,</span>
<span class="sd">                              &#39;pvtaut&#39;: &#39;True/False&#39;,</span>
<span class="sd">                              &#39;qdta&#39;: &#39;True/False&#39;,</span>
<span class="sd">                              &#39;splfdta&#39;: &#39;True/False&#39;,</span>
<span class="sd">                              &#39;savfdta&#39;: &#39;True/False&#39;</span>
<span class="sd">                                  }</span>
<span class="sd">                &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;inputs expected for function verify_ibmi_sc_options()&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No inputs received for function verify_ibmi_sc_options()&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;savact&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Verify the client logs for option [SWA] with value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savact&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                 <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                 <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_SAVACT] - [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savact&#39;</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savact&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;*SYNCLIB&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Verify the client logs for option [SAVACT] with value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savact&#39;</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                     <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                     <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_SyncLib_Enabled] - [1]&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="s1">&#39;savactmsgq&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Verify the client logs for option [SAVCATMSGQ] with value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savactmsgq&#39;</span><span class="p">)))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                         <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                         <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_Sync_Queue] - [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                             <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savactmsgq&#39;</span><span class="p">)))</span>
                <span class="k">if</span> <span class="s1">&#39;sync_cmd&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Verify the client logs for option [SYNCCMD] with value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sync_cmd&#39;</span><span class="p">)))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                         <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                         <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_LibSync_Checkpoint] - [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                             <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sync_cmd&#39;</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Verify the client logs for option [SWA] with value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savact&#39;</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                     <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                     <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_SyncLib_Enabled] - [0]&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;savactwait&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Verify the client logs for option [SAVACTWAIT] with value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savactwait&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                 <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                 <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_Save_ActiveWait_Time] - [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                     <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savactwait&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                 <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                 <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;SAVACTWAIT(</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savactwait&#39;</span><span class="p">)))</span>

        <span class="k">if</span> <span class="s1">&#39;dtacpr&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Verify the client logs for option [DTACPR] with value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dtacpr&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                 <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                 <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[JOB_COMPRESSION_LEVEL] - [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dtacpr&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                 <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                 <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;DTACPR(</span><span class="si">{0}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dtacpr&#39;</span><span class="p">)))</span>

        <span class="k">if</span> <span class="s1">&#39;dedupe_on_ibmi&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Verify the client logs for option [DEDUP_ON_IBMi] with value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dedupe_on_ibmi&#39;</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dedupe_on_ibmi&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;ClientBackup::doBackup&#39;</span><span class="p">,</span>
                                     <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                     <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;Prepipeline deduplication configured.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;ClientBackup::doBackup&#39;</span><span class="p">,</span>
                                     <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                     <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;Deduplication will happen on Proxy.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;updhst&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Verify the client logs for option [UPDHST] with value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;updhst&#39;</span><span class="p">)))</span>
            <span class="k">if</span> <span class="s1">&#39;savact&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savact&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;*SYNCLIB&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;updhst&#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                     <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                     <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;UPDHST(</span><span class="si">{0}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;*YES&#39;</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                 <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                 <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;UPDHST(</span><span class="si">{0}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;*NO&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="s1">&#39;accpth&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Verify the client logs for option [ACCPTH] with value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;accpth&#39;</span><span class="p">)))</span>
            <span class="k">if</span> <span class="s1">&#39;savact&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savact&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;*SYNCLIB&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                 <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                 <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_Save_Access_Path] - [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;accpth&#39;</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                 <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                 <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;ACCPTH(</span><span class="si">{0}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;accpth&#39;</span><span class="p">)))</span>

        <span class="k">if</span> <span class="s1">&#39;tgtrls&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Verify the client logs for option [TGTRLS] with value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tgtrls&#39;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                 <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                 <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Target_release_For_Backup_Data] - [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                     <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tgtrls&#39;</span><span class="p">)))</span>

        <span class="k">if</span> <span class="s1">&#39;pvtaut&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Verify the client logs for option [PVTAUT] with value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pvtaut&#39;</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pvtaut&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                     <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                     <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;PVTAUT(*YES)&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                     <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                     <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_PrivateAuthority_Enabled] - [1]&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                     <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                     <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;PVTAUT(*NO)&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                     <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                     <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_PrivateAuthority_Enabled] - [0]&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;qdta&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Verify the client logs for option [QDTA] with value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;qdta&#39;</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;qdta&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                     <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                     <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_QueueData_Enabled] - [1]&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                     <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                     <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;QDTA(*DTAQ)&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                 <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                 <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_QueueData_Enabled] - [0]&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                 <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                 <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;QDTA(*NONE)&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;splfdta&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Verify the client logs for option [SPLFDTA] with value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;splfdta&#39;</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;splfdta&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                     <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                     <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_SpoolFileData_Enabled] - [1]&quot;</span><span class="p">)</span>
                <span class="sd">&#39;&#39;&#39;self.verify_from_log(&#39;cvbkp*.log&#39;,</span>
<span class="sd">                                     &#39;Processing JOBLOG for&#39;,</span>
<span class="sd">                                     jobid=jobid,</span>
<span class="sd">                                     expectedvalue=&quot;SPLFDTA(*ALL&quot;)&#39;&#39;&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                 <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                 <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_SpoolFileData_Enabled] - [0]&quot;</span><span class="p">)</span>
                <span class="sd">&#39;&#39;&#39;self.verify_from_log(&#39;cvbkp*.log&#39;,</span>
<span class="sd">                                 &#39;Processing JOBLOG for&#39;,</span>
<span class="sd">                                 jobid=jobid,</span>
<span class="sd">                                 expectedvalue=&quot;SPLFDTA(*NONE&quot;)&#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="s1">&#39;savfdta&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Verify the client logs for option [SAVFDTA] with value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savfdta&#39;</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;savfdta&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                 <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                 <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_SaveFileData_Enabled] - [1]&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                 <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                 <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;SAVFDTA(*YES)&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;processJobStartMessage&#39;</span><span class="p">,</span>
                                     <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                     <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;[Backup_SaveFileData_Enabled] - [0]&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvbkp*.log&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;Processing JOBLOG for&#39;</span><span class="p">,</span>
                                     <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                     <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;SAVFDTA(*NO)&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;object_level&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Verify the client logs for option [Object_Level] &quot;</span>
                              <span class="s2">&quot;with value [</span><span class="si">{0}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;object_level&#39;</span><span class="p">)))</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;object_level&#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvscan*.log&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;ProcessWorkUnit&#39;</span><span class="p">,</span>
                                     <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                     <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;Backup running in object level mode&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">verify_from_log</span><span class="p">(</span><span class="s1">&#39;cvscan*.log&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;ProcessWorkUnit&#39;</span><span class="p">,</span>
                                         <span class="n">jobid</span><span class="o">=</span><span class="n">jobid</span><span class="p">,</span>
                                         <span class="n">expectedvalue</span><span class="o">=</span><span class="s2">&quot;Backup running in library level mode&quot;</span><span class="p">)</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright Commvault Systems Inc. All Rights Reserved

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>